(function(){var e,t,n;(function(r){function f(e,t){if(e&&e.charAt(0)==="."&&t){t=t.split("/"),t=t.slice(0,t.length-1),e=t.concat(e.split("/"));var n,r;for(n=0;r=e[n];n++)if(r===".")e.splice(n,1),n-=1;else if(r===".."){if(n===1&&(e[2]===".."||e[0]===".."))break;n>0&&(e.splice(n-1,2),n-=2)}e=e.join("/")}return e}function l(e,t){return function(){return a.apply(r,o.call(arguments,0).concat([e,t]))}}function c(e){return function(t){return f(t,e)}}function h(e){return function(t){i[e]=t}}function p(e){if(s.hasOwnProperty(e)){var t=s[e];delete s[e],u.apply(r,t)}return i[e]}function d(e,t){var n,r,i=e.indexOf("!");return i!==-1?(n=f(e.slice(0,i),t),e=e.slice(i+1),r=p(n),r&&r.normalize?e=r.normalize(e,c(t)):e=f(e,t)):e=f(e,t),{f:n?n+"!"+e:e,n:e,p:r}}var i={},s={},o=[].slice,u,a;if(typeof n=="function")return;u=function(e,t,n,o){var u=[],a,f,c,v,m,g;o||(o=e);if(typeof n=="function"){!t.length&&n.length&&(t=["require","exports","module"]);for(v=0;v<t.length;v++){g=d(t[v],o),c=g.f;if(c==="require")u[v]=l(e);else if(c==="exports")u[v]=i[e]={},a=!0;else if(c==="module")f=u[v]={id:e,uri:"",exports:i[e]};else if(i.hasOwnProperty(c)||s.hasOwnProperty(c))u[v]=p(c);else{if(!g.p)throw e+" missing "+c;g.p.load(g.n,l(o,!0),h(c),{}),u[v]=i[c]}}m=n.apply(i[e],u),e&&(f&&f.exports!==r?i[e]=f.exports:a||(i[e]=m))}else e&&(i[e]=n)},e=a=function(e,t,n,i){return typeof e=="string"?p(d(e,t).f):(e.splice||(t.splice?(e=t,t=arguments[2]):e=[]),i?u(r,e,t,n):setTimeout(function(){u(r,e,t,n)},15),a)},a.config=function(){return a},t||(t=a),n=function(e,t,r){t.splice||(r=t,t=[]),n.unordered?s[e]=[e,t,r]:u(e,t,r)},n.amd={jQuery:!0}})(),n("../tools/almond",function(){}),function(e,t){var n="",r="function",i="undefined",s="object",o="major",u="model",a="name",f="type",l="vendor",c="version",h="console",p="mobile",d="tablet",v={regex:function(){var e,o,u,a,f,l,c=arguments;for(o=0;o<c.length;o+=2){var h=c[o],p=c[o+1];if(typeof e===i){e={};for(a=0;a<p.length;a++)typeof p[a]===s?e[p[a][0]]=t:e[p[a]]=t;if(this.getUA().toString()===n)return e}for(u=0;u<h.length;u++){f=h[u].exec(this.getUA());if(!!f){for(a=0;a<p.length;a++)l=f[a+1],typeof p[a]===s&&p[a].length===2?e[p[a][0]]=p[a][1]:typeof p[a]===s&&p[a].length===3?typeof p[a][1]===r&&(!p[a][1].exec||!p[a][1].test)?e[p[a][0]]=l?p[a][1].call(this,l,p[a][2]):t:e[p[a][0]]=l?l.replace(p[a][1],p[a][2]):t:e[p[a]]=l?l:t;break}}if(!!f)break}return e},string:function(e,n){for(var r in n)if(n.hasOwnProperty(r))if(typeof n[r]===s&&n[r].length>0){for(var o=0;o<n[r].length;o++)if(e.toLowerCase().indexOf(n[r][o].toLowerCase())!==-1)return r.toString()===i?t:r}else if(e.toLowerCase().indexOf(n[r].toLowerCase())!==-1)return r.toString()===i?t:r;return e}},m={browser:{oldsafari:{major:{1:["/85","/125","/312"],2:["/412","/416","/417","/419"],"undefined":"/"},version:{"1.0":"/85",1.2:"/125",1.3:"/312","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","undefined":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",RT:"ARM"}}}},g={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i,/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\sbrowser|iemobile|slimbrowser|baidubrowser)[\/\s]?((\d+)?[\w\.]*)/i,/ms(ie)\s((\d+)?[\w\.]+)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt)\/((\d+)?[\w\.-]+)/i],[a,c,o],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[[a,"Yandex"],c,o],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],[a,c,o],[/(dolfin)\/((\d+)?[\w\.]+)/i],[[a,"Dolphin"],c,o],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[[a,"Chrome"],c,o],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],[c,o,[a,"Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],[c,o,a],[/applewebkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],[a,[o,v.string,m.browser.oldsafari.major],[c,v.string,m.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(applewebkit|khtml)\/((\d+)?[\w\.]+)/i],[a,c,o],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[[a,"Netscape"],c,o],[/(swiftfox)/i,/(iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris)[\/\s]?((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],[a,c,o]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[u,l,[f,d]],[/(hp).+(touchpad)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[l,u,[f,d]],[/\((ip[honed]+);.+(apple)/i],[u,l,[f,p]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[l,u,[f,p]],[/\((bb10);\s(\w+)/i],[[l,"BlackBerry"],u,[f,p]],[/android.+((transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+))/i],[[l,"Asus"],u,[f,d]],[/(sony)\s(tablet\s[ps])/i],[l,u,[f,d]],[/(nintendo|playstation)\s([wids3portablev]+)/i],[l,u,[f,h]],[/(sprint\s[a-z]+)(\w+)/i],[[l,v.string,m.device.sprint.vendor],[u,v.string,m.device.sprint.model],[f,p]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|;\ssony)[_\s-]?([\w-]+)*/i],[l,[u,/_/g," "],[f,p]],[/\s((milestone|droid[2x]?))[globa\s]*\sbuild\//i,/(mot)[\s-]?(\w+)*/i],[[l,"Motorola"],u,[f,p]],[/android.+\s((mz60\d|xoom[\s2]{0,2}))\sbuild\//i],[[l,"Motorola"],u,[f,d]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9))/i],[[l,"Samsung"],u,[f,d]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[l,"Samsung"],u,[f,p]],[/(sie)-(\w+)*/i],[[l,"Siemens"],u,[f,p]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[l,"Nokia"],u,[f,p]],[/android\s3\.[\s\w-;]{10}((a\d{3}))/i],[[l,"Acer"],u,[f,d]],[/android\s3\.[\s\w-;]{10}(lg?)-([06cv9]{3,4})/i],[[l,"LG"],u,[f,d]],[/(lg)[e;\s-\/]+(\w+)*/i],[[l,"LG"],u,[f,p]],[/(mobile|tablet);.+rv\:.+gecko\//i],[f,l,u]],engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront)\/([\w\.]+)/i,/(khtml)\/([\w\.]+)/i,/(tasman)\s([\w\.]+)/i],[a,c],[/rv\:([\w\.]+).*(gecko)/i],[c,a]],os:[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone\sos|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[a,[c,v.string,m.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[a,"Windows"],[c,v.string,m.os.windows.version]],[/\((bb)(10);/i],[[a,"BlackBerry"],c],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],[a,c],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[a,"Symbian"],c],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[a,"Firefox OS"],c],[/(nintendo|playstation)\s([wids3portablev]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[a,c],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[a,"Chromium OS"],c],[/(sunos)\s?([\w\.]+\d)*/i],[[a,"Solaris"],c],[/\s(\w*bsd|dragonfly)\s?([\w\.]+)*/i],[a,c],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[a,"iOS"],[c,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],[a,[c,/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos)/i,/(unix)\s?([\w\.]+)*/i],[a,c]]},y=function(t){var r=t||(e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:n);this.getBrowser=function(){return v.regex.apply(this,g.browser)},this.getDevice=function(){return v.regex.apply(this,g.device)},this.getEngine=function(){return v.regex.apply(this,g.engine)},this.getOS=function(){return v.regex.apply(this,g.os)},this.getResult=function(){return{browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice()}},this.getUA=function(){return r},this.setUA=function(e){return r=e,this},this.setUA(r)};typeof exports!==i&&!/\[object\s[DOM]*Window\]/.test(e.toString())?(typeof module!==i&&module.exports&&(exports=module.exports=y),exports.UAParser=y):e.UAParser=y}(this),n("../external/ua-parser/ua-parser",function(){}),function(){function e(e){throw e}function t(e,t){var n=[],r=(1<<t)-1,i=e.length*t,s;for(s=0;s<i;s+=t)n[s>>>5]|=(e.charCodeAt(s/t)&r)<<32-t-s%32;return{value:n,binLen:i}}function n(t){var n=[],r=t.length,i,s;0!==r%2&&e("String of HEX type must be in byte increments");for(i=0;i<r;i+=2)s=parseInt(t.substr(i,2),16),isNaN(s)&&e("String of HEX type contains invalid characters"),n[i>>>3]|=s<<24-4*(i%8);return{value:n,binLen:4*r}}function r(t){var n=[],r=0,i,s,o,u,a;-1===t.search(/^[a-zA-Z0-9=+\/]+$/)&&e("Invalid character in base-64 string"),i=t.indexOf("="),t=t.replace(/\=/g,""),-1!==i&&i<t.length&&e("Invalid '=' found in base-64 string");for(s=0;s<t.length;s+=4){a=t.substr(s,4);for(o=u=0;o<a.length;o+=1)i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a[o]),u|=i<<18-6*o;for(o=0;o<a.length-1;o+=1)n[r>>2]|=(u>>>16-8*o&255)<<24-8*(r%4),r+=1}return{value:n,binLen:8*r}}function i(e,t){var n="",r=4*e.length,i,s;for(i=0;i<r;i+=1)s=e[i>>>2]>>>8*(3-i%4),n+="0123456789abcdef".charAt(s>>>4&15)+"0123456789abcdef".charAt(s&15);return t.outputUpper?n.toUpperCase():n}function s(e,t){var n="",r=4*e.length,i,s,o;for(i=0;i<r;i+=3){o=(e[i>>>2]>>>8*(3-i%4)&255)<<16|(e[i+1>>>2]>>>8*(3-(i+1)%4)&255)<<8|e[i+2>>>2]>>>8*(3-(i+2)%4)&255;for(s=0;4>s;s+=1)n=8*i+6*s<=32*e.length?n+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o>>>6*(3-s)&63):n+t.b64Pad}return n}function o(t){var n={outputUpper:!1,b64Pad:"="};try{t.hasOwnProperty("outputUpper")&&(n.outputUpper=t.outputUpper),t.hasOwnProperty("b64Pad")&&(n.b64Pad=t.b64Pad)}catch(r){}return"boolean"!=typeof n.outputUpper&&e("Invalid outputUpper formatting option"),"string"!=typeof n.b64Pad&&e("Invalid b64Pad formatting option"),n}function u(e,t){var n=(e&65535)+(t&65535);return((e>>>16)+(t>>>16)+(n>>>16)&65535)<<16|n&65535}function a(e,t,n,r,i){var s=(e&65535)+(t&65535)+(n&65535)+(r&65535)+(i&65535);return((e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(i>>>16)+(s>>>16)&65535)<<16|s&65535}function f(e,t){var n=[],r,i,s,o,f,l,c,h,p,d=[1732584193,4023233417,2562383102,271733878,3285377520],v=[1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782];e[t>>>5]|=128<<24-t%32,e[(t+65>>>9<<4)+15]=t,p=e.length;for(c=0;c<p;c+=16){r=d[0],i=d[1],s=d[2],o=d[3],f=d[4];for(h=0;80>h;h+=1)n[h]=16>h?e[h+c]:(n[h-3]^n[h-8]^n[h-14]^n[h-16])<<1|(n[h-3]^n[h-8]^n[h-14]^n[h-16])>>>31,l=20>h?a(r<<5|r>>>27,i&s^~i&o,f,v[h],n[h]):40>h?a(r<<5|r>>>27,i^s^o,f,v[h],n[h]):60>h?a(r<<5|r>>>27,i&s^i&o^s&o,f,v[h],n[h]):a(r<<5|r>>>27,i^s^o,f,v[h],n[h]),f=o,o=s,s=i<<30|i>>>2,i=r,r=l;d[0]=u(r,d[0]),d[1]=u(i,d[1]),d[2]=u(s,d[2]),d[3]=u(o,d[3]),d[4]=u(f,d[4])}return d}window.jsSHA=function(u,a,l){var c=null,h=0,p=[0],d=0,m=null,d="undefined"!=typeof l?l:8;8===d||16===d||e("charSize must be 8 or 16"),"HEX"===a?(0!==u.length%2&&e("srcString of HEX type must be in byte increments"),m=n(u),h=m.binLen,p=m.value):"ASCII"===a||"TEXT"===a?(m=t(u,d),h=m.binLen,p=m.value):"B64"===a?(m=r(u),h=m.binLen,p=m.value):e("inputFormat must be HEX, TEXT, ASCII, or B64"),this.getHash=function(t,n,r){var u=null,a=p.slice(),l="";switch(n){case"HEX":u=i;break;case"B64":u=s;break;default:e("format must be HEX or B64")}return"SHA-1"===t?(null===c&&(c=f(a,h)),l=u(c,o(r))):e("Chosen SHA variant is not supported"),l},this.getHMAC=function(u,a,l,c,m){var y,b,E,S,x,T,N=[],C=[],k=null;switch(c){case"HEX":y=i;break;case"B64":y=s;break;default:e("outputFormat must be HEX or B64")}"SHA-1"===l?(E=64,T=160):e("Chosen SHA variant is not supported"),"HEX"===a?(k=n(u),x=k.binLen,b=k.value):"ASCII"===a||"TEXT"===a?(k=t(u,d),x=k.binLen,b=k.value):"B64"===a?(k=r(u),x=k.binLen,b=k.value):e("inputFormat must be HEX, TEXT, ASCII, or B64"),u=E*8,a=E/4-1,E<x/8?("SHA-1"===l?b=f(b,x):e("Unexpected error in HMAC implementation"),b[a]=b[a]&4294967040):E>x/8&&(b[a]=b[a]&4294967040);for(E=0;E<=a;E+=1)N[E]=b[E]^909522486,C[E]=b[E]^1549556828;return"SHA-1"===l?S=f(C.concat(f(N.concat(p),u+h)),u+T):e("Unexpected error in HMAC implementation"),y(S,o(m))}}}(),n("../external/jsSHA/sha1",function(){}),n("util/shims",[],function(){window.console||(window.console={log:function(){},warn:function(){},debug:function(){},info:function(){},error:function(){}}),window.localStorage||(window.localStorage={getItem:function(){},setItem:function(){},removeItem:function(){}});if(!navigator.id){var e=document.createElement("script");e.src="https://login.persona.org/include.js",e.type="text/javascript",e.setAttribute("data-butter-exclude",!0),document.head.appendChild(e),navigator.id={_shimmed:!0,get:function(){}}}if("Range"in window&&!Range.prototype.createContextualFragment){var t={getDocument:function(t){if(t.nodeType===9)return t;if(typeof t.ownerDocument!="undefined")return t.ownerDocument;if(typeof t.document!="undefined")return t.document;if(t.parentNode)return this.getDocument(t.parentNode);throw"No document found for node."},isCharacterDataNode:function(e){var t=e.nodeType;return t===3||t===4||t===8},parentElement:function(e){var t=e.parentNode;return t.nodeType===1?t:null},isHtmlNamespace:function(e){var t;return typeof e.namespaceURI=="undefined"||(t=e.namespaceURI)===null||t==="http://www.w3.org/1999/xhtml"},fragmentFromNodeChildren:function(e){var t=this.getDocument(e).createDocumentFragment(),n;while(!!(n=e.firstChild))t.appendChild(n);return t}};Range.prototype.createContextualFragment=function(e){var n=this.startContainer,r=t.getDocument(n);if(!n)throw new DOMException("INVALID_STATE_ERR");var i=null;return n.nodeType===1?i=n:t.isCharacterDataNode(n)&&(i=t.parentElement(n)),i===null||i.nodeName==="HTML"&&t.isHtmlNamespace(t.getDocument(i).documentElement)&&t.isHtmlNamespace(i)?i=r.createElement("body"):i=i.cloneNode(!1),i.innerHTML=e,t.fragmentFromNodeChildren(i)}}typeof document!="undefined"&&!("classList"in document.createElement("a"))&&function(e){var t="classList",n="prototype",r=(e.HTMLElement||e.Element)[n],i=Object,s=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[n].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(t in this&&this[t]===e)return t;return-1},u=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},a=function(e,t){if(t==="")throw new u("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new u("INVALID_CHARACTER_ERR","String contains an invalid character");return o.call(e,t)},f=function(e){var t=s.call(e.className),n=t?t.split(/\s+/):[],r=0,i=n.length;for(;r<i;r++)this.push(n[r]);this._updateClassName=function(){e.className=this.toString()}},l=f[n]=[],c=function(){return new f(this)};u[n]=Error[n],l.item=function(e){return this[e]||null},l.contains=function(e){return e+="",a(this,e)!==-1},l.add=function(e){e+="",a(this,e)===-1&&(this.push(e),this._updateClassName())},l.remove=function(e){e+="";var t=a(this,e);t!==-1&&(this.splice(t,1),this._updateClassName())},l.toggle=function(e){e+="",a(this,e)===-1?this.add(e):this.remove(e)},l.toString=function(){return this.join(" ")};if(i.defineProperty){var h={get:c,enumerable:!0,configurable:!0};try{i.defineProperty(r,t,h)}catch(p){p.number===-2146823252&&(h.enumerable=!1,i.defineProperty(r,t,h))}}else i[n].__defineGetter__&&r.__defineGetter__(t,c)}(self);return}),n("core/eventmanager",[],function(){function e(t,n,r){var i=!1;Object.defineProperties(this,{type:{value:t},target:{value:n},data:{value:r},propagationStopped:{get:function(){return i}}}),this.stopPropagation=function(){i=!0},this.clone=function(){return new e(t,n,r)}}function t(e){return e.listen&&e.unlisten}function n(e,n,r){if(!t(n))throw"Error: Object is not a valid event source: "+n;var i=r.length;while(i--)n.listen(r[i],e.dispatch)}function r(e,n,r){if(!t(n))throw"Error: Object is not a valid event source: "+n;var i=r.length;while(i--)n.unlisten(r[i],e.dispatch)}function i(e,t,n){var r,i;if(t[e]){r=t[e].slice(),i=r.length;while(i--&&!n.propagationStopped)r[i](n)}}function s(t,n,r,i){var s,o,u,a;if(r instanceof e)o=r.clone(),a=o.type;else{if(typeof r!="string")throw"Invalid event dispatch parameters.";o=new e(r+"",t,i),a=r}u=n+a,s=document.createEvent("CustomEvent"),s.initCustomEvent(u,!1,!1,o),document.dispatchEvent(s)}function o(e,t,n,r,i,s){var o,u;if(typeof n=="object")for(o in n)n.hasOwnProperty(o)&&e.listen(o,n[o]);else u=t+n,i[u]||(i[u]=[],document.addEventListener(u,s,!1)),i[u].push(r)}function u(e,t,n,r,i,s){var o,u,a,f=t+n;if(typeof n=="object")for(a in n)n.hasOwnProperty(a)&&e.unlisten(a,n[a]);else{o=i[f];if(!o)return;if(!r)throw"Removing listeners without specifying a listener explicitly is prohibited. Please remove listeners directly.";u=o.indexOf(r),u>-1&&o.splice(u,1),o.length===0&&(delete i[f],document.removeEventListener(f,s,!1))}}function f(e){if(!e||t(e))return;var f={},l="butter-"+a++ +":",c=function(e){i(e.type,f,e.detail)};return e.chain=function(e,t){n(this,e,t)},e.unchain=function(e,t){r(this,e,t)},e.dispatch=function(e,t){s(this,l,e,t,f)},e.listen=function(e,t){o(this,l,e,t,f,c)},e.unlisten=function(e,t){u(this,l,e,t,f,c)},e}var a=Date.now();return{extend:f}}),function(e){var t=!1;n("core/logger",[],function(){function n(e){this.log=function(n){t&&console.log("["+e+"] "+n)},this.error=function(n){if(t)throw new Error("["+e+"] "+n)}}return n.enabled=function(n){return n!==e&&(t=!!n),t},n})}(),function(e){function s(e,t){var n=i[e];return!n||!n.validate?t:n.validate(t)}function o(t,n){if(t===e)return t;var r=t,s,o,u;for(var a in i)i.hasOwnProperty(a)&&(s=i[a],o=n[a],u=o?o:s.defaultValue,r=r.replace?r.replace(s.name,u,"g"):r);return r}function u(t,n){if(t===e)return t;for(var r in t)t.hasOwnProperty(r)&&(typeof t[r]=="object"?t[r]=u(t[r],n):t[r]=o(t[r],n));return t}var t={},r=0,i={baseDir:{name:"{{baseDir}}",defaultValue:"./",validate:function(e){return e.replace(/\/?$/,"/")}}};n("core/config",[],function(){function n(n,r){if(typeof r!="object")throw"Config Error: expected parsed config object";t[n]=r,this.value=function(t,n){var i;return n!==e&&(r[t]=s(t,n)),i=r[t],typeof i=="object"?u(i,r):o(i,r)},this.override=function(e){var n=r,i=t[e.id];for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},Object.defineProperty(this,"id",{get:function(){return n}})}var i={parse:function(e){try{var t=JSON.parse(e);return new n("config-"+r++,t)}catch(i){throw"Config.parse Error: unable to parse config string. Error was: "+i.message}},reincarnate:function(e){return new n("config-"+r++,e)}};return i})}(),n("core/observer",[],function(){function e(e,t,n){var r;this.cancel=function(e){r=e||!0},Object.defineProperties(this,{origin:{value:e,enumerable:!0},type:{value:t,enumerable:!0},data:{value:n,enumerable:!0},cancelledReason:{enumerable:!0,get:function(){return r}},cancelled:{enumerable:!0,get:function(){return!!r}}})}function t(e,t,n){n[e]||(n[e]=[]),n[e].push(t)}function n(e,t,n){var r,i=n[e];i&&(r=i.indexOf(t),r>-1&&i.splice(r,1))}function r(t,n,r,i){var s,o,u=r[t],a=new e(i,t,n);if(u)for(s=0,o=u.length;s<o;++s){u[s](a);if(a.cancelled)break}return a}function i(e){var i={};if(e.subscribe)throw"Object already has Observer properties.";e.subscribe=function(e,n){t(e,n,i)},e.unsubscribe=function(e,t){n(e,t,i)},e.notify=function(t,n){return r(t,n,i,e)}}return{extend:i}}),n("util/lang",[],function(){var e=15,t=function(){var e=document.createElement("div"),t="Webkit Moz O ms".split(" ").map(function(e){return e+"Transform"});for(var n=t.length;n>=0;--n)if(e.style[t[n]]!==undefined)return t[n];return"transform"}(),n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return{escapeHTML:function(e){return String(e).replace(/&(?!\w+;)|[<>"']/g,function(e){return n[e]||e})},extend:function(e){var t=e,n=[].slice.call(arguments,1);n.forEach(function(e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})},smpteToSeconds:function(e){var t=e.split(":");if(t.length===1)return parseFloat(t[0],10);if(t.length===2)return parseFloat(t[0],10)+parseFloat(t[1]/12,10);if(t.length===3)return parseInt(t[0]*60,10)+parseFloat(t[1],10)+parseFloat(t[2]/12,10);if(t.length===4)return parseInt(t[0]*3600,10)+parseInt(t[1]*60,10)+parseFloat(t[2],10)+parseFloat(t[3]/12,10)},secondsToSMPTE:function(e){var t=new Date(1970,0,1),n;return t.setSeconds(e),n=t.toTimeString().substr(0,8),n>86399&&(n=Math.floor((t-Date.parse("1/1/70"))/36e5)+n.substr(2)),n},clone:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},defaults:function(e,t){for(var n in t)e[n]===undefined&&(e[n]=t[n]);return e},domFragment:function(e,t){var n=document.createRange(),r=document.body||document.head,i,s;n.selectNode(r),i=n.createContextualFragment(e);if(t){s=i.querySelector(t);if(s)return s.parentNode.removeChild(s),s}return i},applyTransitionEndListener:function(){var t=document.createElement("div"),n,r=["OTransition","webkitTransition","MozTransition","transition"];for(n in r)if(t.style[r[n]]!==undefined)return function(e,t){e.addEventListener("transitionend",t,!1),e.addEventListener("oTransitionEnd",t,!1),e.addEventListener("webkitTransitionEnd",t,!1)};return function(t,n){var r=t.getAttribute("data-butter-transition-end");typeof r=="string"&&r!==""&&clearTimeout(r|0),r=setTimeout(function(){t.removeAttribute("data-butter-transition-end"),n.apply(this,arguments)},e),t.setAttribute("data-butter-transition-end",r)}}(),removeTransitionEndListener:function(e,t){e.removeEventListener("transitionend",t,!1),e.removeEventListener("oTransitionEnd",t,!1),e.removeEventListener("webkitTransitionEnd",t,!1)},setTransformProperty:function(e,n){e.style[t]=n},getTransformProperty:function(e){return e.style[t]}}}),n("util/time",[],function(){function t(t,n){return n=n>=0?n:e,Math.round(t*Math.pow(10,n))/Math.pow(10,n)}function n(e){var t,n,r,i,s=1;return typeof e=="number"?e:typeof e!="string"?0:(e=e.trim(),e.substring(0,1)==="-"&&(e=e.replace("-",""),s=-1),t=e.split(":"),n=+t[t.length-1]||0,r=+t[t.length-2]||0,i=+t[t.length-3]||0,n+=i*3600,n+=r*60,n*s)}function r(e){var r,i,s,o,u="";return typeof e=="string"&&(e=n(e)),typeof e!="number"?0:(e<0&&(u="-",e=-e),r=Math.floor(e/3600),i=Math.floor(e%3600/60),s=t(e%60,2),o=s+"",!i&&!r?u+o:(s?s<10?o=":0"+s:o=":"+o:o=":00",i?r&&i<10?o="0"+i+o:o=i+o:o="00"+o,r&&(o=r+":"+o),u+o))}function i(e){var t=Math.round,n,r,i,s,o;return n=e/1e3,r=t(n%60),n/=60,i=t(n%60),n/=60,s=t(n%24),n/=24,o=t(n),o>=1?""+o+(o===1?" day":" days"):s>=1?""+s+(s===1?" hour":" hours"):i>=1?""+i+(i===1?" minute":" minutes"):"less than a minute"}var e=5,s={roundTime:t,toSeconds:n,toTimecode:r,toPrettyString:i};return Object.defineProperties(s,{timeAccuracy:{enumerable:!0,get:function(){return e},set:function(t){e=t}}}),s}),n("util/scroll-group",[],function(){function e(e){this.scrollDiff=[0,0],this.scrollOrigin=[0,0],this.boundingClientRect=null,this.scrollElement=e,this.iterationScrollX=0,this.iterationScrollY=0}function t(){e.call(this,arguments)}return e.prototype.updateBounds=function(){this.scrollOrigin[0]=this.scrollElement.scrollLeft,this.scrollOrigin[1]=this.scrollElement.scrollTop,this.boundingClientRect=this.scrollElement.getBoundingClientRect()},e.prototype.processIteration=function(){this.scrollElement.scrollLeft+=this.iterationScrollX,this.scrollElement.scrollTop+=this.iterationScrollY,this.scrollDiff[0]=this.scrollElement.scrollLeft-this.scrollOrigin[0],this.scrollDiff[1]=this.scrollElement.scrollTop-this.scrollOrigin[1],this.iterationScrollX=0,this.iterationScrollY=0},t.prototype=Object.create(e),t.prototype.update=function(){},{ScrollGroup:e,NullScrollGroup:t}}),n("util/dragndrop",["core/eventmanager","util/lang","util/scroll-group"],function(e,t,n){function N(e){var t,r;if(e){for(t=w.length-1;t>=0;--t)if(w[t].scrollElement===e)return w[t];return r=new n.ScrollGroup(e),w.push(r),r}return E}function C(){var e,t,n=v,i,s;y=!1;if(d){for(e=v.length-1;e>=0;--e)v[e].update();for(e=w.length-1;e>=0;--e)w[e].processIteration();for(e=n.length-1;e>=0;--e){i=n[e],i.drag();for(t=p.length-1;t>=0;--t){s=p[t];if(i.element!==s.element&&!!s.drag(i.element.getBoundingClientRect())){i.droppable&&i.droppable!==s&&i.droppable.forget(i),s.remember(i);break}s.forget(i)}}window.setTimeout(C,r)}}function k(e){e.preventDefault()}function L(e){e.preventDefault(),g[0]=m[0],g[1]=m[1],m=[e.clientX,e.clientY];var t=v,n;if(!d){d=!0;for(n=w.length-1;n>=0;--n)w[n].updateBounds();for(n=t.length-1;n>=0;--n)t[n].start(e);C(),window.addEventListener("dragstart",k,!1),T.dispatch("dragstarted")}}function A(){window.removeEventListener("dragstart",k,!1),window.removeEventListener("mousemove",L,!1),window.removeEventListener("mousemove",A,!1);if(!d)return;T.dispatch("dragstopped"),d=!1;var e,t=v.slice(),n=[],r,i;for(i=t.length-1;i>=0;--i)e=t[i],r=e.droppable,r&&n.indexOf(r)===-1&&n.push(r);for(i=n.length-1;i>=0;--i)n[i].startDrop();for(i=t.length-1;i>=0;--i)e=t[i],e.stop();for(i=t.length-1;i>=0;--i)e=t[i],e.drop();for(i=t.length-1;i>=0;--i)e=t[i],e.reset();for(i=n.length-1;i>=0;--i)n[i].stopDrop();T.dispatch("dropfinished")}function O(e){if(e.which!==1||e.ctrlKey){A(e);return}e.stopPropagation(),window.addEventListener("mousemove",L,!1),window.addEventListener("mouseup",A,!1)}function M(e){var t=getComputedStyle(e),n=t.getPropertyValue("padding-top"),r=t.getPropertyValue("padding-left"),i=t.getPropertyValue("padding-bottom"),s=t.getPropertyValue("padding-right");return{top:Number(n.substring(0,n.indexOf("px"))),left:Number(r.substring(0,r.indexOf("px"))),bottom:Number(i.substring(0,i.indexOf("px"))),right:Number(s.substring(0,s.indexOf("px")))}}function _(e,t){var n=t.parentNode;while(n){if(n===e)return!0;n=n.parentNode}return!1}function D(e){var t=getComputedStyle(e).zIndex;if(isNaN(t)){t=0;var n=e.parentNode;while(n&&[window,document].indexOf(n)===-1){var r=getComputedStyle(n);if(r){var i=r.zIndex;isNaN(i)&&i>t&&(t=i)}n=n.parentNode}}}function P(){p=p.sort(function(e,t){var n=e.element,r=t.element,i=D(n),s=D(r);return _(n,r)?-1:_(r,n)?1:i-s})}function H(e,t){function E(t){function N(){var t=S-E,r=o+t,u=c-t;b=null;if(u<f)return;v&&v.scrollLeft>0&&n.left+t<m.left-s&&(v.scrollLeft-=i,r-=i,u+=i,E+=i),r<0&&(u+=r,r=0),(y[0]!==r||y[1]!==u)&&h(r,u,w),b===null?(e.style.left=r+"px",e.style.width=u-p+"px",g=e.getBoundingClientRect(),y[0]=r,y[1]=u):(r=b,u=o+c-r,e.style.left=r+"px",e.style.width=u-p+"px",g=e.getBoundingClientRect(),y[0]=r,y[1]=u)}function C(){window.removeEventListener("mousemove",k,!1),window.removeEventListener("mouseup",C,!1),clearInterval(d),d=-1,a(w),e.classList.remove(l),T.dispatch("resizestopped")}function k(e){e.preventDefault(),S=e.clientX,d===-1&&(y=[],w.direction="left",d=setInterval(N,r),u(w))}t.stopPropagation();var n=e.getBoundingClientRect(),o=e.offsetLeft,c=e.clientWidth,E=t.clientX,S,x;g=e.getBoundingClientRect(),x=t.clientX-g.left,m=v.getBoundingClientRect(),e.classList.add(l),window.addEventListener("mousemove",k,!1),window.addEventListener("mouseup",C,!1),T.dispatch("resizestarted")}function S(t){function S(){var t=p-c,r=o+t;b=null;if(r<f)return;v&&v.scrollLeft<v.scrollWidth-m.width&&p>m.right+s&&(v.scrollLeft+=i,c-=i),r+n>e.offsetParent.offsetWidth&&(r=e.offsetParent.offsetWidth-n),y[1]!==r&&h(n,r,w),b===null?(e.style.width=r+"px",g=e.getBoundingClientRect(),y[1]=r):(r=b-n,e.style.width=r+"px",g=e.getBoundingClientRect(),y[1]=r)}function x(){window.removeEventListener("mousemove",N,!1),window.removeEventListener("mouseup",x,!1),clearInterval(d),d=-1,a(w),e.classList.remove(l),T.dispatch("resizestopped")}function N(e){p=e.clientX,d===-1&&(y=[],w.direction="right",d=setInterval(S,r),u(w))}t.stopPropagation();var n=e.offsetLeft,o=e.offsetWidth,c=t.clientX,p,E;g=e.getBoundingClientRect(),v&&(m=v.getBoundingClientRect()),E=t.clientX-g.left,e.classList.add(l),window.addEventListener("mousemove",N,!1),window.addEventListener("mouseup",x,!1),T.dispatch("resizestarted")}var n=e.querySelector(".handle.left-handle"),o=e.querySelector(".handle.right-handle"),u=t.start||c,a=t.stop||c,h=t.resize||c,p=t.padding||0,d=-1,v=t.scroll,m,g,y,b,w={blockIteration:function(e){b=e},direction:null};return n.addEventListener("mousedown",E,!1),o.addEventListener("mousedown",S,!1),{destroy:function(){n.removeEventListener("mousedown",E,!1),o.removeEventListener("mousedown",S,!1)}}}function B(e,t){t=t||{};var n=t.image,r=t.start||c,i=t.stop||c,s=b.length;b[s]={element:e,pluginOptions:t.pluginOptions},e.setAttribute("draggable",!0),e.addEventListener("dragstart",function(i){S={element:e,pluginOptions:t.pluginOptions},i.dataTransfer.effectAllowed="all",i.dataTransfer.setData("text",s+"");if(n){var o=document.createElement("img");o.src=n.src,i.dataTransfer.setDragImage(o,o.width/2,o.height/2)}r()}),e.addEventListener("dragend",function(){S=null,i()}),e.addEventListener("drop",function(){})}function j(e,t){function h(t){var i,s;t.stopPropagation(),t.preventDefault(),n&&e.classList.remove(n);try{i=t.dataTransfer.getData("text")}catch(o){return}s=b[i]||S,s&&r(s.element,[t.clientX,t.clientY],s.pluginOptions)}function d(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"}function v(t){var r,s;n&&e.classList.add(n);try{r=t.dataTransfer.getData("text")}catch(o){return}s=b[r]||S,s&&i(s.element,[t.clientX,t.clientY])}function g(t){var r,i;n&&e.classList.remove(n);try{r=t.dataTransfer.getData("text")}catch(o){return}i=b[r]||S,i&&s(i.element,[t.clientX,t.clientY])}function y(t){var r=l.indexOf(t);return r>-1&&(l.splice(r,1),l.length===0&&e.classList.remove(n)),r>-1}t=t||{};var n=t.hoverClass,r=t.drop||c,i=t.over||c,s=t.out||c,o=t.startDrop||c,u=t.stopDrop||c,a={},f=t.data,l=[];return e.addEventListener("drop",h,!1),e.addEventListener("dragover",d,!1),e.addEventListener("dragenter",v,!1),e.addEventListener("dragleave",g,!1),a={element:e,startDrop:o,stopDrop:u,remember:function(t){var r=l.indexOf(t);r===-1&&(l.push(t),e.classList.add(n),t.droppable=a,i(t.element))},forget:function(e){y(e)&&(e.droppable=null,s(e.element))},drop:function(e){y(e)&&r(e,m)},drag:function(t){var n=e.getBoundingClientRect(),r=Math.max(t.left,n.left),i=Math.max(t.top,n.top),s=Math.min(t.right,n.right),o=Math.min(t.bottom,n.bottom);return s<r||o<i?!1:o-i>t.height/2?!0:!1},destroy:function(){var t=p.indexOf(a);t>-1&&p.splice(t,1),e.removeEventListener("drop",h,!1),e.removeEventListener("dragover",d,!1),e.removeEventListener("dragenter",v,!1),e.removeEventListener("dragleave",g,!1)}},Object.defineProperties(a,{data:{enumerable:!0,get:function(){return f}}}),p.push(a),P(),a}function F(e,n){function q(){var e=m[0]-T[0]+f.scrollDiff[0],t=m[1]-T[1]+f.scrollDiff[1];E[0]=l?e:0,E[1]=p?t:0}function R(){var e;e=f.boundingClientRect,m[0]>e.right+s?(y=!0,f.iterationScrollX=L):m[0]<e.left-s&&(y=!0,f.iterationScrollX=-L),m[1]>e.bottom+s?(y=!0,f.iterationScrollY=L):m[1]<e.top-s&&(y=!0,f.iterationScrollY=-L)}function U(){var e=E[0],t=E[1];if(!p&&!l||p)t<w[0]+f.scrollDiff[1]?t=w[0]+f.scrollDiff[1]+f.iterationScrollY:t>w[1]+f.scrollDiff[1]&&(t=w[1]+f.scrollDiff[1]+f.iterationScrollY),t<g[0]?t=g[0]:t>g[1]&&(t=g[1]),E[1]=t;if(!p&&!l||l)e<b[0]+f.scrollDiff[0]?e=b[0]+f.scrollDiff[0]+f.iterationScrollX:e>b[1]+f.scrollDiff[0]&&(e=b[1]+f.scrollDiff[0]+f.iterationScrollX),e<d[0]?e=d[0]:e>d[1]&&(e=d[1]),E[0]=e}n=n||{};var r=n.containment,f=N(n.scroll),l=!n.axis||n.axis.indexOf("x")>-1?!0:!1,p=!n.axis||n.axis.indexOf("y")>-1?!0:!1,d=[],g=[],b=[],w=[],E=[],S=n.revert,T=[0,0],C=e,k,L=n.scrollAmount||i,A,_=n.start||c,D=n.stop||h,P=n.drag||c,H,B={},j=n.data,F=x,I={top:0,bottom:0,left:0,right:0};return r&&(F=M(r)),B.updateRects=function(){var t,n;k=e.getBoundingClientRect(),r&&(t=r.getBoundingClientRect(),d[0]=t.left-k.left,d[1]=t.right-k.right,g[0]=t.top-k.top,g[1]=t.bottom-k.bottom),f&&(n=f.boundingClientRect,b[0]=n.left-k.left-k.width+u,b[1]=n.right-k.right+k.width-u,w[0]=n.top-k.top+k.height-o,w[1]=n.bottom-k.bottom-k.height+o)},e.addEventListener("mousedown",O,!1),B.droppable=null,B.destroy=function(){B.selected=!1,e.removeEventListener("mousedown",O,!1)},B.update=function(){q(),f&&R(),r&&U(),t.setTransformProperty(e,"translate("+E[0]+"px, "+E[1]+"px)"),I.top=k.top+E[1]-f.scrollDiff[1],I.bottom=k.bottom+E[1]-f.scrollDiff[1],I.left=k.left+E[0]-f.scrollDiff[0],I.right=k.right+E[0]-f.scrollDiff[0]},B.getLastRect=function(){return I},B.getLastOffset=function(){return E},B.start=function(t){H=[e.offsetLeft,e.offsetTop],T=[t.clientX,t.clientY],_(),B.updateRects(),q()},B.drag=function(){B.droppable&&P(B,B.droppable)},B.drop=function(){B.droppable&&B.droppable.drop(B)},B.stop=function(){H&&(t.setTransformProperty(C,""),D())},B.reset=function(){!B.droppable&&S&&H&&(e.style.left=H[0]+"px",e.style.top=H[1]+"px"),B.droppable=null,H=null},Object.defineProperties(B,{data:{enumerable:!0,get:function(){return j}},selected:{enumerable:!0,get:function(){for(var e=v.length-1;e>=0;--e)if(v[e].element===C)return!0;return!1},set:function(t){if(t)A=getComputedStyle(e).getPropertyValue("z-index"),e.style.zIndex=a,v.push(B);else{e.style.zIndex=A;for(var n=v.length-1;n>=0;--n)if(v[n].element===C){v.splice(n,1);return}}}},element:{enumerable:!0,get:function(){return C}}}),B}function I(e,t){function d(t){var n=t.cloneNode(!1);return n.classList.add("placeholder"),e.replaceChild(n,t),n}function v(e){o.style.top=u-e+"px"}function m(t){if(!f)f=!0,h=d(o),e.appendChild(o),o.style.position="absolute",o.style.zIndex=a,v(0);else{var i=s-t.clientY;v(i);var u=o.getBoundingClientRect();for(var c=r.length-1;c>=0;--c){var p=r[c];if(p===o)continue;var m=p.getBoundingClientRect(),g=Math.max(u.left,m.left),y=Math.max(u.top,m.top),b=Math.min(u.right,m.right),w=Math.min(u.bottom,m.bottom);if(b<g||w<y)continue;if(w-y>u.height/2){l=p;var E=d(l);e.replaceChild(l,h),h=E;var S=[],x=e.childNodes;for(var T=0,N=x.length;T<N;++T){var C=x[T];C!==o&&(C!==h?S.push(C):S.push(o))}n(S)}}}}function g(e){if(e.which!==1)return;f=!1,o=this,u=o.offsetTop;var t=getComputedStyle(o);p=t.getPropertyValue("z-index"),s=e.clientY,window.addEventListener("mouseup",y,!1),window.addEventListener("mousemove",m,!1),T.dispatch("sortstarted",e)}function y(){o.style.zIndex=p,window.removeEventListener("mouseup",y,!1),window.removeEventListener("mousemove",m,!1),f=!1,h&&(o.style.zIndex="",o.style.position="",o.style.top="",e.replaceChild(o,h),h=null),T.dispatch("sortstopped")}var n=t.change||c,r=[],i={},s=0,o,u,f,l,h,p;return i.addItem=function(e){r.push(e),e.addEventListener("mousedown",g,!1)},i.removeItem=function(e){r.splice(r.indexOf(e),1),e.removeEventListener("mousedown",g,!1)},i}var r=16,i=10,s=10,o=50,u=10,a=2147483647,f=15,l="butter-resizable",c=function(){},h=function(){return!1},p=[],d=!1,v=[],m=[0,0],g=[0,0],y=!1,b=[],w=[],E=new n.NullScrollGroup,S,x={top:0,left:0,bottom:0,right:0},T={};return T.draggable=F,T.droppable=j,T.helper=B,T.resizable=H,T.sortable=I,Object.defineProperties(T,{isDragging:{get:function(){return d}}}),e.extend(T),T}),n("text",["module"],function(e){var n=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],r=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,i=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,s=typeof location!="undefined"&&location.href,o=s&&location.protocol&&location.protocol.replace(/\:/,""),u=s&&location.hostname,a=s&&(location.port||undefined),f=[],l=e.config&&e.config()||{},c,h;return c={version:"2.0.1",strip:function(e){if(e){e=e.replace(r,"");var t=e.match(i);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:l.createXhr||function(){var e,t,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){r=n[t];try{e=new ActiveXObject(r)}catch(i){}if(e){n=[r];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,r){var i=c.xdRegExp.exec(e),s,o,u;return i?(s=i[2],o=i[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===t)&&(!o||o.toLowerCase()===n.toLowerCase())&&(!u&&!o||u===r)):!0},finishLoad:function(e,t,n,r){n=t?c.strip(n):n,l.isBuild&&(f[e]=n),r(n)},load:function(e,t,n,r){if(r.isBuild&&!r.inlineText){n();return}l.isBuild=r.isBuild;var i=c.parseName(e),f=i.moduleName+"."+i.ext,h=t.toUrl(f),p=l.useXhr||c.useXhr;!s||p(h,o,u,a)?c.get(h,function(t){c.finishLoad(e,i.strip,t,n)},function(e){n.error&&n.error(e)}):t([f],function(e){c.finishLoad(i.moduleName+"."+i.ext,i.strip,e,n)})},write:function(e,t,n,r){if(f.hasOwnProperty(t)){var i=c.jsEscape(f[t]);n.asModule(e+"!"+t,"define(function () { return '"+i+"';});\n")}},writeFile:function(e,t,n,r,i){var s=c.parseName(t),o=s.moduleName+"."+s.ext,u=n.toUrl(s.moduleName+"."+s.ext)+".js";c.load(o,n,function(t){var n=function(e){return r(u,e)};n.asModule=function(e,t){return r.asModule(e,u,t)},c.write(e,o,n,i)},i)}},typeof process!="undefined"&&process.versions&&!!process.versions.node?(h=t.nodeRequire("fs"),c.get=function(e,t){var n=h.readFileSync(e,"utf8");n.indexOf("﻿")===0&&(n=n.substring(1)),t(n)}):c.createXhr()?c.get=function(e,t,n){var r=c.createXhr();r.open("GET",e,!0),l.onXhr&&l.onXhr(r,e),r.onreadystatechange=function(i){var s,o;r.readyState===4&&(s=r.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=r,n(o)):t(r.responseText))},r.send(null)}:typeof Packages!="undefined"&&(c.get=function(e,t){var n="utf-8",r=new java.io.File(e),i=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),n)),o,u,a="";try{o=new java.lang.StringBuffer,u=s.readLine(),u&&u.length()&&u.charAt(0)===65279&&(u=u.substring(1)),o.append(u);while((u=s.readLine())!==null)o.append(i),o.append(u);a=String(o.toString())}finally{s.close()}t(a)}),c}),n("text!layouts/trackevent.html",[],function(){return'<div class="butter-track-event" data-butter-draggable-type="trackevent">\n\n  <div class="butter-track-event-info">\n    <span class="butter-track-event-icon"></span>\n    <div class="title"></div>\n  </div>\n\n  <div class="handle left-handle"></div>\n  <div class="handle right-handle"></div>\n\n</div>\n'}),n("core/views/trackevent-view",["core/logger","core/eventmanager","util/dragndrop","util/lang","text!layouts/trackevent.html"],function(e,t,n,r,i){var s=50;return function(e,o,u){function k(){if(!y.track||!y.track._media)return;y.track.view.element!==a.parentNode&&y.track.view.element.appendChild(a),a.style.left=c/y.track._media.duration*100+"%",a.style.width=(h-c)/y.track._media.duration*100+"%"}function L(){m&&!m.selected&&(m.selected=!0),a.setAttribute("selected",!0)}function A(){m&&m.selected&&(m.selected=!1),a.removeAttribute("selected")}var a=r.domFragment(i,".butter-track-event"),f=o,l=document.getElementById(f+"-icon"),c=u.start||0,h=u.end||c+1,p,d,v=a.querySelector(".title"),m,g,y=e,b=!1,w=!1,E=0,S,x,T,N,C=this;t.extend(C),this.setToolTip=function(e){a.title=e},this.update=function(e){e=e||{},a.style.top="0px",isNaN(e.start)||(c=e.start),isNaN(e.end)||(h=e.end),k()},this.createGhost=function(){if(x)return x;var e=a.cloneNode(!1);return e.style.top="",e.style.left=a.style.left,e.classList.add("butter-track-event-ghost"),r.setTransformProperty(e,""),x={element:e},x},this.cleanupGhost=function(){x.track.view.removeTrackEventGhost(x),x=null},this.updateGhost=function(){r.setTransformProperty(x.element,"translate("+m.getLastOffset()[0]+"px, 0px)")},this.setDragHandler=function(e){T=e},this.setResizeHandler=function(e){N=e},Object.defineProperties(this,{trackEvent:{enumerable:!0,get:function(){return y}},ghost:{enumerable:!0,get:function(){return x}},element:{enumerable:!0,get:function(){return a}},start:{enumerable:!0,get:function(){return c},set:function(e){c=e,k()}},end:{enumerable:!0,get:function(){return h},set:function(e){h=e,k()}},type:{enumerable:!0,get:function(){return f},set:function(e){f=e,a.setAttribute("data-butter-trackevent-type",f)}},elementText:{enumerable:!0,get:function(){return S},set:function(e){S=e,v.innerHTML=S}},selected:{enumerable:!0,get:function(){return m.selected},set:function(e){e?L():A()}},dragging:{enumerable:!0,get:function(){return b}},resizing:{enumerable:!0,get:function(){return w}},parent:{enumerabled:!0,get:function(){return p},set:function(e){p=e,m&&(m.destroy(),m=null),g&&(g.destroy(),g=null,d=null);if(p){if(p.element&&p.element.parentNode&&p.element.parentNode.parentNode){var t=getComputedStyle(a),r=t.paddingLeft?+t.paddingLeft.substring(0,t.paddingLeft.length-2):0,i=t.paddingRight?+t.paddingRight.substring(0,t.paddingRight.length-2):0;E=r+i,m=n.draggable(a,{containment:p.element.parentNode,scroll:p.element.parentNode.parentNode,data:C,start:function(){b=!0,a.classList.add("trackevent-dragging"),C.dispatch("trackeventdragstarted")},stop:function(){b=!1,a.classList.remove("trackevent-dragging"),C.dispatch("trackeventdragstopped")},drag:function(e,t){T&&T(e,t)},revert:!0}),m.selected=y.selected,g=n.resizable(a,{containment:p.element.parentNode,scroll:p.element.parentNode.parentNode,padding:E,start:function(e){w=!0,C.dispatch("trackeventresizestarted",e)},stop:function(e){w=!1,C.dispatch("trackeventresizestopped",e)},resize:function(e,t,n){t<s?a.classList.add("trackevent-small"):a.classList.remove("trackevent-small"),N&&N(y,e,t,n,n.direction)}}),a.setAttribute("data-butter-draggable-type","trackevent"),a.setAttribute("data-butter-trackevent-id",y.id)}k()}}}}),a.className="butter-track-event",l&&(a.querySelector(".butter-track-event-icon").style.backgroundImage="url( "+l.src+")"),C.type=f,C.update(u),a.addEventListener("mousedown",function(e){C.dispatch("trackeventmousedown",{originalEvent:e,trackEvent:y})},!0),a.addEventListener("mouseup",function(e){C.dispatch("trackeventmouseup",{originalEvent:e,trackEvent:y})},!1),a.addEventListener("mouseover",function(e){C.dispatch("trackeventmouseover",{originalEvent:e,trackEvent:y})},!1),a.addEventListener("mouseout",function(e){C.dispatch("trackeventmouseout",{originalEvent:e,trackEvent:y})},!1)}}),n("core/trackevent",["./logger","./eventmanager","./observer","util/lang","util/time","./views/trackevent-view"],function(e,t,n,r,i,s){var o=0,u={"trackevent-overlap":"The times you have entered cause trackevents to overlap.","invalid-start-time":"[start] is an invalid value.","invalid-end-time":"[end] is an invalid value.","start-greater-than-end":"[start] must be less than [end]."},a=function(e){this.type="trackevent-update",this.reason=e,this.message=u[e],this.toString=function(){return"TrackEvent update failed: "+this.message}},f=function(u){function b(e){return e.default?e.default:e.type==="number"?0:""}u=u||{};var f=this,l="TrackEvent"+o++,c=u.name||l,h=new e(l),p=null,d=u.type+"",v=u.popcornOptions||{start:0,end:1},m=new s(this,d,v),g=null,y=!1;t.extend(f),n.extend(f),f.popcornOptions=v,f.popcornTrackEvent=null,d?this.manifest=Popcorn.manifest[d]:h.log("Warning: "+l+" has no type."),v.start=v.start||0,v.start=i.roundTime(v.start),v.end=v.end||v.start+1,v.end=i.roundTime(v.end),this.bind=function(e,t){p=e,g=t},this.update=function(e,t){e=e||{};var n=e.start,r=e.end,i,s,o,u;if(isNaN(n)){if(e.hasOwnProperty("start"))throw new a("invalid-start-time","[start] is an invalid value.");n=v.start}if(isNaN(r)){if(e.hasOwnProperty("end"))throw new a("invalid-end-time","[end] is an invalid value.");r=v.end}if(n>r)throw new a("start-greater-than-end","[start] must be less than [end].");o=f.notify("update",e);if(o.cancelled)return;if(p&&p._media){s=p._media,u=s.duration;if(this.manifest){i=this.manifest.options;if(i){for(var l in i)i.hasOwnProperty(l)&&(e[l]===undefined?t&&(v[l]=b(i[l])):v[l]=e[l]);!("target"in i)&&e.target&&(v.target=e.target),"zindex"in i&&s&&(v.zindex=e.zindex=s.maxPluginZIndex-p.order)}}}v.start=n,v.end=r,f.popcornOptions=v,g&&g.synchronizeEvent(f,e)},this.unbind=function(e){!e&&g&&(g.destroyEvent(f),g=null),p=null},this.copy=function(){var e={},t={};if(this.manifest){t=f.manifest.options;if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=v[n])}return{popcornOptions:e,type:d,track:p}},Object.defineProperties(this,{track:{enumerable:!0,get:function(){return p}},view:{enumerable:!0,configurable:!1,get:function(){return m}},dragging:{enumerable:!0,get:function(){return m.dragging}},resizing:{enumerable:!0,get:function(){return m.resizing}},uiInUse:{enumerable:!0,get:function(){return m.resizing||m.dragging}},type:{enumerable:!0,get:function(){return d}},name:{enumerable:!0,get:function(){return c}},id:{enumerable:!0,get:function(){return l}},selected:{enumerable:!0,get:function(){return y},set:function(e){y=e,m.selected=y,y?(f.notify("selected"),f.dispatch("trackeventselected")):(f.notify("deselected"),f.dispatch("trackeventdeselected"))}},json:{enumerable:!0,get:function(){return{id:l,type:d,popcornOptions:r.clone(v),track:p?p.id:undefined,name:c}},set:function(e){d=v.type=e.type,this.manifest=Popcorn.manifest[d],e.name&&(c=e.name),v=e.popcornOptions,f.popcornOptions=v,m.type=d,m.update(v),f.dispatch("trackeventupdated",f)}}})};return f.MINIMUM_TRACKEVENT_SIZE=.02,f}),n("core/views/track-view",["core/logger","core/eventmanager","util/dragndrop"],function(e,t,n){var r=2;return function(e,i){function p(){h=n.droppable(f,{hoverClass:"draggable-hover",data:u,drop:function(e,t,n){var r=e.data?e.data.element:e,i=r.getAttribute("data-butter-draggable-type"),s,a,c,h,p=f.getBoundingClientRect(),d,v,m;i==="plugin"?(h=t[0]-p.left,a=h/p.width*l,u.dispatch("plugindropped",{start:a,track:o,type:r.getAttribute("data-popcorn-plugin-type"),popcornOptions:n})):i==="trackevent"&&(m=e.getLastRect(),v=e.data,d=v.trackEvent,s=d.popcornOptions.end-d.popcornOptions.start,h=m.left-p.left,a=h/p.width*l,c=a+s,u.dispatch("trackeventdropped",{start:a,end:c,track:o,trackEvent:v.trackEvent}))}})}function d(e){o.removeTrackEvent(e.target.trackEvent,!0)}var s=e,o=i,u=this,a=[],f=document.createElement("div"),l=1,c,h;t.extend(u),f.className="butter-track",f.setAttribute("data-butter-track-id",s),Object.defineProperties(this,{id:{enumerable:!0,get:function(){return s}},element:{enumerable:!0,configurable:!1,get:function(){return f}},duration:{enumerable:!0,get:function(){return l},set:function(e){l=e;for(var t=0,n=a.length;t<n;++t)a[t].update()}},parent:{enumerable:!0,get:function(){return c},set:function(e){c=e,h&&(h.destroy(),h=null),c&&p();for(var t=0,n=a.length;t<n;++t)a[t].parent=u}},track:{enumerable:!0,get:function(){return o}}}),this.addTrackEvent=function(e){var t=e.view.element;f.appendChild(t),a.push(e.view),e.view.parent=u,u.chain(e,["trackeventmousedown","trackeventmouseover","trackeventmouseout","trackeventmoved"]),e.view.listen("trackeventdragstopped",d)},this.removeTrackEvent=function(e){var t=e.view.element;t.parentNode.removeChild(t),a.splice(a.indexOf(e.view),1),e.view.parent=null,u.unchain(e,["trackeventmousedown","trackeventmouseover","trackeventmouseout","trackeventmoved"]),e.view.unlisten("trackeventdragstopped",d)},this.addTrackEventGhost=function(e){e.track=o,f.appendChild(e.element)},this.removeTrackEventGhost=function(e){e.track=null,f.removeChild(e.element)},this.findOverlappingTrackEvent=function(e,t,n){var i,s=e.element.getBoundingClientRect(),o,u,f,l;u=t||s.left,l=n||s.width,f=u+l;if(l===0)return null;for(var c=0,h=a.length;c<h;c++){i=a[c];if(!i.dragging&&e!==i){o=i.element.getBoundingClientRect();if(!i.isGhost&&!(u>=o.right-r||f<=o.left+r))return i.trackEvent}}return null}}}),n("core/track",["./eventmanager","./trackevent","./views/track-view"],function(e,t,n){var r=0,i="Layer ",s;return s=function(s){function d(e){var t=e.origin,n=e.data,r=t.popcornOptions,i=n.start||n.start===0?n.start:r.start,s=n.end||n.end===0?n.end:r.end,o,u;t.track.findOverlappingTrackEvent(i,s,t)&&(e.cancel("trackevent-overlap"),c.removeTrackEvent(t),u=c._media.getNextTrack(c),o=u?c._media.forceEmptyTrackSpaceAtTime(u,i,s):c._media.addTrack(),t.update(n),o.addTrackEvent(t))}s=s||{};var o=[],u=s.target,a=""+r++,f=new n(a,this),l=null,c=this,h=0,p=i+h;c._media=null,c.ghost=null,e.extend(c),this.setPopcornWrapper=function(e){l=e;for(var t=0,n=o.length;t<n;++t)o[t].bind(c,e)},this.updateTrackEvents=function(){var e=o.slice();for(var t=0,n=e.length;t<n;t++)e[t].update()},Object.defineProperties(this,{view:{enumerable:!0,configurable:!1,get:function(){return f}},target:{enumerable:!0,get:function(){return u},set:function(e){u=e,c.dispatch("tracktargetchanged",c);for(var t=0,n=o.length;t<n;t++)o[t].target=e,o[t].update({target:e})}},name:{enumerable:!0,get:function(){return p},set:function(e){p=e,c.dispatch("tracknamechanged",c)}},id:{enumerable:!0,get:function(){return a}},json:{enumerable:!0,get:function(){var e=[];for(var t=0,n=o.length;t<n;++t)e.push(o[t].json);return{name:p,id:a,trackEvents:e}},set:function(e){e.name&&(p=e.name);if(e.trackEvents){var t=e.trackEvents;if(Array.isArray(t))for(var n=0,r=t.length;n<r;++n)c.addTrackEvent(t[n]);else console&&console.warn("Ignored imported track event data. Must be in an Array.")}}},trackEvents:{enumerable:!0,configurable:!1,get:function(){return o}},order:{enumerable:!0,get:function(){return h},set:function(e){h=e,p=i+e}}}),this.getTrackEventById=function(e){for(var t=0,n=o.length;t<n;++t)if(o[t].id===e)return o[t]},this.getTrackEventByName=function(e){for(var t=0,n=o.length;t<n;++t)if(o[t].name===e)return o[t]},this.addTrackEvent=function(e){var n=!1;e instanceof t?e.selected&&(n=!0,e.selected=!1):e=new t(e);if(e.track)throw"TrackEvent still bound to track. Please use `track.removeTrackEvent` first.";return e.bind(c,l),u&&(e.target=u),o.push(e),c.chain(e,["trackeventupdated","trackeventselected","trackeventdeselected"]),f.addTrackEvent(e),e.selected=n,e.subscribe("update",d),c.dispatch("trackeventadded",e),c._media&&e.update(e.popcornOptions,!0),e},this.removeTrackEvent=function(e,t){var n=o.indexOf(e);if(n>-1)return o.splice(n,1),c.unchain(e,["trackeventupdated","trackeventselected","trackeventdeselected"]),e.unsubscribe("update",d),f.removeTrackEvent(e),e.unbind(t),c.dispatch("trackeventremoved",e),e},this.findOverlappingTrackEvent=function(e,n,r){var i,s;e instanceof t&&(arguments.length===2&&(r=n),i=e,e=i.popcornOptions.start,n=i.popcornOptions.end);for(var u=0,a=o.length;u<a;u++){i=o[u],s=i.popcornOptions;if(i!==r&&!i.view.isGhost&&!(e>=s.end||n<=s.start))return i}return null},this.deselectEvents=function(e){var t;for(var n=0,r=o.length;n<r;++n)t=o[n],t!==e&&t.selected&&(t.selected=!1)}},s}),n("ui/page-element",["core/logger","util/dragndrop"],function(e,t){var n=1500,r=200;return function(e,i){function c(e){e?s.classList.add("butter-highlight-on"):s.classList.remove("butter-highlight-on")}function h(){f=!1,s.classList.remove("butter-highlight-fade"),a||c(!1)}var s=typeof e=="string"?document.getElementById(e):e,o=i||{},u,a=!1,f=!1,l=this;this.highlight=function(e){c(e),a=e,f=!1,s.classList.remove("butter-highlight-fade")},this.destroy=function(){u&&u.destroy()},this.blink=function(){!a&&!f&&(f=!0,setTimeout(function(){f&&s.classList.add("butter-highlight-fade")},r),c(!0),setTimeout(h,n))},s&&(s.setAttribute("butter-clean","true"),u=t.droppable(s,{over:function(e){if(e.getAttribute("data-butter-draggable-type")!=="plugin")return;l.highlight(!0),o.over&&o.over()},out:function(e){if(e.getAttribute("data-butter-draggable-type")!=="plugin")return;l.highlight(!1),o.out&&o.out()},drop:function(e,t,n){if(!e.getAttribute||e.getAttribute("data-butter-draggable-type")!=="plugin")return;l.highlight(!1),o.drop&&o.drop(e,t,n)}})),this.element=s}}),function(){n("core/target",["core/logger","core/eventmanager","ui/page-element"],function(e,t,n){var r=0,i=function(i){i=i||{};var s="Target"+r++,o=new e(s),u=i.name||s,a,f,l=this;t.extend(l),a=document.getElementById(i.element),a?f=new n(a,{drop:function(e,t,n){l.dispatch("trackeventrequested",{element:e,target:l,position:t,popcornOptions:n})}}):o.log("Warning: Target element is null."),this.destroy=function(){f&&f.destroy()},Object.defineProperties(this,{view:{enumerable:!0,get:function(){return f}},name:{enumerable:!0,get:function(){return u}},id:{enumerable:!0,get:function(){return s}},elementID:{enumerable:!0,get:function(){if(a)return a.id}},element:{enumerable:!0,get:function(){return a}},isDefault:{enumerable:!0,get:function(){return a&&a.hasAttribute("data-butter-default")?!0:!1}},json:{enumerable:!0,get:function(){var e="";return a&&a.id&&(e=a.id),{id:s,name:u,element:e}},set:function(e){e.name&&(u=e.name),e.element&&(a=document.getElementById(e.element))}}})};return i})}(),n("util/uri",[],function(){function e(t){var n=e.options,r=n.parser[n.strictMode?"strict":"loose"].exec(t),i={},s=14;while(s--)i[n.key[s]]=r[s]||"";return i[n.q.name]={},i[n.key[12]].replace(n.q.parser,function(e,t,r){t&&(i[n.q.name][t]=r)}),i}function r(e){var t="";return t+=e.protocol?e.protocol+"://":"",t+=e.authority||"",t+=e.path||"",t+=e.query?"?"+e.query:"",t+=e.anchor?"#"+e.anchor:"",t}function i(e){var t=e.queryKey,n="",r=0,i,s;for(i in t)t.hasOwnProperty(i)&&(s=t[i],n+=r>0?"&":"",n+=i,n+=!s&&s!==0?"":"="+s,r++);return e.query=n,e}e.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var t="butteruid",n=Date.now(),s={set seed(e){n=e|0},get seed(){return n},parse:function(t){var n=e(t);return n.toString=function(){return r(this)},n},makeUnique:function(e){typeof e=="string"&&(e=this.parse(e));var r=e.queryKey;return r[t]=n++,i(e)},stripUnique:function(e){typeof e=="string"&&(e=this.parse(e));var n=e.queryKey;return n&&delete n[t],i(e)}};return s}),n("core/popcorn-wrapper",["core/logger","core/eventmanager","util/uri"],function(e,t,n){var r=/(?:http:\/\/www\.|http:\/\/|www\.|\.|^)(youtu|vimeo|soundcloud|baseplayer)/,i=100,s=1e4,o=1e4;return function(t,u){function E(){for(var e in l)l.hasOwnProperty(e)&&v.on(e,l[e])}function S(e){var t=r.exec(e),n="object";return t&&(n=t[1],n==="youtu"&&(n="youtube")),n}function x(e){return g=S(e),g}function T(e){var t=document.getElementById(e);if(g!=="object"&&t&&["VIDEO","AUDIO"].indexOf(t.nodeName)!==-1){var n=t.parentNode,r=document.createElement("div"),i=["controls","preload","autoplay","loop","muted","poster","src"],s;r.id=t.id,s=t.attributes;if(s)for(var o=s.length-1;o>=0;o--){var u=s[o].nodeName;i.indexOf(u)===-1&&r.setAttribute(u,t.getAttribute(u))}t.className&&(r.className=t.className),n.replaceChild(r,t),r.setAttribute("data-butter","media")}}function C(e){var t=new Function("",e),n=t();if(!n){var r=document.createElement("script");r.innerHTML=e,document.head.appendChild(r),n=window.Popcorn.instances[window.Popcorn.instances.length-1]}v=n}function k(e,t,n){function s(){if(y)return;r=e(),r?t():setTimeout(s,i)}var r=!1;setTimeout(function(){r||n()},o),s()}function L(e,t){k(function(){return m=v&&v.media.readyState>=1&&v.duration()>0,m},e,t,o)}function A(e,t,n){n!=="object"?(p(n),k(function(){return!!window.Popcorn[n]},e,t,s)):e()}function O(){if(O.instance)return O.instance;var e=document.createElement("div");return e.style.width="0px",e.style.height="0px",e.style.overflow="hidden",e.style.visibility="hidden",document.body.appendChild(e),O.instance=e,e}var a=t,f=new e(a+"::PopcornWrapper"),l=u.popcornEvents||{},c=u.prepare||function(){},h=u.fail||function(){},p=u.playerTypeRequired||function(){},d=u.timeout||function(){},v,m=!1,g,y=!1,b=this,w=u.makeVideoURLsUnique;this.unbind=function(){if(v)try{v.destroy(),v=undefined}catch(e){f.log("WARNING: Popcorn did NOT get destroyed properly: \n"+e.message+"\n"+e.stack)}},this.interruptLoad=function(){y=!0},this.synchronizeEvent=function(e,t){function s(){v.getTrackEvent(r)?v[e.type](r,t):v[e.type](r,n),i=v.getTrackEvent(r),e.popcornTrackEvent=i,e.popcornOptions.start=+i.start,e.popcornOptions.end=+i.end,e.view&&(i.toString?(e.view.setToolTip(i.toString()),e.type==="sequencer"&&(e.popcornOptions.hidden?(e.view.element.classList.add("sequencer-audio"),e.view.element.classList.remove("sequencer-video")):(e.view.element.classList.add("sequencer-video"),e.view.element.classList.remove("sequencer-audio")))):e.view.setToolTip(JSON.stringify(n))),e.view.update(e.popcornOptions),e.popcornTrackEvent&&(e.view.elementText=e.popcornTrackEvent.toString(),e.dispatch("trackeventupdated",e))}var n=e.popcornOptions,r=e.id,i=null;v&&v[e.type]&&(e.type==="sequencer"?A(s,function(){throw"Your media seems to be taking a long time to load. Review your media URL(s) or continue waiting."},S(e.popcornOptions.source)):s())},this.destroyEvent=function(e){var t=e.id;v&&t&&v.getTrackEvent(t)&&v.removeTrackEvent(t)},this.prepare=function(e,t,n,r,i){function o(e){y=!0,d(e)}function u(e){d(e)}function a(e){y=!0,f.log(e),h(e)}var s;m=!1;var l=e;if(typeof e!="string"){if(!e.length)throw"URL is invalid: empty array or not a string.";l=e[0]}else e.indexOf("#t")!==0&&e.indexOf(",")>-1&&(s=e.split(","),l=s[0],e=s);x(l);if(!t){f.log("Warning: tried to prepare media with null target.");return}if(!v)try{A(function(){T(t),C(N(n,e,t,null,r,i)),E(),L(c,u)},o,g)}catch(p){a(p)}};var N=this.generatePopcornString=function(e,t,r,i,s,o,u){s=s||{},o=o||{};var a="",l,c,h,p;t=typeof t=="string"?[t]:t;if(w)for(h=0;h<t.length;h++)t[h]=n.makeUnique(t[h]).toString();t=JSON.stringify(t),e?e=", "+JSON.stringify(e):e=", {}",typeof r!="string"&&(r&&r.id?r=r.id:f.log("WARNING: Unexpected non-string Popcorn target: "+r));if(!g)throw new Error("Media type not generated yet. Please specify a url for media objects before generating a popcorn string.");o.init&&(a+=o.init+"\n"),s.init&&(a+=s.init+"();\n"),g==="baseplayer"?a+="Popcorn.player( 'baseplayer' );\nvar popcorn = Popcorn.baseplayer( '#"+r+"' "+e+" );\n":a+="var popcorn = Popcorn.smart( '#"+r+"', "+t+e+" );\n",o.beforeEvents&&(a+=o.beforeEvents+"\n"),s.beforeEvents&&(a+=s.beforeEvents+"( popcorn );\n");if(v&&u)for(h=u.length-1;h>=0;h--){e=u[h].popcornOptions,c={};for(p in e)e.hasOwnProperty(p)&&e[p]!==undefined&&(c[p]=e[p]);try{l=JSON.stringify(c,null,4)}catch(d){l=!1,f.log("WARNING: Unable to export event options: \n"+d.message)}l&&(a+="popcorn."+u[h].type+"("+l+");\n")}return o.afterEvents&&(a+=o.afterEvents+"\n"),s.afterEvents&&(a+=s.afterEvents+"( popcorn );\n"),a+="popcorn.controls( false );\n",i=i||"inline",i==="event"?(a="\ndocument.addEventListener('DOMContentLoaded',function(e){\n"+a,a+="\n},false);"):a+="\nreturn popcorn;",a};this.play=function(){m&&v.paused()&&v.play()},this.pause=function(){m&&!v.paused()&&v.pause()},this.clear=function(e){function t(e){return!!e.media&&!!e.media._util&&e.media._util.type==="SoundCloud"}typeof e=="string"&&(e=document.getElementById(e));if(!e){f.log("Warning: tried to clear media with null target.");return}if(v){if(t(v)){var n=v.media.parentNode,r=n.querySelector("iframe");r&&O().appendChild(r)}b.unbind()}while(e.firstChild)e.removeChild(e.firstChild);["AUDIO","VIDEO"].indexOf(e.nodeName)>-1&&(e.currentSrc="",e.src="",e.removeAttribute("src"))},Object.defineProperties(this,{volume:{enumerable:!0,set:function(e){v&&v.volume(e)},get:function(){return v?v.volume():!1}},muted:{enumerable:!0,set:function(e){v&&(e?v.mute():v.unmute())},get:function(){return v?v.muted():!1}},currentTime:{enumerable:!0,set:function(e){m&&v&&v.currentTime(e)},get:function(){return v?v.currentTime():0}},duration:{enumerable:!0,get:function(){return v?v.duration():0}},popcorn:{enumerable:!0,get:function(){return v}},paused:{enumerable:!0,get:function(){return v?v.paused():!0},set:function(e){v&&(e?b.pause():b.play())}}})}}),function(){n("core/media",["core/logger","core/eventmanager","core/track","core/popcorn-wrapper","util/uri"],function(e,t,n,r,i){var s=500,o=10,u=0,a=function(a){function T(e){return e instanceof n||(e=new n(e)),e}function N(e){e._media=S,f.push(e),S.chain(e,["tracktargetchanged","trackeventadded","trackeventremoved","trackeventupdated","trackeventselected","trackeventdeselected"]),e.setPopcornWrapper(x)}function C(e){var t=e.trackEvents;if(t.length>0)for(var n=0,r=t.length;n<r;++n)e.dispatch("trackeventadded",t[n])}function k(){d&&d.indexOf("#t")!==0&&d.indexOf(",")>-1&&(d=d.split(",")),d&&m&&x.prepare(d,m,w,S.popcornCallbacks,S.popcornScripts)}function L(e,t){return e.order-t.order}function A(){function t(e){return i.stripUnique(e).toString()}var e;return Array.isArray(d)?(e=[],d.forEach(function(n){e.push(t(n))}),e):t(d)}function O(e){var t="";if(e.children){var n=e.children;t=[];for(var r=0,i=n.length;r<i;r++)n[r].nodeName==="SOURCE"&&t.push(n[r].src)}return t.length?t:e.currentSrc}a=a||{},t.extend(this);var f=[],l=[],c="Media"+u++,h=new e(c),p=a.name||c,d=a.url,v=!1,m=a.target,g,y=0,b=-1,w=a.popcornOptions,E,S=this,x=new r(c,{popcornEvents:{muted:function(){S.dispatch("mediamuted",S)},unmuted:function(){S.dispatch("mediaunmuted",S)},volumechange:function(){S.dispatch("mediavolumechange",x.volume)},timeupdate:function(){y=x.currentTime,S.dispatch("mediatimeupdate",S)},pause:function(){clearInterval(E),S.dispatch("mediapause")},play:function(){E=setInterval(function(){y=x.currentTime},10),S.dispatch("mediaplay")},ended:function(){S.dispatch("mediaended")},seeked:function(){S.dispatch("mediaseeked")}},prepare:function(){S.duration=x.duration,v=!0;for(var e=0,t=f.length;e<t;e++)f[e].updateTrackEvents();var n=document.getElementById(m);n&&n.getAttribute("data-butter-media-controls")&&x.popcorn.controls(!0),S.dispatch("mediaready")},timeout:function(){S.dispatch("mediatimeout")},fail:function(){S.dispatch("mediafailed","error")},playerTypeRequired:function(e){S.dispatch("mediaplayertyperequired",e)},setup:{target:m,url:d},makeVideoURLsUnique:a.makeVideoURLsUnique});this.popcornCallbacks=null,this.popcornScripts=null,this.maxPluginZIndex=0,this.destroy=function(){x.unbind()},this.clear=function(){for(var e=f.length-1;e>=0;e--)S.removeTrack(f[e])},this.addTrack=function(e){e=T(e);if(e._media)throw"Track already belongs to a Media object. Use `media.removeTrack` prior to this function.";return e.order=f.length,N(e),l.push(e),S.dispatch("trackadded",e),S.dispatch("trackorderchanged",l),C(e),e},this.insertTrackBefore=function(e,t){t=T(t);if(t._media)throw"Track already belongs to a Media object. Use `media.removeTrack` prior to this function.";var n=l.indexOf(e);if(n>-1)return t.order=n,l.splice(n,0,t),N(t),S.dispatch("trackadded",t),S.sortTracks(n+1),C(t),t;throw"inserTrackBefore must be passed a valid relative track."},this.getTrackById=function(e){for(var t=0,n=f.length;t<n;++t)if(f[t].id===e)return f[t]},this.removeTrack=function(e){var t=f.indexOf(e),n,r;if(t>-1){f.splice(t,1),r=l.indexOf(e);var i=e.trackEvents;for(var s=0,o=i.length;s<o;++s)n=i[s],n.selected=!1,n.unbind(),e.dispatch("trackeventremoved",n);return S.unchain(e,["tracktargetchanged","trackeventadded","trackeventremoved","trackeventupdated","trackeventselected","trackeventdeselected"]),e.setPopcornWrapper(null),e._media=null,l.splice(r,1),S.dispatch("trackremoved",e),S.sortTracks(r),e}},this.cleanUpEmptyTracks=function(){var e=f.slice();for(var t=e.length-1;t>=0;--t)e[t].trackEvents.length===0&&f.length>1&&S.removeTrack(e[t])},this.findTrackWithTrackEventId=function(e){for(var t=0,n=f.length;t<n;++t){var r=f[t].getTrackEventById(e);if(r)return{track:f[t],trackEvent:r}}},this.getManifest=function(e){return g[e]},this.setupContent=k,this.onReady=function(e){function t(n){e(n),S.unlisten("mediaready",t)}v?e():S.listen("mediaready",t)},this.pause=function(){x.pause()},this.play=function(){x.play()},this.generatePopcornString=function(e,t){var n=w||{};e=e||S.popcornCallbacks,t=t||S.popcornScripts;var r=[];for(var i=0,s=f.length;i<s;++i)r=r.concat(f[i].trackEvents);return x.generatePopcornString(n,d,m,null,e,t,r)},this.sortTracks=function(e,t){var n=e||0,r=t||l.length;for(;n<=r;++n)l[n]&&(l[n].order=n,l[n].updateTrackEvents());l.sort(L),S.dispatch("trackorderchanged",l)},this.getNextTrack=function(e){var t=l.indexOf(e);return t>-1&&t<l.length-1?l[t+1]:null},this.getLastTrack=function(e){var t=l.indexOf(e);return t>0?l[t-1]:null},this.findNextAvailableTrackFromTimes=function(e,t){for(var n=0,r=l.length;n<r;++n)if(!l[n].findOverlappingTrackEvent(e,t))return l[n];return null},this.forceEmptyTrackSpaceAtTime=function(e,t,n,r){var i;return e.findOverlappingTrackEvent(t,n,r)?(i=S.getNextTrack(e),i?i.findOverlappingTrackEvent(t,n,r)?S.insertTrackBefore(i):i:this.addTrack()):e},this.fixTrackEventBounds=function(){var e,t,n,r,i,s,o,u,a,f;n=l.slice();for(e=0,r=n.length;e<r;e++){i=n[e].trackEvents.slice();for(t=0,s=i.length;t<s;t++)o=i[t],u=o.popcornOptions,a=u.start,f=u.end,f>b&&(a>b?o.track.removeTrackEvent(o):o.update({end:b}))}},this.hasTrackEvents=function(){for(var e=0,t=f.length;e<t;++e)if(f[e].trackEvents.length)return!0},Object.defineProperties(this,{ended:{enumerable:!0,get:function(){return x.popcorn?x.popcorn.ended():!1}},url:{enumerable:!0,get:function(){return d},set:function(e){d!==e&&(d=e,v=!1,x.clear(m),k(),S.dispatch("mediacontentchanged",S))}},target:{get:function(){return m},set:function(e){m!==e&&(x.clear(m),m=e,k(),S.dispatch("mediatargetchanged",S))},enumerable:!0},muted:{enumerable:!0,get:function(){return x.muted},set:function(e){x.muted=e}},ready:{enumerable:!0,get:function(){return v}},name:{get:function(){return p},enumerable:!0},id:{get:function(){return c},enumerable:!0},tracks:{get:function(){return f},enumerable:!0},orderedTracks:{get:function(){return l},enumerable:!0},currentTime:{get:function(){return y},set:function(e){e!==undefined&&(y=e,y<0&&(y=0),y>b&&(y=b),x.currentTime=y,S.dispatch("mediatimeupdate",S))},enumerable:!0},duration:{get:function(){return b},set:function(e){e&&(b=+e,h.log("duration changed to "+b),S.fixTrackEventBounds(),S.dispatch("mediadurationchanged",S))},enumerable:!0},json:{get:function(){var e=[];for(var t=0,n=l.length;t<n;++t)e.push(l[t].json);return{id:c,name:p,url:A(),target:m,duration:b,popcornOptions:w,controls:x.popcorn?x.popcorn.controls():!1,tracks:e}},set:function(e){var t,r,s,o,u=[],a=[];e.name&&(p=e.name),e.target&&(S.target=e.target),e.duration>=0&&(b=e.duration,S.url="#t=,"+b);if(e.tracks){var f=e.tracks;if(Array.isArray(f)){for(s=0,o=f.length;s<o;++s)t=new n,t.json=f[s],S.addTrack(t),t.updateTrackEvents();if(e.url&&b>=0){r=e.url,Array.isArray(r)||(r=[r]);if(r.length>1||!/#t=\d*,?\d+?/.test(r[0])){a.push(i.makeUnique(r.shift()).toString());for(s=0;s<r.length;s++)u.push(i.makeUnique(r[s]).toString());t=new n,S.addTrack(t),t.addTrackEvent({type:"sequencer",popcornOptions:{start:0,end:b,source:a,title:i.stripUnique(a[0]).path,fallback:u,duration:b,target:"video-container"}})}}}else console&&console.warn("Ignoring imported track data. Must be in an Array.")}},enumerable:!0},registry:{get:function(){return g},set:function(e){g=e},enumerable:!0},popcorn:{enumerable:!0,get:function(){return x}},paused:{enumerable:!0,get:function(){return x.paused},set:function(e){x.paused=e}},volume:{enumerable:!0,get:function(){return x.volume},set:function(e){x.volume=e}},popcornOptions:{enumerable:!0,get:function(){return w},set:function(e){w=e,S.dispatch("mediapopcornsettingschanged",S),k()}}});var M=document.getElementById(m),_=d,D=0,P;M&&["VIDEO","AUDIO"].indexOf(M.nodeName)>-1&&(_=_||O(M),_?d=_:P=setInterval(function(){_=O(M),_?(d=_,k(),clearInterval(P)):D++===o&&clearInterval(P)},s))};return a})}(),n("core/page",["core/logger","core/eventmanager"],function(e,t){return function(e){var n="{popcorn-js}/players/{type}/popcorn.{type}.js";t.extend(this),this.scrape=function(){var e=document.body,t=e.querySelectorAll("*[data-butter='target']"),n=e.querySelectorAll("*[data-butter='media']");return{media:n,target:t}},this.prepare=function(t){e.load([{type:"js",url:"{popcorn-js}/popcorn.js",check:function(){return!!window.Popcorn}},{type:"js",url:"{popcorn-js}/modules/player/popcorn.player.js",check:function(){return!!window.Popcorn&&!!window.Popcorn.player}},{type:"js",url:"{popcorn-js}/wrappers/common/popcorn._MediaElementProto.js",check:function(){return!!window.Popcorn&&!!window.Popcorn._MediaElementProto}},{type:"js",url:"{popcorn-js}/wrappers/html5/popcorn.HTMLMediaElement.js",check:function(){return!!window.Popcorn&&!!window.Popcorn.HTMLVideoElement&&!!window.Popcorn.HTMLAudioElement}},{type:"js",url:"{popcorn-js}/wrappers/youtube/popcorn.HTMLYouTubeVideoElement.js",check:function(){return!!window.Popcorn&&!!window.Popcorn.HTMLVimeoVideoElement}},{type:"js",url:"{popcorn-js}/wrappers/vimeo/popcorn.HTMLVimeoVideoElement.js",check:function(){return!!window.Popcorn&&!!window.Popcorn.HTMLVimeoVideoElement}},{type:"js",url:"{popcorn-js}/wrappers/soundcloud/popcorn.HTMLSoundCloudAudioElement.js",check:function(){return!!window.Popcorn&&!!window.Popcorn.HTMLSoundCloudAudioElement}},{type:"js",url:"{popcorn-js}/wrappers/null/popcorn.HTMLNullVideoElement.js",check:function(){return!!window.Popcorn&&!!window.Popcorn.HTMLNullVideoElement}}],t,null,!0)},this.addPlayerType=function(t,r){e.load({type:"js",url:n.replace(/\{type\}/g,t),check:function(){return!!Popcorn[t]}},r)}}}),function(){function e(e){var t=[];if(!e)return null;for(var n in e)e.hasOwnProperty(n)&&(t[t.length]=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&").replace("/%20/g","+")}var t="",r;n("util/xhr",[],function(){function n(e){return function(){if(this.readyState!==4)return;if(!t)try{t=JSON.parse(this.response||this.responseText).csrf,t&&r&&r()}catch(n){}e&&e.apply(this,arguments)}}var i={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4,getUntilComplete:function(e,t,n,r){i.get(e,function(e){this.readyState===i.DONE&&t.call(this,e)},n,r)},get:function(e,t,r,i){var s=new XMLHttpRequest;s.open("GET",e,!0),s.onreadystatechange=n(t);if(i)for(var o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o,i[o]);s.overrideMimeType&&r&&s.overrideMimeType(r),s.send(null)},post:function(r,i,s,o){var u=new XMLHttpRequest;u.open("POST",r,!0),u.onreadystatechange=n(s),t&&u.setRequestHeader("x-csrf-token",t),o?(u.setRequestHeader("Content-Type",o),u.send(i)):(u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.send(e(i)))},setCSRFTokenAcquiredCallback:function(e){r=e}};return i})}(),n("util/scrollbars",["core/eventmanager"],function(e){function i(i,s){function v(){window.removeEventListener("mouseup",v,!1),window.removeEventListener("mousemove",m,!1),u.addEventListener("mousedown",g,!1),u.classList.remove(n)}function m(e){var t=e.pageY-p,n=a-h;t=Math.max(0,Math.min(t,n));var r=t/n;i.scrollTop=(c-f)*r,d.dispatch("scroll",i.scrollTop)}function g(e){if(e.button===0){var t=u.offsetTop;p=e.pageY-t,window.addEventListener("mouseup",v,!1),window.addEventListener("mousemove",m,!1),u.removeEventListener("mousedown",g,!1),u.classList.add(n)}}function y(){s.scrollHeight-a>0?u.style.top=(a-h)*(i.scrollTop/(c-f))+"px":u.style.top="0px"}var o=document.createElement("div"),u=document.createElement("div"),a,f,l,c,h,p=0,d=this;e.extend(d),o.className="butter-scroll-bar butter-scroll-bar-v",u.className="butter-scroll-handle",o.appendChild(u),this.update=function(){f=i.getBoundingClientRect().height,l=s.getBoundingClientRect().height,a=o.getBoundingClientRect().height,c=i.scrollHeight,h=a-(s.scrollHeight-f)/t,h=Math.max(20,Math.min(a,h)),u.style.height=h+"px",y()},i.addEventListener("scroll",function(){y()},!1),i.addEventListener("mousewheel",function(e){var t=e.wheelDeltaY||e.wheelDelta;i.scrollTop-=t/r,y(),e.preventDefault()},!1),i.addEventListener("DOMMouseScroll",function(e){e.axis===e.VERTICAL_AXIS&&!e.shiftKey&&(i.scrollTop+=e.detail*2,y(),e.preventDefault())},!1),o.addEventListener("click",function(e){if(e.srcElement===u||e.button>0)return;var t=e.pageY,n=u.getBoundingClientRect(),r=o.getBoundingClientRect(),s;t>n.bottom?u.style.top=t-r.top-h+"px":t<n.top&&(u.style.top=t-r.top+"px"),s=u.offsetTop/(a-h),i.scrollTop=(c-a)*s},!1),u.addEventListener("mousedown",g,!1),d.update(),Object.defineProperties(this,{element:{enumerable:!0,get:function(){return o}}})}function s(t,n){function h(){window.removeEventListener("mouseup",h,!1),window.removeEventListener("mousemove",p,!1),i.addEventListener("mousedown",d,!1)}function p(e){e.preventDefault();var n=e.pageX-l;n=Math.max(0,Math.min(n,s-f)),i.style.left=n+"px";var r=i.offsetLeft/(s-f);t.scrollLeft=(a-s)*r,c.dispatch("scroll",t.scrollLeft)}function d(e){if(e.button===0){var t=i.offsetLeft;l=e.pageX-t,window.addEventListener("mouseup",h,!1),window.addEventListener("mousemove",p,!1),i.removeEventListener("mousedown",d,!1)}}function v(){a-s>0?i.style.left=(s-f)*(t.scrollLeft/(a-s))+"px":i.style.left="0px"}var r=document.createElement("div"),i=document.createElement("div"),s,o,u,a,f,l=0,c=this;e.extend(c),r.className="butter-scroll-bar butter-scroll-bar-h",i.className="butter-scroll-handle",r.appendChild(i),this.update=function(){o=t.getBoundingClientRect().width,u=n.getBoundingClientRect().width,s=r.getBoundingClientRect().width,a=n.scrollWidth,f=s-(a-o),f=Math.max(20,Math.min(s,f)),i.style.width=f+"px",v()},t.addEventListener("scroll",function(){v()},!1),t.addEventListener("mousewheel",function(e){e.wheelDeltaX&&(t.scrollLeft-=e.wheelDeltaX,v(),e.preventDefault())},!1),t.addEventListener("DOMMouseScroll",function(e){if(e.axis===e.HORIZONTAL_AXIS||e.axis===e.VERTICAL_AXIS&&e.shiftKey)t.scrollLeft+=e.detail*2,v(),e.preventDefault()},!1),r.addEventListener("click",function(e){if(e.srcElement===i||e.button>0)return;var n=e.pageX,o=i.getBoundingClientRect(),u=r.getBoundingClientRect(),l;n>o.right?i.style.left=n-u.left-f+"px":n<o.left&&(i.style.left=n-u.left+"px"),l=i.offsetLeft/(s-f),t.scrollLeft=(a-s)*l},!1),i.addEventListener("mousedown",d,!1),c.update(),Object.defineProperties(this,{element:{enumerable:!0,get:function(){return r}}})}var t=3,n="butter-scollbar-active",r=10;return{Vertical:i,Horizontal:s}}),n("ui/widget/tooltip",[],function(){function o(e){r[e.name]=e}function u(e){return!!r[e]}var e="butter-tooltip",t="tooltip-on",n="tooltip-no-hover",r={},i,s;return i=function(i){if(i&&i.name&&u(i.name))return;var s,a,f,l,c,h,p=!1,d=document.createElement("div");return d.classList.add(e),d.classList.add(i.name),Object.defineProperty(this,"message",{get:function(){return f},set:function(e){e&&typeof e=="string"&&(f=e,d.innerHTML=e)},enumerable:!0}),Object.defineProperty(this,"hidden",{get:function(){return!d.classList.contains(t)},set:function(e){e||e===undefined?d.classList.remove(t):d.classList.add(t)},enumerable:!0}),Object.defineProperty(this,"hover",{get:function(){return!d.classList.contains(n)},set:function(e){e||e===undefined?d.classList.remove(n):d.classList.add(n)},enumerable:!0}),Object.defineProperty(this,"top",{get:function(){return l},set:function(e){s&&e&&typeof e=="string"&&(l=e,d.style.top=e)},enumerable:!0}),Object.defineProperty(this,"left",{get:function(){return c},set:function(e){s&&e&&typeof e=="string"&&(c=e,d.style.left=e)},enumerable:!0}),Object.defineProperty(this,"tooltipElement",{get:function(){return d},enumerable:!0}),Object.defineProperty(this,"parent",{get:function(){return s},set:function(e){e&&(["absolute","relative","fixed"].indexOf(getComputedStyle(e).getPropertyValue("position"))===-1&&(e.style.position="relative"),s=e,s.appendChild(d))},enumerable:!0}),Object.defineProperty(this,"name",{get:function(){return a},enumerable:!0}),Object.defineProperty(this,"error",{get:function(){return h},set:function(e){h=!!e,h?d.classList.add("tooltip-error"):d.classList.remove("tooltip-error")},enumerable:!0}),Object.defineProperty(this,"destroyed",{get:function(){return p},enumerable:!0}),this.destroy=function(){p||(s&&d.parentNode===s&&s.removeChild(d),r[a]=undefined,p=!0)},this.parent=i.element,this.top=i.top||s.getBoundingClientRect().height+"px",this.left=i.left||"50%",this.message=i.message||s.getAttribute("data-tooltip")||s.getAttribute("title")||"",this.hidden=i.hidden,this.hover=i.hover,this.error=i.error,a=i.name,a&&o(this),this},s={create:function(e){var t=new i(e);return t.tooltipElement},apply:function(e){var t,n,r;e=e||document,t=e.querySelectorAll("[data-tooltip]");for(n=0,r=t.length;n<r;n++)s.create({element:t[n]})},get:function(e){return r[e]}},s}),n("ui/widget/textbox",[],function(){function e(t){var n=t.target;n.select(),n.removeEventListener("focus",e,!1)}function t(e){e.preventDefault();var n=e.target;n.removeEventListener("mouseup",t,!1)}function n(n){n.addEventListener("focus",e,!1),n.addEventListener("mouseup",t,!1)}return{applyTo:function(e,t){if(!e||e.type!=="text"&&e.type!=="textarea"&&e.type!=="url")throw"Textbox: Expected an input element of type text";return t=t||{},e.readOnly=!!t.readOnly,e.addEventListener("blur",function(e){n(e.target)},!1),n(e),e}}}),n("editor/base-editor",["core/eventmanager","util/scrollbars","ui/widget/tooltip","ui/widget/textbox"],function(e,t,n,r){function i(i,s,o,u){e.extend(i),i.butter=s,i.rootElement=o,i.parentElement=null;var a=[],f=[];i.open=function(e){i.parentElement=e,i.parentElement.appendChild(i.rootElement),i.scrollbar?i.scrollbar.update():i.rootElement.classList.contains("allow-scrollbar")&&i.addScrollbar(),u.open&&u.open.apply(i,arguments),i.addTooltips(),i.dispatch("open")},i.close=function(){i.rootElement.parentNode.removeChild(i.rootElement),u.close&&u.close.apply(i,arguments),i.dispatch("closed")},i.applyExtraHeadTags=function(e){var t=e.querySelectorAll("link"),n=e.querySelectorAll("style"),r;for(r=0;r<t.length;r++)f[r]=t[r],document.head.appendChild(f[r]);for(r=0;r<n.length;r++)a[r]=n[r],document.head.appendChild(a[r])},i.addScrollbar=function(e){var n=i.rootElement.querySelector(".scrollbar-inner");e=e||n&&{inner:n,outer:i.rootElement.querySelector(".scrollbar-outer")||n.parentNode,appendTo:i.rootElement.querySelector(".scrollbar-container")||i.rootElement};if(!e)return;return i.scrollbar=new t.Vertical(e.outer,e.inner),e.appendTo.appendChild(i.scrollbar.element),i.scrollbar.update(),i.scrollBar},i.addTooltips=function(){n.apply(i.rootElement)},i.createTooltip=function(e,t){var r;t&&t.name&&(n.create(t),r=n.get(t.name),e.addEventListener("focus",function(){r.hidden=!1},!1),e.addEventListener("blur",function(){r.hidden=!0},!1))},i.removeExtraHeadTags=function(){var e;for(e=0;e<f.length;e++)document.head.removeChild(f[e]);f=[];for(e=0;e<a.length;e++)document.head.removeChild(a[e]);a=[]},i.wrapTextInputElement=function(e,t){return r.applyTo(e,t)},window.addEventListener("resize",function(){i.scrollbar&&i.scrollbar.update()},!1)}return{extend:i}}),n("util/keys",[],function(){return{DELETE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,EQUALS:187,MINUS:189}}),n("text!layouts/trackevent-editor-defaults.html",[],function(){return'<!--  This Source Code Form is subject to the terms of the MIT license\n      If a copy of the MIT license was not distributed with this file, you can\n      obtain one at https://raw.github.com/mozilla/butter/master/LICENSE -->\n\n<div class="trackevent-warning">\n  <strong>Warning:</strong> <span class="trackevent-warning-message"></span>\n</div>\n\n<fieldset class="trackevent-property default input">\n  <label class="property-name"></label>\n  <input class="value" type="text" />\n</fieldset>\n\n<fieldset class="trackevent-property default input units">\n  <label class="property-name"></label>\n  <div class="butter-form-append">\n    <input class="value" type="text" />\n    <span class="butter-unit"></span>\n  </div>\n</fieldset>\n\n<fieldset class="trackevent-property default input checkbox">\n  <label class="butter-form-checkbox">\n    <input class="value" type="text" />\n    <span class="property-name"></span>\n  </label>\n</fieldset>\n\n<fieldset class="trackevent-property select">\n  <label class="property-name"></label>\n  <select>\n  </select>\n</fieldset>\n\n<fieldset class="trackevent-property targets">\n  <label class="property-name">Target</label>\n  <select data-manifest-key="target">\n    <option class="default-target-option" value="Media Element">Media Element</option>\n  </select>\n</fieldset>\n\n<fieldset class="trackevent-property textarea">\n  <label class="property-name"></label>\n  <textarea class="value"></textarea>\n</fieldset>\n\n<fieldset class="trackevent-property checkbox-group">\n  <div class="checkbox-group">\n    <label class="property-name"></label>\n    <input type="checkbox" class="value" />\n  </div>\n</fieldset>\n\n<fieldset class="butter-form-inline form-half start-end">\n  <div class="butter-form-append">\n    <label class="property-name">Start</label>\n    <input type="text" class="value" data-manifest-key="start">\n    <span class="butter-unit">seconds</span>\n  </div>\n  <div class="butter-form-append">\n    <label class="property-name">End</label>\n    <input type="text" class="value" data-manifest-key="end">\n    <span class="butter-unit">seconds</span>\n  </div>\n</fieldset>\n\n<!-- For createBreadcrumbs -->\n<div class="butter-breadcrumbs">\n  <a class="butter-breadcrumbs-back">Events</a>\n  <span class="butter-editor-title">Event</span>\n  <a class="close-btn"><span class="icon icon-only icon-x"></span></a>\n</div>\n'}),n("editor/trackevent-editor",["util/lang","util/keys","util/time","./base-editor","ui/widget/tooltip","text!layouts/trackevent-editor-defaults.html"],function(e,t,n,r,i,s){function l(e,i,s,l){function v(t,n,r){t.addEventListener("click",function(){var t={},i={},s,o=n.manifest.options[r].labels,u;for(s in o)o.hasOwnProperty(s)&&(u=e.rootElement.querySelector("[data-manifest-key='"+s+"']"),i[s]=u.checked);t[r]=i,n.update(t)},!1)}var c=l.open,h=o,p,d;l.open=function(t,n){var r=s.querySelector(".basic-tab"),i=s.querySelector(".advanced-tab"),o=s.querySelector(".editor-options"),u=s.querySelector(".advanced-options"),a=s.querySelector(".scrollbar-outer");!p&&s&&(p=s.querySelector("div.error-message")),d=n,c&&c.apply(this,arguments),r&&i&&(r.addEventListener("mouseup",function(){o.classList.contains("display-off")&&(o.classList.toggle("display-off"),u.classList.toggle("display-off"),r.classList.add("butter-active"),i.classList.remove("butter-active"),e.scrollbar.update())}),i.addEventListener("mouseup",function(){o.classList.contains("display-off")||(o.classList.toggle("display-off"),u.classList.toggle("display-off"),r.classList.remove("butter-active"),i.classList.add("butter-active"),e.scrollbar.update())}),e.addScrollbar({inner:a,outer:a,appendTo:s.querySelector(".scrollbar-container")})),e.scrollbar&&e.scrollbar.update(),e.showPluginPreview(n)},r.extend(e,i,s,l),e.defaultLayouts=u.cloneNode(!0),e.setErrorState=function(e){e&&p?(p.innerHTML=e,p.parentNode.style.height=p.offsetHeight+"px",p.parentNode.style.visibility="visible",p.parentNode.classList.add("open")):(p.innerHTML="",p.parentNode.style.height="",p.parentNode.style.visibility="",p.parentNode.classList.remove("open"))},e.setErrorMessageContainer=function(e){p=e},e.setTrackEventUpdateErrorCallback=function(e){h=e||o},e.updateTrackEventSafe=function(e,t){t.hasOwnProperty("start")&&t.start<0&&(t.start=0),t.hasOwnProperty("end")&&t.end>i.duration&&(t.end=i.duration);try{e.update(t)}catch(n){h(n.toString())}},e.createBreadcrumbs=function(t){var n=s.querySelector("h1"),r=e.defaultLayouts.querySelector(".butter-breadcrumbs"),i=r.querySelector(".butter-breadcrumbs-back"),o=r.querySelector(".butter-editor-title"),u=r.querySelector(".close-btn"),a=t.manifest.displayName||t.type;if(!t||!n)return;u.addEventListener("click",function(){e.dispatch("back")},!1),i.addEventListener("click",function(){e.dispatch("back")},!1),t.type&&(o.innerHTML="",o.appendChild(document.createTextNode(a))),n.parentNode.replaceChild(r,n)},e.createTargetsList=function(e){var t=u.querySelector(".trackevent-property.targets").cloneNode(!0),n=t.querySelector("select"),r=n.firstChild,i;for(var s=1;s<e.length;++s)i=document.createElement("option"),i.value=e[s].element.id,i.innerHTML=e[s].element.id,r?n.insertBefore(i,r):n.appendChild(i);return t},e.showPluginPreview=function(e){var t=e.popcornOptions.start,r=e.popcornOptions.end,s=i.currentTime,o=t*Math.pow(10,n.timeAccuracy-1);if(s<t||s>r)i.currentTime=t===0?t:Math.ceil(t*o)/o},e.attachSelectChangeHandler=function(t,n,r){t.addEventListener("change",function(){var i={};i[r]=t.value,n.update(i);var s=e.butter.getTargetByType("elementID",n.popcornOptions.target);s?s.view.blink():e.butter.currentMedia.view.blink()},!1)},e.attachColorChangeHandler=function(e,t,n,r){e.addEventListener("change",function(){var i=e.value,s,o={},u,a=!0;if(i.indexOf("#")===-1){for(u in f)if(f.hasOwnProperty(u)&&u===i.toLowerCase()){a=!1;break}if(a){s="Invalid Color update. Must start with a hex (#) or be one of the following: ";for(u in f)f.hasOwnProperty(u)&&(s+=u+", ");s=s.substring(0,s.lastIndexOf(","))+"."}}else i.match(/^#(?:[0-9a-fA-F]{3}){1,2}$/)||(s="Invalid Hex Color format. Must be a hash (#) followed by 3 or 6 digits/letters.");o[n]=i,r?r(t,o,s,n):t.update(o)},!1)},e.attachSecondsChangeHandler=function(e,t,r,i){e.addEventListener("blur",function(){var s={};s[r]=n.toSeconds(e.value),i(t,s)},!1),e.addEventListener("change",function(){var s={};s[r]=n.toSeconds(e.value),i(t,s)},!1)},e.attachCheckboxChangeHandler=function(e,t,n,r){r=r||function(e,t){e.update(t)},e.addEventListener("click",function(){var i={};i[n]=e.checked,r(t,i,n)},!1)},e.attachInputChangeHandler=function(n,r,i,s){function o(e,t,n){t?t(e,n):e.update(n)}function p(e){var t=r.popcornOptions;if(isNaN(e)||e==="")e=t[i];return e}var u,a,f,l,c,h;r.popcornTrackEvent&&(c=r.popcornTrackEvent._natives.manifest.options[i].type),h=c==="number"?!0:!1,n.addEventListener("blur",function(){var e=n.value;if(u)u=!1;else{var t={};h&&(e=p(e)),t[i]=e,o(r,s,t)}l&&(l.hidden=!0)},!1),n.addEventListener("keypress",function(e){var f={},l=n.value;e.keyCode===t.ENTER&&(e.shiftKey||(e.preventDefault(),h&&(l=p(l)),f[i]=l,o(r,s,f),u=!0,a=!0,n.blur()))},!1),(n.type==="number"||h)&&n.addEventListener("change",function(){var e={},t=n.value;a?a=!1:(u=!0,t=p(t),e[i]=t,o(r,s,e))},!1),n.type==="textarea"&&(f="shift-enter-tooltip-"+Date.now(),e.createTooltip(n,{name:f,element:n.parentElement,message:"Press Shift+Enter for a new line.",top:"105%",left:"50%",hidden:!0,hover:!1}))},e.createStartEndInputs=function(t,n){var r=u.querySelector(".start-end").cloneNode(!0),i=r.querySelector("input[data-manifest-key='start']"),s=r.querySelector("input[data-manifest-key='end']");return e.attachSecondsChangeHandler(i,t,"start",n),e.attachSecondsChangeHandler(s,t,"end",n),r},e.createManifestItem=function(e,t,n,r,i){var s=t.elem||"default",o=t.label||e,f=["start","end"].indexOf(e.toLowerCase())>-1,l=t.units||(f?"seconds":""),c,h,p,d,m,g,y;c=".trackevent-property."+s,l&&(c+=".units"),t.type==="checkbox"&&(c+=".checkbox"),t.type==="radio"&&(c+=".radio"),h=u.querySelector(c).cloneNode(!0);if(t.hidden)return;l&&(h.querySelector(".butter-unit").innerHTML=l),h.querySelector(".property-name")&&(h.querySelector(".property-name").innerHTML=o);if(t.elem==="select"){p=h.querySelector("select"),p.setAttribute("data-manifest-key",e);if(t.options)for(g=0,y=t.options.length;g<y;++g)d=document.createElement("option"),m=t.options[g],t.values&&t.values[g]?(d.innerHTML=m,d.value=t.values[g]):d.value=d.innerHTML=m,p.appendChild(d);else if(t.googleFonts&&a){var b,w,E;a=a.sort();for(w=0,E=a.length;w<E;w++)b=document.createElement("option"),b.value=b.innerHTML=a[w],p.appendChild(b)}}else if(t.elem==="textarea"){p=h.querySelector("textarea"),p.setAttribute("data-manifest-key",e);if(n){if(n===undefined||typeof n=="object")n="";p.value=n}}else if(t.elem==="checkbox-group"){var S,x=h,T,N;p=h.querySelector(".checkbox-group").cloneNode(!0),x.removeChild(x.querySelector("div"));for(S in t.labels)t.labels.hasOwnProperty(S)&&(T=p.querySelector(".value"),N=p.querySelector(".property-name"),v(T,r,e),N.innerHTML=t.labels[S],T.value=t.default[S],T.setAttribute("data-manifest-key",S),x.appendChild(p),p=h.querySelector(".checkbox-group").cloneNode(!0))}else{p=h.querySelector("input");if(n){if(n===undefined||typeof n=="object")n=t.type==="number"?0:"";p.placeholder=p.value=n}try{p.type=t.type}catch(C){}p.setAttribute("data-manifest-key",e)}return i&&i(t.elem,p,r,e),h},e.updatePropertiesFromManifest=function(t,r,i){var s,o=t.popcornOptions,u=t.manifest.options,a,f,l,c;r=r||Object.keys(u),i&&r.indexOf("target")===-1&&(r=r.concat("target"));for(l=0,c=r.length;l<c;++l){a=r[l],u[a]&&(f=u[a].units),s=e.rootElement.querySelector("[data-manifest-key='"+a+"']");if(s)s.type==="checkbox"?s.checked=o[a]:typeof o[a]!="undefined"?f==="seconds"?s.value=n.toTimecode(o[a]):s.value=o[a]:s.value=u[a].default||"";else if(u[a]&&u[a].elem==="checkbox-group"){var h,p=u[a].labels,d=o[a];for(h in p)p.hasOwnProperty(h)&&(s=e.rootElement.querySelector("[data-manifest-key='"+h+"']"),typeof o[a]!="undefined"?s.checked=d[h]:s.checked=u[a].default[h])}}},e.createPropertiesFromManifest=function(t){var n,r,i,s,o,u,a,f,l=t.trackEvent,c=t.ignoreManifestKeys||[],h,p;a=t.basicContainer||e.rootElement,f=t.advancedContainer||e.rootElement;if(!l.manifest)throw"Unable to create properties from null manifest. Perhaps trackevent is not initialized properly yet.";e.createBreadcrumbs(l),n=l.manifest.options,u=t.manifestKeys||Object.keys(n);for(h=0,p=u.length;h<p;++h){r=u[h],o=n[r].group?n[r].group:"basic",s=o==="advanced"?f:a;if(c&&c.indexOf(r)>-1)continue;i=e.createManifestItem(r,n[r],l.popcornOptions[r],l,t.callback),i&&s.appendChild(i)}},e.getTrackEvent=function(){return d}}var o=function(){},u=e.domFragment(s),a=["Gentium Book Basic","Lato","Vollkorn","Merriweather","Gravitas One","PT Sans","Open Sans","Bangers","Fredoka One","Covered By Your Grace","Coda"],f={black:"#000000",silver:"#c0c0c0",gray:"#808080",white:"#ffffff",maroon:"#800000",red:"#ff00000",purple:"#800080",fuchsia:"#ff00ff",green:"#008000",lime:"#00ff00",olive:"#808000",yellow:"#ffff00",navy:"#000080",blue:"#0000ff",teal:"#008080",aqua:"#00ffff"};return{extend:l,EDITOR_FRAGMENTS:u}}),n("editor/editor",["util/lang","util/xhr","./base-editor","./trackevent-editor"],function(e,t,n,r){function s(e){this.load=function(n,r){n=n||"",e.indexOf("{{baseDir}}")>-1&&(e=e.replace("{{baseDir}}",n)),t.get(e,function(e){e.target.readyState===4&&r(e.target.responseText)},"text/plain")}}var i={},o={BaseEditor:n,TrackEventEditor:r,register:function(e,t,n,r){function o(t){var n;return t.indexOf("load!")===0?(n=new s(t.substring(5)),i[e].deferredLayouts.push(n),!0):!1}i[e]={create:n,persist:!!r,layout:t||"",deferredLayouts:[]},t&&(Array.isArray(t)?t.forEach(o):o(t)&&(i[e].layout=""))},initialize:function(e,t){var n,r=0,s=[];for(n in i)i.hasOwnProperty(n)&&i[n].deferredLayouts.length>0&&s.push(i[n]);s.forEach(function(n){var i=0;n.deferredLayouts.forEach(function(o){o.load(t,function(t){++i,n.layout+=t,i===n.deferredLayouts.length&&(n.deferredLayouts=null,++r,r===s.length&&e())})})})},create:function(t,n){var r=i[t],s,o;if(!r)throw'Editor "'+t+'" does not exist.';if(r.layout){o=e.domFragment(r.layout),s=o,o.classList||(o=o.querySelector(".butter-editor"));if(!o)throw"Editor layout not formatted properly."}return new r.create(o,n,s)},isRegistered:function(e){return!!i[e]},isPersistent:function(e){return i[e].persist}};return o}),n("ui/toggler",[],function(){return function(e,t,n,r){var i=e;r!==!1&&r!==!0&&(r=!1),i.title=n||"Show/Hide",t&&i.addEventListener("click",t,!1),Object.defineProperties(this,{element:{enumerable:!0,get:function(){return i}},state:{enumerable:!0,get:function(){return i.classList.contains("toggled")},set:function(e){e?i.classList.add("toggled"):i.classList.remove("toggled")}},visible:{enumerable:!0,get:function(){return i.style.display!=="none"},set:function(e){i.style.display=e?"block":"none"}}}),this.state=r}}),n("text!layouts/editor-area.html",[],function(){return'<div class="butter-editor-area butter-form">\n  <div class="butter-editor-header">\n    <ul>\n      <li class="butter-editor-header-li"><a class="butter-btn butter-editor-header-media">\n        <span class="icon icon-white icon-film"></span>\n        Media\n      </a></li>\n      <li class="butter-editor-header-li"><a class="butter-btn butter-editor-header-popcorn">\n        <span class="icon icon-white icon-plus"></span>\n        Events\n      </a></li>\n      <li class="butter-editor-header-li"><a class="butter-btn butter-editor-header-share">\n        <span class="icon icon-white icon-share"></span>\n        Share\n      </a></li>\n      <li class="butter-editor-close-btn"><a class="butter-btn">\n        <span class="icon icon-only icon-white icon-chevron-right"></span>\n      </a></li>\n    </ul>\n  </div>\n  <div class="butter-editor-content"></div>\n</div>\n'}),n("text!editor/default.html",[],function(){return'<!--  This Source Code Form is subject to the terms of the MIT license\n      If a copy of the MIT license was not distributed with this file, you can\n      obtain one at https://raw.github.com/mozilla/butter/master/LICENSE -->\n\n<div class="butter-editor default-editor allow-scrollbar">\n  <h1>Add Event > Track Event Editor</h1>\n  <div class="butter-editor-body scrollbar-container">\n    <div class="editor-options-wrapper scrollbar-outer">\n      <div class="editor-options scrollbar-inner">\n        <div class="error-message-container">\n          <div class="error-message"></div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'}),n("editor/default",["text!./default.html","editor/editor","util/lang"],function(e,t,n){function r(e,r,i,s){function p(e){o.updatePropertiesFromManifest(e.target),o.setErrorState(!1)}var o=this;s=s||{};var u=e,a,f=[r.currentMedia].concat(r.targets),l=u.querySelector("div.error-message"),c=s.open,h=s.close;s.open=function(e,t){var r,s=u.querySelector(".editor-options"),h;o.applyExtraHeadTags(i),a=t,s.appendChild(o.createStartEndInputs(t,o.updateTrackEventSafe)),o.createPropertiesFromManifest({trackEvent:t,callback:function(e,t,n,r){e==="select"?o.attachSelectChangeHandler(t,n,r,o.updateTrackEventSafe):t.type==="checkbox"?o.attachCheckboxChangeHandler(t,n,r,o.updateTrackEventSafe):o.attachInputChangeHandler(t,n,r,o.updateTrackEventSafe)},basicContainer:s,ignoreManifestKeys:["target","start","end"]}),t.manifest.options.target&&!t.manifest.options.target.hidden&&(r=o.createTargetsList(f),h=r.querySelector("select"),o.attachSelectChangeHandler(h,t,"target"),s.appendChild(r)),o.updatePropertiesFromManifest(t,null,!0),o.scrollbar&&n.applyTransitionEndListener(l.parentNode,o.scrollbar.update),o.scrollbar.update(),o.setTrackEventUpdateErrorCallback(o.setErrorState),t.listen("trackeventupdated",p),c&&c.apply(this,arguments)},s.close=function(){a.unlisten("trackeventupdated",p),h&&h.apply(this,arguments)},t.TrackEventEditor.extend(o,r,e,s)}return t.register("default",e,r),{extend:function(e,t,n,i,s){return r.apply(e,[t,n,i,s])},EDITOR_SRC:e}}),n("editor/header",["ui/widget/tooltip"],function(e){return function(t,n){function l(){n.openEditor("plugin-list")}function c(){n.openEditor("share-properties")}var r=t.querySelector(".butter-editor-header-media"),i=t.querySelector(".butter-editor-header-popcorn"),s=t.querySelector(".butter-editor-header-share"),o,u,a={"media-editor":r,"plugin-list":i,"share-properties":s},f;o=e.create({name:"login-to-share",message:"Login and Save your project to share",element:s,top:"60px"}),u=e.create({name:"wait-for-media",message:"Waiting for media to load",element:i,top:"60px"}),r.addEventListener("click",function(){n.openEditor("media-editor")},!1),i.classList.add("butter-editor-btn-disabled"),this.setFocus=function(e){var t=a[e];f&&f.classList.remove("butter-active"),t&&(t.classList.add("butter-active"),f=t)},Object.defineProperty(this,"focusMap",{enumerable:!0,writeable:!1,configurable:!1,get:function(){return a}}),this.views={unSaved:function(){o.classList.remove("tooltip-off"),s.classList.add("butter-editor-btn-disabled"),s.removeEventListener("click",c,!1),f===s&&n.openEditor("media-editor")},saved:function(){o.classList.add("tooltip-off"),s.classList.remove("butter-editor-btn-disabled"),s.addEventListener("click",c,!1)},enablePlugins:function(){u.classList.add("tooltip-off"),i.classList.remove("butter-editor-btn-disabled"),i.addEventListener("click",l,!1)},disablePlugins:function(){u.classList.remove("tooltip-off"),i.classList.add("butter-editor-btn-disabled"),i.removeEventListener("click",l,!1)}}}}),n("util/mediatypes",["util/xhr","util/uri"],function(e,t){var n={youtube:/(?:https?:\/\/www\.|https?:\/\/|www\.|\.|^)youtu/,vimeo:/https?:\/\/(www\.)?vimeo.com\/(\d+)($|\/)/,soundcloud:/(?:https?:\/\/www\.|https?:\/\/|www\.|\.|^)(soundcloud)/};return{checkUrl:function(e){for(var t in n)if(n.hasOwnProperty(t)&&n[t].test(e))return t;return"html5"},getMetaData:function(e,n,r){var i,s,o,u,a;r=r||this.checkUrl(e),n=n||function(){};if(r==="youtube"){s=t.parse(e),i=s.queryKey.v||s.directory.replace("/","");if(!i)return;u="https://gdata.youtube.com/feeds/api/videos/"+i+"?v=2&alt=jsonc&callback=?",Popcorn.getJSONP(u,function(e){var t=e.data;if(!t)return;n({source:"http://www.youtube.com/watch?v="+i,title:t.title,type:r,thumbnail:t.thumbnail.hqDefault,author:t.uploader,duration:t.duration,denied:t.accessControl.embed==="denied"})})}else r==="soundcloud"?(s=t.parse(e),o=s.directory.split("/"),i=o[o.length-1],u="http://api.soundcloud.com/tracks/"+i+".json?callback=?&client_id=PRaNFlda6Bhf5utPjUsptg",Popcorn.getJSONP(u,function(t){var i;if(!t)return;if(t.sharing==="private"||t.embeddable_by==="none")i=!0;n({source:e,denied:i,type:r,thumbnail:t.artwork_url,duration:t.duration/1e3,title:t.title,hidden:!0})})):r==="vimeo"?(s=t.parse(e),o=s.directory.split("/"),i=o[o.length-1],u="http://vimeo.com/api/v2/video/"+i+".json?callback=?",Popcorn.getJSONP(u,function(t){t=t&&t[0];if(!t)return;n({source:e,type:r,thumbnail:t.thumbnail_small,duration:t.duration,title:t.title})})):r==="html5"&&(a=document.createElement("video"),a.addEventListener("loadedmetadata",function(){n({source:e,type:r,title:e.substring(e.lastIndexOf("/")+1),thumbnail:a,duration:a.duration})},!1),a.src=t.makeUnique(e).toString())}}}),n("text!layouts/media-editor.html",[],function(){return'<div class="media-editor butter-editor fadable alternates-hidden allow-scrollbar">\n  <h1 class="add-new-media">New video clip\n    <span class="media-loading-spinner butter-spinner hidden" ></span>\n  </h1>\n  <div class="butter-editor-body">\n    <fieldset class="add-media-panel">\n      <div class="media-editor-inner-wrapper primary-media-wrapper">\n        <p>\n          <span class="fl-right">\n            <span class="media-icon youtube-icon"></span>\n            <span class="media-icon vimeo-icon"></span>\n            <span class="media-icon soundcloud-icon"></span>\n            <span class="media-icon html5-icon"></span>\n          </span>\n          Paste a link from Youtube, Soundcloud, Vimeo or an HTML5 video\n        </p>\n        <textarea class="add-media-input" placeholder="Paste an HTML5, Youtube, Vimeo, or Soundcloud link here"></textarea>\n        <label class="media-error-message hidden">Your media seems to be taking a long time to load. Review your media URL(s) or continue waiting.</label>\n        <span class="butter-btn-slide-out">\n          <a class="add-media-btn butter-btn btn-green hidden">Create clip</a>\n          <a class="add-media-cancel-btn butter-btn btn-light hidden">Cancel</a>\n        </span>\n      </div>\n    </fieldset>\n\n    <div class="media-gallery">\n      <div class="media-gallery-heading">\n        Media Gallery\n      </div>\n      <div class="media-gallery-scroll-container">\n        <ul class="media-gallery-list"></ul>\n      </div>\n    </div>\n\n    <fieldset class="media-gallery-base-media butter-form-inline form-single bottom">\n      <label>Duration</label>\n      <input type="text" class="media-base-duration" value="">\n    </fieldset>\n\n  </div>\n</div>\n\n<!-- This is added to media-gallery for each new media item -->\n<li class="media-gallery-item">\n  <div class="mg-thumbnail"></div>\n  <div class="mg-meta-data">\n    <div class="mg-title"></div>\n    <div class="mg-type"></div>\n    <div class="mg-duration"></div>\n    <div class="mg-error"></div>\n  </div>\n  <span class="mg-delete-btn icon icon-trash"></span>\n</li>\n'}),n("editor/media-gallery-editor",["util/lang","util/xhr","util/keys","util/mediatypes","editor/editor","util/time","util/dragndrop","text!layouts/media-editor.html"],function(e,t,n,r,i,s,o,u){function T(){a.classList.toggle("add-media-collapsed")}function N(){c.value="",c.classList.remove("error"),d.classList.add("hidden"),m.classList.add("hidden"),h.classList.add("hidden"),p.classList.add("hidden")}function C(e){if(e===""){w.value=s.toTimecode(S.duration);return}e=s.toTimecode(e),w.value!==e&&(w.value=s.toTimecode(e)),e!==S.duration&&(e=s.toSeconds(e));if(e===S.duration)return;/[0-9]{1,9}/.test(e)?S.url="#t=,"+e:S.url=e}function k(e){function u(){function i(){r=E.generateSafeTrackEvent("sequencer",t,n),r.update({source:e.source,denied:e.denied,start:t,end:n,title:e.title,duration:e.duration,hidden:e.hidden}),E.deselectAllTrackEvents(),r.selected=!0}var t=E.currentTime,n=t+e.duration,r;n>S.duration?(E.listen("mediaready",function s(){E.unlisten("mediaready",s),i()}),C(n)):i()}var t=b.cloneNode(!0),n=t.querySelector(".mg-delete-btn"),r=t.querySelector(".mg-thumbnail"),i;o.helper(r,{pluginOptions:{source:e.source,denied:e.denied,end:e.duration,title:e.title,duration:e.duration,hidden:e.hidden}}),r.setAttribute("data-popcorn-plugin-type","sequencer"),r.setAttribute("data-butter-draggable-type","plugin"),m.classList.add("hidden"),t.querySelector(".mg-title").innerHTML=e.title,t.querySelector(".mg-type").innerHTML=e.type,t.querySelector(".mg-duration").innerHTML=s.toTimecode(e.duration)||"???",e.type==="html5"?i=e.thumbnail:(i=document.createElement("img"),i.src=e.thumbnail),r.appendChild(i),r.src=e.thumbnail,t.classList.add("mg-"+e.type),t.classList.add("new"),e.denied&&(t.querySelector(".mg-error").innerHTML="Embedding disabled by request"),setTimeout(function(){t.classList.remove("new")},2e3),r.addEventListener("click",u,!1),n.addEventListener("click",function(){r.removeEventListener("click",u,!1),y.removeChild(t)},!1),y.insertBefore(t,y.firstChild),N()}function L(){var e={};e.source=c.value,e.type="sequencer",m.classList.remove("hidden"),r.getMetaData(e.source,k)}function A(){v=c.value}function O(){v!==c.value?(h.classList.remove("hidden"),p.classList.remove("hidden")):(h.classList.add("hidden"),p.classList.add("hidden"))}function M(e){e.keyCode===n.ENTER&&(e.preventDefault(),L())}function _(e){e.preventDefault(),C(w.value)}function D(){f.addEventListener("click",T,!1),c.addEventListener("focus",A,!1),c.addEventListener("input",O,!1),c.addEventListener("keydown",M,!1),h.addEventListener("click",L,!1),p.addEventListener("click",N,!1),w.addEventListener("keydown",P,!1),w.addEventListener("blur",_,!1)}function P(e){e.keyCode===n.ENTER&&(e.preventDefault(),C(w.value))}var a=e.domFragment(u,".media-editor"),f=a.querySelector(".add-new-media"),l=a.querySelector(".add-media-panel"),c=l.querySelector(".add-media-input"),h=l.querySelector(".add-media-btn"),p=l.querySelector(".add-media-cancel-btn"),d=a.querySelector(".media-error-message"),v,m=a.querySelector(".media-loading-spinner"),g=a.querySelector(".media-gallery"),y=g.querySelector(".media-gallery-list"),b=e.domFragment(u,".media-gallery-item"),w=a.querySelector(".media-base-duration"),E,S,x;i.register("media-editor",null,function(e,t){e=a,x=this,E=t,D(),i.BaseEditor.extend(x,t,e,{open:function(){S=t.currentMedia,C(S.duration)},close:function(){}})})}),n("text!layouts/share-editor.html",[],function(){return'<div class="butter-editor share-editor allow-scrollbar">\n  <h1>Share your project</h1>\n  <div class="error-message-container">\n    <div class="error-message"></div>\n  </div>\n  <div class="butter-editor-body scrollbar-container">\n    <div class="scrollbar-outer">\n      <div class="container editor-container scrollbar-inner">\n        <h3 class="butter-no-top-margin">Link</h3>\n        <input class="butter-project-url" type="text" readonly="readonly">\n        <a class="butter-btn btn-light butter-preview-link" target="_blank"><span class="icon icon-share-alt"></span>Preview</a>\n        <a class="butter-btn btn-light butter-view-source-link" target="_blank"><span class="icon icon-eye-open"></span>View project source</a><br/>\n        <span class="butter-share-twitter"></span>\n        <span class="butter-share-google"></span>\n        <h3>Author</h3>\n        <input class="big butter-project-author" type="text" placeholder="Anonymous">\n        <h3>Embed</h3>\n        <p>Copy and paste the embed code below into any webpage.</p>\n        <textarea class="butter-project-embed-url" readonly="readonly"></textarea>\n        <label>Size</label>\n        <select class="butter-embed-size">\n          <option value="560x358">560x358</option>\n          <option value="640x403">640x403</option>\n          <option value="853x523">853x523</option>\n          <option value="1280x763">1280x763</option>\n        </select>\n      </div>\n    </div>\n  </div>\n</div>'}),n("util/social-media",[],function(){return function(){var t="__URL__PLACE__HOLDER__",n={facebook:{id:"facebook-jssdk",src:"//connect.facebook.net/en_US/all.js#xfbml=1",html:"<div class='fb-like' data-href='"+t+"' data-send='false' data-action='recommend' data-layout='button_count' data-show-faces='false' data-font='tahoma'></div>",afterHotLoad:function(){typeof window.FB=="object"&&window.FB.XFBML&&window.FB.XFBML.parse&&window.FB.XFBML.parse()}},google:{id:"google-plus",src:"//apis.google.com/js/plusone.js",html:"<g:plusone annotation='none' href='"+t+"'></g:plusone>"},twitter:{id:"twitter-wjs",src:"//platform.twitter.com/widgets.js",html:"<a href='https://twitter.com/share'class='twitter-share-button' data-text='Check out the #PopcornMaker page I just made: ' data-url='"+t+"' data-via='popcornjs' data-count='none'>Tweet</a>"},hotLoad:function(e,n,r){var i=document.getElementById(n.id);i&&i.parentNode.removeChild(i);var s=n.html.replace(t,r);e.innerHTML=s,function(e,t,n){var r=e.createElement("script");r.type="text/javascript",r.id=t,r.src=n,e.head.appendChild(r)}(document,n.id,n.src),n.afterHotLoad&&n.afterHotLoad()}};return n}}),n("editor/share-editor",["editor/editor","editor/base-editor","text!layouts/share-editor.html","util/social-media","ui/widget/textbox"],function(e,t,n,r,i){e.register("share-properties",n,function(t,n){function y(e){f.value="<iframe src='"+e+"' width='"+m+"' height='"+g+"'"+" frameborder='0' mozallowfullscreen webkitallowfullscreen allowfullscreen></iframe>"}var s=new r,o=t.querySelector(".editor-container"),u=o.querySelector(".butter-project-url"),a=o.querySelector(".butter-project-author"),f=o.querySelector(".butter-project-embed-url"),l=o.querySelector(".butter-embed-size"),c=o.querySelector(".butter-preview-link"),h=o.querySelector(".butter-view-source-link"),p=o.querySelector(".butter-share-twitter"),d=o.querySelector(".butter-share-google"),v=l.value.split("x"),m=v[0],g=v[1];a.value=n.project.author?n.project.author:"",l.addEventListener("change",function(){v=l.value.split("x"),m=v[0],g=v[1],y(n.project.iframeUrl)},!1),a.addEventListener("blur",function(){a.value!==n.project.author&&(n.project.author=a.value,n.project.save(function(){n.editor.openEditor("share-properties")}))},!1),i.applyTo(u,{readOnly:!0}),i.applyTo(f,{readOnly:!0}),i.applyTo(a),e.BaseEditor.extend(this,n,t,{open:function(){var e=n.project;u.value=e.publishUrl,c.href=n.project.previewUrl,c.onclick=function(){return!0},h.href="view-source:"+n.project.iframeUrl,h.onclick=function(){return!0},y(e.iframeUrl);if(!p.childNodes.length||!d.childNodes.length)s.hotLoad(p,s.twitter,e.publishUrl),s.hotLoad(d,s.google,e.publishUrl)},close:function(){}})},!0)}),n("editor/sequencer-editor",["util/mediatypes","editor/editor","util/time","util/uri","text!editor/default.html"],function(e,t,n,r,i){t.register("sequencer",i,function(i,s){function h(t){function s(e,t,n,r){l[r]={element:t,trackEvent:n,elementType:e}}function f(){function u(t,n){e.getMetaData(n.source,function(e){n.duration=e.duration,n.denied=e.denied,t.update(n)})}function a(e,t){e.update(t)}function f(e,t){t.from=n.toSeconds(t.from),t.from>=e.popcornOptions.duration&&(t.from=e.popcornOptions.from),e.update(t)}var r,s;for(r in l)l.hasOwnProperty(r)&&(s=l[r],s.elementType==="select"?o.attachSelectChangeHandler(s.element,s.trackEvent,r,o.updateTrackEventSafe):s.elementType==="input"?r==="source"?o.attachInputChangeHandler(s.element,s.trackEvent,r,u):r==="from"?o.attachInputChangeHandler(s.element,s.trackEvent,r,f):s.element.type==="checkbox"?o.attachCheckboxChangeHandler(s.element,s.trackEvent,r,a):o.attachInputChangeHandler(s.element,s.trackEvent,r,o.updateTrackEventSafe):s.elementType==="textarea"&&o.attachInputChangeHandler(s.element,s.trackEvent,r,o.updateTrackEventSafe));i.insertBefore(o.createStartEndInputs(t,o.updateTrackEventSafe),i.firstChild)}a=t,c=a.popcornOptions;var i=u.querySelector(".editor-options");l={},o.createPropertiesFromManifest({trackEvent:t,callback:s,basicContainer:i,ignoreManifestKeys:["start","end"]}),f(),o.updatePropertiesFromManifest(t),t.popcornOptions.source&&(Array.isArray(t.popcornOptions.source)||(t.popcornOptions.source=[t.popcornOptions.source]),l.source.element.value=r.stripUnique(t.popcornOptions.source[0]).toString()),t.popcornOptions.fallback&&(Array.isArray(t.popcornOptions.fallback)||(t.popcornOptions.fallback=[t.popcornOptions.fallback]),l.fallback.element.value=r.stripUnique(t.popcornOptions.fallback[0]).toString()),o.setTrackEventUpdateErrorCallback(o.setErrorState)}function p(e){a=e.target,o.updatePropertiesFromManifest(a),a.popcornOptions.source&&(Array.isArray(a.popcornOptions.source)||(a.popcornOptions.source=[a.popcornOptions.source]),l.source.element.value=r.stripUnique(a.popcornOptions.source[0]).toString()),a.popcornOptions.fallback&&(Array.isArray(a.popcornOptions.fallback)||(a.popcornOptions.fallback=[a.popcornOptions.fallback]),l.fallback.element.value=r.stripUnique(a.popcornOptions.fallback[0]).toString()),o.setErrorState(!1)}var o=this,u=i,a,f,l,c;t.TrackEventEditor.extend(o,s,i,{open:function(e,t){f=s,t.listen("trackeventupdated",p),h(t)},close:function(){a.unlisten("trackeventupdated",p)}})})}),n("editor/module",["core/eventmanager","core/trackevent","./editor","ui/toggler","util/lang","text!layouts/editor-area.html","./default","core/logger","./header","./media-gallery-editor","./share-editor","./sequencer-editor"],function(e,t,n,r,i,s,o,u,a){function l(o,l,c){function w(){o.project.isSaved?v.views.saved():v.views.unSaved()}l=l||{};var h,p=i.domFragment(s,".butter-editor-area"),d=p.querySelector(".butter-editor-content"),v,m,g=this,y={},b=new u(o.id);e.extend(g),c.Editor=n,v=new a(p,g),g.openEditor=function(e,t){t=t||{};var r=t.persist,s,u;return u=function(){o.dispatch("editoropened",e)},s=function(){i.removeTransitionEndListener(p,s),u()},r=r===!0||r===!1?r:n.isPersistent(e),m.state=!1,h&&h.close(),r&&y[e]?h=y[e]:h=y[e]=n.create(e,o),h.open(d,t.openData),h.listen("back",function(){g.openEditor(f)}),v.focusMap[e]?v.setFocus(e):v.setFocus(f),p.classList.contains("minimized")?(i.applyTransitionEndListener(p,s),p.classList.remove("minimized"),document.body.classList.add("editor-open")):u(),h},g.closeEditor=function(){h.close(),h=null,g.openEditor(f)},g.closeTrackEventEditor=function(e){var t=h.getTrackEvent;e&&t&&t().id===e.id&&g.closeEditor()},g.editTrackEvent=function(e){var r=n.isRegistered(e.type)?e.type:"default";if(!!e&&e instanceof t)return h&&h.getTrackEvent&&e.id===h.getTrackEvent().id?h:g.openEditor(r,{openData:e});throw new Error("trackEvent must be valid to start an editor.")},this._start=function(e){m=new r(p.querySelector(".butter-editor-close-btn"),function(){var e=!p.classList.contains("minimized"),t=function(){i.removeTransitionEndListener(p,t),g.dispatch("editortoggled",e)};m.state=e,e?(document.body.classList.remove("editor-open"),p.classList.add("minimized")):(document.body.classList.add("editor-open"),p.classList.remove("minimized")),i.applyTransitionEndListener(p,t)},"Show/Hide Editor",!0);var t=[],s=0;if(o.config.value("ui").enabled!==!1){o.listen("ready",w),o.listen("autologinsucceeded",w),o.listen("authenticated",w),o.listen("projectsaved",v.views.saved),o.listen("logout",v.views.unSaved),o.listen("projectchanged",v.views.unSaved),o.listen("mediacontentchanged",v.views.disablePlugins),o.listen("mediaready",v.views.enablePlugins),document.body.classList.add("butter-editor-spacing"),p.classList.add("minimized"),document.body.classList.remove("editor-open"),o.ui.setEditor(p);var u=o.config.value("editor");for(var a in u)u.hasOwnProperty(a)&&t.push({url:u[a],type:"js"});t.length>0?o.loader.load(t,function(){n.initialize(e,o.config.value("baseDir"))},function(n){b.log("Couldn't load editor "+n.target.src),++s===t.length&&e()}):e()}else e()},Object.defineProperties(g,{currentEditor:{enumerable:!0,get:function(){return h}}})}var f="plugin-list";return n.DefaultEditor=o,this.register=n.register,l.__moduleName="editor",l}),n("timeline/ghost-track",[],function(){function e(e,t){var n=this,r=document.createElement("div"),i;r.classList.add("butter-track"),r.classList.add("butter-track-ghost"),n.resultantTrack=null,i={addTrackEventGhost:function(e){e.track=n,r.appendChild(e.element)},removeTrackEventGhost:function(e){e.track=null,r.removeChild(e.element)}},Object.defineProperties(i,{element:{enumerable:!0,get:function(){return r}},track:{enumerable:!0,get:function(){return n}}}),Object.defineProperties(n,{lastTrack:{enumerable:!0,get:function(){return e}},nextTrack:{enumerable:!0,get:function(){return t}},view:{enumerable:!0,get:function(){return i}},isGhost:{enumerable:!0,get:function(){return!0}},numGhostTrackEvents:{enumerable:!0,get:function(){return r.childNodes.length}}})}return e}),n("timeline/ghost-manager",["./ghost-track"],function(e){function t(t,n){function s(t,n){var r;return t.ghost||(r=t.ghost=new e(t,n),n?i.insertBefore(r.view.element,n.view.element):i.appendChild(r.view.element)),t.ghost}function o(){var e=r.tracks;for(var t=0,n=e.length;t<n;++t)u(e[t])}function u(e){var t=e.ghost;t&&t.numGhostTrackEvents===0&&(i.removeChild(t.view.element),e.ghost=null)}var r=t,i=n;this.trackEventDragged=function(e,t){var n,i,a,f;if(t){n=t.track,f=t.findOverlappingTrackEvent(e);if(f){i=r.getNextTrack(n);if(!i||i.view.findOverlappingTrackEvent(e))i=s(n,i),e.ghost&&e.ghost.track!==i&&(a=e.ghost.track,e.cleanupGhost(),a.lastTrack&&u(a.lastTrack));e.ghost||i.view.addTrackEventGhost(e.createGhost()),e.updateGhost()}else e.ghost&&(n=e.ghost.track,e.cleanupGhost(),o())}else e.ghost&&(n=e.ghost.track,e.cleanupGhost(),o())},this.removeGhostsAfterDrop=function(e){var t=e.track,n=e.view.ghost;n&&n.track&&(e.view.cleanupGhost(t),o())}}return t}),n("timeline/track-container",["core/logger","util/dragndrop","./ghost-manager"],function(e,t,n){var r=.35,i=10;return function(e,s,o){function g(){f.scrollLeft=l.scrollWidth*d,l.style.width=f.clientWidth/v+"px",c.update(),h.update()}function y(e){var t=e.data.view;t.listen("trackeventdropped",T),l.appendChild(t.element),t.duration=u.duration,t.parent=a,c&&c.update()}function b(e){var t=e.target,n=t.element,r=t.trackEvent.track.view,i=n.getBoundingClientRect().top-l.getBoundingClientRect().top;r.element.removeChild(n),n.style.top=i+"px",l.appendChild(n),c.update()}function w(e,t){a.ghostManager.trackEventDragged(e.data,t.data),c.update()}function x(e,t,n,r){var i=u.forceEmptyTrackSpaceAtTime(r,t.start,t.end,e);n!==i?(n&&n.removeTrackEvent(e,!0),e.update(t),i.addTrackEvent(e),a.ghostManager.removeGhostsAfterDrop(e,n)):(e.update(t),a.ghostManager.removeGhostsAfterDrop(e,n))}function T(e){var t=e.data.trackEvent,n=e.data,r=e.data.track,i=t.track;x(t,n,i,r)}function N(e){function c(e,t,n,r){t<o&&r.blockIteration(o)}function h(e,t,n,r){t+n>a&&r.blockIteration(a)}function p(){var e={};r==="right"?e.end=n.popcornOptions.start+t.element.clientWidth/l.clientWidth*u.duration:e.start=t.element.offsetLeft/l.clientWidth*u.duration,n.update(e),t.setResizeHandler(null),t.unlisten("trackeventresizestopped",p)}var t=e.target,n=t.trackEvent,r=e.data.direction,i=n.popcornOptions.start,s=n.popcornOptions.end,o,a,f=n.track.trackEvents;r==="left"?(o=f.reduce(function(e,t){var r=t.popcornOptions;return t!==n&&r.end>e&&r.end<i?r.end:e},0),o=o/u.duration*l.offsetWidth+t.element.clientLeft*2,t.setResizeHandler(c)):(a=f.reduce(function(e,t){var r=t.popcornOptions;return t!==n&&r.start<e&&r.start>s?r.start:e},u.duration),a=a/u.duration*l.offsetWidth-t.element.clientLeft*2,t.setResizeHandler(h)),t.listen("trackeventresizestopped",p)}var u=s,a=this,f=o.querySelector(".tracks-container-wrapper"),l=o.querySelector(".tracks-container"),c,h,p,d=0,v=.1,m;a.ghostManager=new n(s,l),e.listen("trackorderchanged",function(e){var t=e.data;for(var n=0,r=t.length;n<r;++n){var i=t[n].view.element;i!==l.childNodes[n]&&l.insertBefore(i,l.childNodes[n]||null)}}),t.listen("dropfinished",function(){u.cleanUpEmptyTracks(),c.update()}),l.addEventListener("mousedown",function(){e.deselectAllTrackEvents()},!1),p=t.droppable(f,{startDrop:function(){m=null},drop:function(t,n){var r,i,s,o,a,f,c,h,p=l.getBoundingClientRect();i=(t.element||t).getAttribute("data-butter-draggable-type"),i==="plugin"?(r=e.currentMedia.addTrack(),r.view.dispatch("plugindropped",{start:(n[0]-p.left)/l.clientWidth*r.view.duration,track:r,type:t.getAttribute("data-popcorn-plugin-type")})):i==="trackevent"&&(s=t.data.trackEvent,o=t.getLastRect(),a=o.left-p.left,m||(m=e.currentMedia.addTrack()),f=s.popcornOptions.end-s.popcornOptions.start,c=a/l.clientWidth*u.duration,h=c+f,x(s,{start:c,end:h},s.track,m))}}),this.setScrollbars=function(e,t){c=e,h=t,h.update(),c.update()},u.listen("mediaready",function(){g();var e=u.tracks;for(var t=0,n=e.length;t<n;++t){var r=e[t].view;l.appendChild(r.element),r.duration=u.duration,r.parent=a}}),e.listen("mediaremoved",function(e){e.data===u&&p&&p.destroy()});var E=u.tracks;for(var S=0;S<E.length;++S)y({data:E[S]});u.listen("trackeventadded",function(e){var t=e.data.view;t.setDragHandler(w),t.listen("trackeventdragstarted",b),t.listen("trackeventresizestarted",N),c.update()}),u.listen("trackeventremoved",function(e){var t=e.data.view;t.setDragHandler(null),t.unlisten("trackeventdragstarted",b),t.unlisten("trackeventresizestarted",N),c.update()}),u.listen("trackadded",y),u.listen("trackremoved",function(e){var t=e.data.view;t.listen("trackeventdropped",T),l.removeChild(t.element),c&&c.update()}),a.followCurrentTime=function(){var e=u.currentTime/u.duration,t=e*l.clientWidth,n=f.clientWidth/2,s=t-f.scrollLeft,o=e*l.scrollWidth-n;s>=n&&!u.paused&&(s-n>i?f.scrollLeft=Math.round(f.scrollLeft-(f.scrollLeft-o)*r):f.scrollLeft=Math.round(o))},a.update=function(){g()},a.setViewportBounds=function(e,t){d=e>=0?e>1?1:e:d,v=t>=0?t>1?1:t:v,g()},a.snapTo=function(e){var t=e/u.duration,n=l.clientWidth*t,r=l.clientWidth-f.clientWidth;if(n<f.scrollLeft||n>f.scrollLeft+f.clientWidth){if(n>r){f.scrollLeft=r;return}f.scrollLeft=n}},this.getTrackWidth=function(){return l.offsetWidth},Object.defineProperties(this,{element:{enumerable:!0,value:f},container:{enumerable:!0,value:l}})}}),n("timeline/scrubber",["util/lang"],function(e){var t=16,n=20,r=3;return function(i,s,o,u){function O(){var e=v.duration,t=v.currentTime,n=p.element,r=n.scrollLeft,i=n.scrollWidth;if(T!==t||N!==r||C!==i){j();var s=Math.round(t/e*d),o=s-r;s<r||s-k>a.clientWidth+r?f.style.display="none":(f.style.left=o+"px",f.style.display="block"),s<r?h.style.display="none":(s>E+r?h.style.width=E-2+"px":h.style.width=o+"px",h.style.display="block")}T=t,N=r,C=i}function M(){A=!0,l.classList.remove("tooltip-no-transition-on"),S&&!L&&v.play(),x&&(x=!1),clearInterval(b),b=-1,s.addEventListener("mouseover",F,!1),window.removeEventListener("mouseup",M,!1),window.removeEventListener("mousemove",P,!1)}function _(e){e==="right"?b=setInterval(function(){g<w.right-r?(clearInterval(b),b=-1):(g+=n,p.element.scrollLeft+=n,D(),O())},t):b=setInterval(function(){g>w.left+r?(clearInterval(b),b=-1):(g-=n,p.element.scrollLeft-=n,D(),O())},t)}function D(){var e=g-m;e=Math.max(0,Math.min(e,E)),v.currentTime=(e+p.element.scrollLeft)/d*v.duration}function P(e){g=e.pageX,b===-1&&(g>w.right-r?_("right"):g<w.left+r&&_("left")),B(e),D(),O()}function H(){L=!1,v.unlisten("mediaseeked",H),S&&A&&v.play()}function B(e){y=e.clientX-s.offsetLeft,y<0?y=0:y>a.offsetWidth&&(y=a.offsetWidth),l.style.left=y+"px",j()}function j(){l.innerHTML=e.secondsToSMPTE((y+p.element.scrollLeft)/d*v.duration)}function F(e){B(e),l.classList.add("tooltip-no-transition-on"),s.addEventListener("mousemove",B,!1),s.removeEventListener("mouseover",F,!1),s.addEventListener("mouseout",I,!1)}function I(){l.classList.remove("tooltip-no-transition-on"),s.removeEventListener("mousemove",B,!1),s.removeEventListener("mouseout",I,!1),s.addEventListener("mouseover",F,!1)}var a=s.querySelector(".time-bar-scrubber-container"),f=a.querySelector(".time-bar-scrubber-node"),l=a.querySelector(".butter-time-tooltip"),c=a.querySelector(".time-bar-scrubber-line"),h=a.querySelector(".fill-bar"),p=u,d,v=o,m,g,y,b=-1,w,E=0,S=!1,x=!1,T=-1,N=p.element.scrollLeft,C=p.element.scrollWidth,k=0,L=!1,A=!1,q=this.onMouseDown=function(t){var n=t.pageX-a.getBoundingClientRect().left;x=!0,L=!0,A=!1,v.listen("mediaseeked",H),S&&v.pause(),v.currentTime=(n+p.element.scrollLeft)/d*v.duration,O(),m=t.pageX-f.offsetLeft,v.currentTime>=0&&(l.innerHTML=e.secondsToSMPTE(v.currentTime)),l.classList.add("tooltip-no-transition-on"),s.removeEventListener("mouseout",I,!1),s.removeEventListener("mousemove",B,!1),window.addEventListener("mousemove",P,!1),window.addEventListener("mouseup",M,!1)};s.addEventListener("mouseover",F,!1),this.update=function(e){E=e||E,d=p.container.getBoundingClientRect().width,w=a.getBoundingClientRect(),k=c.clientWidth,O()},this.enable=function(){a.addEventListener("mousedown",q,!1)},this.disable=function(){a.removeEventListener("mousedown",q,!1)},v.listen("mediaplay",function(){S=!0}),v.listen("mediapause",function(){!x&&!L&&(S=!1)}),v.listen("mediatimeupdate",O)}}),n("timeline/timebar",["util/lang","./scrubber"],function(e,t){var n=5,r="#999999";return function(i,s,o,u,a){function d(){var t=u.container.getBoundingClientRect().width,i=Math.min(t,h.container.scrollWidth),s=Math.min(i,h.element.offsetWidth-n),o=l.getContext("2d");l.height!==l.offsetHeight&&(l.height=l.offsetHeight),l.width!==s&&(l.width=s);var a=h.container.clientWidth/c.duration,f=o.measureText(e.secondsToSMPTE(5)).width,d=20,v=0,m=-((f+d)/2),g=h.element.scrollLeft/a,y=(h.element.scrollLeft+s)/a;o.clearRect(0,0,l.width,l.height),o.translate(-h.element.scrollLeft,0),o.beginPath();for(var b=1,w=c.duration+1;b<w;b++){if(b+1<g)continue;if(b-1>y)break;var E=b*a,S=-~E+~v;S>3&&(S>6&&(o.moveTo(-~E-S/2,0),o.lineTo(-~E-S/2,7),S>12&&(o.moveTo(-~E-S/4*3,0),o.lineTo(-~E-S/4*3,4),o.moveTo(-~E-S/4,0),o.lineTo(-~E-S/4,4))),o.moveTo(-~E,0),o.lineTo(-~E,10),E-m>f+d&&(m=E,o.fillStyle=r),v=E)}o.strokeStyle=r,o.stroke(),o.translate(h.element.scrollLeft,0),p.update(s)}var f=o.querySelector(".time-bar"),l=f.querySelector("canvas"),c=s,h=u,p=new t(i,f,c,h,a);c.listen("mediapause",function(){h.element.addEventListener("scroll",d,!1)}),c.listen("mediaplay",function(){h.element.removeEventListener("scroll",d,!1)}),h.element.addEventListener("scroll",d,!1),this.update=function(){d()},this.enable=function(){l.addEventListener("mousedown",p.onMouseDown,!1),p.enable()},this.disable=function(){l.removeEventListener("mousedown",p.onMouseDown,!1),p.disable()},Object.defineProperties(this,{element:{enumerable:!0,get:function(){return f}}})}}),n("timeline/status",["util/lang"],function(e){function t(e,t,n){function o(){s?i.removeAttribute("data-state"):i.setAttribute("data-state",!0)}var r=e.querySelector(t),i=r.querySelector(".status-button"),s=!0;i.addEventListener("click",n,!1),Object.defineProperties(this,{state:{enumerable:!0,get:function(){return s},set:function(e){s=e,o()}}})}function n(t,n){function u(t,n){if(typeof t=="string"||!isNaN(t)){if(n)try{t=Popcorn.util.toSeconds(t),s.currentTime=t}catch(r){t=s.currentTime}i.value=e.secondsToSMPTE(t)}else i.value=o}var r=t.querySelector(".time-container"),i=r.querySelector("input"),s=n,o=0;s.listen("mediatimeupdate",function(){u(s.currentTime,!1)}),i.addEventListener("focus",function(){o=i.value},!1),i.addEventListener("blur",function(){i.value!==o&&u(i.value,!0)},!1),i.addEventListener("keydown",function(e){e.which===13?i.blur():e.which===27&&(i.value=o,i.blur())},!1),u(0,!1)}return function(r,i){var s=r,o=i.querySelector(".status-container"),u,a,f;o.className="status-container",f=new n(i,s),u=new t(i,".mute-button-container",function(){s.muted=!s.muted}),a=new t(i,".play-button-container",function(){s.ended?s.paused=!1:s.paused=!s.paused}),a.state=!0,s.listen("mediamuted",function(){u.state=!1}),s.listen("mediaunmuted",function(){u.state=!0}),s.listen("mediavolumechange",function(){u.state=!s.muted}),s.listen("mediaended",function(){a.state=!0}),s.listen("mediaplay",function(){a.state=!1}),s.listen("mediapause",function(){a.state=!0}),s.listen("mediacontentchanged",function(){a.state=!0})}}),n("dialog/modal",[],function(){var e=document.createElement("div"),t=function(t,n){e.parentNode||(e.className="butter-modal-container",e.setAttribute("data-butter-exclude",!0),document.body.appendChild(e));var r=document.createElement("div");r.classList.add("butter-modal-overlay"),(n||n===undefined)&&r.classList.add("butter-modal-overlay-dark-bg"),e.appendChild(r),setTimeout(function(){r&&r.classList.add("fade-in")},10),r.appendChild(t),this.destroy=function(){e.removeChild(r),r=null},Object.defineProperties(this,{element:{enumerable:!0,get:function(){return r}}})};return t.element=e,t}),n("dialog/dialog",["util/lang","core/eventmanager","./modal"],function(e,t,n){function o(r,o,u){return function(a){function m(e){e.stopPropagation(),s.indexOf(e.target.nodeName)===-1&&(e.preventDefault(),!h||e.which!==13&&e.keyCode!==13?p&&(e.which===27||e.keyCode===27)&&l[p](e):l[h](e))}a=a||{};var f=a.events||{},l={},c=e.domFragment(r),h,p,d,v=u;if(!c.classList||!c.classList.contains("butter-dialog"))c=c.querySelector(".butter-dialog")||c.querySelector(".butter-first-run-dialog");var g={rootElement:c,activity:function(e){l[e]()},enableCloseButton:function(){var e=c.querySelector(".close-button");e&&e.addEventListener("click",function t(){g.activity("default-close"),e.removeEventListener("click",t,!1)},!1)},showError:function(e){var t=c.querySelector(".error");t&&(t.innerHTML=e,c.setAttribute("data-error",!0))},hideError:function(){c.removeAttribute("data-error")},assignEnterKey:function(e){h=e},assignEscapeKey:function(e){p=e},registerActivity:function(e,t){l[e]=t},assignButton:function(e,t){var n=c.querySelector(e);n.addEventListener("click",l[t],!1)},enableElements:function(){var e=arguments.length;while(e--)c.querySelector(arguments[e]).removeAttribute("disabled")},disableElements:function(){var e=arguments.length;while(e--)c.querySelector(arguments[e]).setAttribute("disabled",!0)},send:function(e,t){y.dispatch(e,t)}},y={element:c,open:function(e){if(i[v]){y.focus();return}i[v]=!0;for(var t in f)f.hasOwnProperty(t)&&y.listen(t,f[t]);d=new n(c,e),setTimeout(function(){y.focus()},0),document.addEventListener("keydown",m,!1),g.dispatch("open"),y.dispatch("open")},close:function(){i[v]=!1;for(var e in f)f.hasOwnProperty(e)&&e!=="close"&&g.unlisten(e,f[e]);d.destroy(),d=null,document.removeEventListener("keydown",m,!1),g.dispatch("close"),y.dispatch("close")},send:function(e,t){g.dispatch(e,t)},focus:function(){c.focus(),g.dispatch("focus")}};return t.extend(g),t.extend(y),g.registerActivity("default-close",function(){y.close()}),g.registerActivity("default-ok",function(){y.dispatch("submit"),y.close()}),o(g,a.data),y}}var r={},i={},s=["TEXTAREA"];return{register:function(e,t,n){r[e]=o(t,n,e),i[e]=!1},spawn:function(e,t){if(r[e])return r[e](t);throw"Dialog '"+e+"' does not exist."},modal:n}}),n("text!layouts/track-handle.html",[],function(){return'<div class="track-handle">\n  <span class="title"></span>\n  <span class="track-handle-icon"></span>\n  <div class="menu">\n    <div class="delete"></div>\n  </div>\n</div>\n'}),n("timeline/trackhandles",["dialog/dialog","util/dragndrop","util/lang","text!layouts/track-handle.html"],function(e,t,n,r){var i=37;return function(s,o,u,a){function y(){if(s.currentMedia){var e=s.currentMedia.orderedTracks,t;for(var n=0,r=e.length;n<r;++n)t=p[e[n].id],t&&c.appendChild(t.element)}}function w(t){var u=t.data,a=u.id,f=n.domFragment(r,".track-handle"),l=f.querySelector(".menu"),v=l.querySelector(".delete");v.addEventListener("click",function(){var t=e.spawn("delete-track",{data:u.name,events:{submit:function(e){if(e.data===!0){var n=u.trackEvents;for(var r=0,i=n.length;r<i;r++)s.editor.closeTrackEventEditor(n[r]);o.removeTrack(u)}t.close()},cancel:function(){t.close()}}});t.open()},!1),f.addEventListener("dblclick",function(){var t=e.spawn("track-data",{data:u,events:{submit:function(e){try{var n=JSON.parse(e.data),r=u.trackEvents,i=n.trackEvents,s={},o=[],a,l;f.childNodes[0].textContent=u.name=n.name;for(a=0,l=i.length;a<l;a++){var c=i[a],h=u.getTrackEventById(c.id);h?(h.update(c.popcornOptions),s[c.id]=c):o.push({type:c.type,popcornOptions:c.popcornOptions})}for(a=r.length,l=0;a>=l;a--)r[a]&&!s[r[a].id]&&u.removeTrackEvent(r[a]);for(a=0,l=o.length;a<l;a++)u.addTrackEvent(o[a]);t.send("track-updated")}catch(p){t.send("error")}}}});t.open()},!1),d.push(l),f.setAttribute("data-butter-track-id",a),l.setAttribute("data-butter-track-id",a),l.querySelector(".delete").setAttribute("data-butter-track-id",a),f.querySelector("span.track-handle-icon").setAttribute("data-butter-track-id",a),f.querySelector("span.title").setAttribute("data-butter-track-id",a),f.querySelector("span.title").appendChild(document.createTextNode(u.name)),b.addItem(f),c.appendChild(f),p[a]={id:a,track:u,element:f,menu:l},h.style.top=c.offsetHeight-i+"px",y()}var f=o,l=u.querySelector(".track-handle-container"),c=l.querySelector(".handle-list"),h=l.querySelector("button.add-track"),p={},d=[],v=this,m,g;h.addEventListener("click",function(){s.currentMedia.addTrack()},!1),t.listen("sortstarted",function(t){var n=t.data,r=s.currentMedia.orderedTracks,i=n.target.getAttribute("data-butter-track-id");for(var o=0;o<r.length;o++)r[o].id===i&&(m=o,g=i)});var b=t.sortable(c,{change:function(e){var t,n,r=s.currentMedia.orderedTracks,i,o;for(var u=0,a=e.length;u<a;++u){n=e[u].getAttribute("data-butter-track-id");if(n===g){t=u;break}}i=r[m],r.splice(m,1),r.splice(t,0,i),o=t;if(t<m){var f=m;m=t,t=f}s.currentMedia.sortTracks(m,t),m=o}});f.listen("trackorderchanged",function(e){var t=e.data;for(var n=0,r=t.length;n<r;n++){var i=t[n],s=p[i.id].element;s.querySelector("span.title").textContent=i.name}});var E=f.tracks;for(var S=0;S<E.length;++S)w({data:E[S]});f.listen("trackadded",w),f.listen("trackremoved",function(e){var t=e.data.id;c.removeChild(p[t].element),b.removeItem(p[t].element),d.splice(d.indexOf(p[t].menu),1),delete p[t],h.style.top=c.offsetHeight-i+"px"}),a.element.addEventListener("scroll",function(){l.scrollTop=a.element.scrollTop},!1),l.addEventListener("mousewheel",function(e){e.wheelDeltaY&&(a.element.scrollTop-=e.wheelDeltaY,e.preventDefault())},!1),l.addEventListener("DOMMouseScroll",function(e){e.axis===e.VERTICAL_AXIS&&!e.shiftKey&&(a.element.scrollTop+=e.detail*2,e.preventDefault())},!1),this.update=function(){l.scrollTop=a.element.scrollTop,h.style.top=c.offsetHeight-i+"px"},v.update(),Object.defineProperties(this,{element:{enumerable:!0,get:function(){return l}}})}}),n("text!layouts/super-scrollbar.html",[],function(){return'<div id="butter-super-scrollbar-outer-container">\n  <div class="butter-super-scrollbar-zoom-slider-container">\n    <span class="tick"></span>\n    <span class="tick"></span>\n    <span class="tick"></span>\n    <span class="tick"></span>\n    <span class="tick"></span>\n    <span class="tick"></span>\n    <div class="butter-super-scrollbar-zoom-slider">\n      <div class="butter-super-scrollbar-zoom-handle"></div>\n    </div>\n  </div>\n  <div id="butter-super-scrollbar-inner-container">\n    <div id="butter-super-scrollbar-visuals"></div>\n    <span id="butter-super-scrollbar-viewport" class="viewport-transition"> \n      <span id="butter-super-scrollbar-handle-left" class="butter-super-scrollbar-handle">\n        <span class="butter-super-arrow"></span>\n      </span>\n      <span id="butter-super-scrollbar-handle-right" class="butter-super-scrollbar-handle">\n        <span class="butter-super-arrow"></span>\n      </span>\n    </span>\n    <span id="buter-super-scrollbar-scrubber"></span>\n  </div>\n</div>\n'}),n("timeline/super-scrollbar",["util/lang","text!layouts/super-scrollbar.html"],function(e,t){var n=1,r=5,i=50,s="super-scrollbar-small";return function(o,u,a,f){function R(e){var t=v.clientWidth,n=v.offsetLeft,r=h.width,i=t/r,s=i-e,o=s/2,u=o*r,a,f;if(u>-1&&u<1)return;a=1-(n+t)/r+o,f=n/r+o,a<0&&(f+=a,a=0),f<0&&(a+=f,f=0),v.style.right=a*100+"%",v.style.left=f*100+"%",N(f,e)}function U(){v.classList.remove("viewport-transition"),window.removeEventListener("mouseup",U,!1),window.removeEventListener("mousemove",z,!1),E.addEventListener("mousedown",X,!1),S.addEventListener("mousedown",V,!1)}function z(e){e.preventDefault(),W(e)}function W(e){var t=e.clientX-(E.offsetLeft+S.offsetWidth/2),n;t<0?t=0:t>w.offsetWidth&&(t=w.offsetWidth),n=t/w.offsetWidth,n*h.width<r&&(n=r/h.width),R(n),S.style.left=t/w.offsetWidth*100+"%"}function X(e){v.classList.add("viewport-transition"),W(e),S.removeEventListener("mousedown",V,!1),E.removeEventListener("mousedown",X,!1),window.addEventListener("mousemove",z,!1),window.addEventListener("mouseup",U,!1)}function V(){v.classList.add("viewport-transition"),S.removeEventListener("mousedown",V,!1),E.removeEventListener("mousedown",X,!1),window.addEventListener("mousemove",z,!1),window.addEventListener("mouseup",U,!1)}function $(e,t){var r=document.createElement("div"),i=e.view.element.style;r.classList.add("butter-super-scrollbar-trackevent"),T[e.id]=r,y.appendChild(r),r.style.width=i.width,r.style.left=i.left,r.style.top=(r.offsetHeight+n)*t+"px"}var l=e.domFragment(t,"#butter-super-scrollbar-outer-container"),c=l.querySelector("#butter-super-scrollbar-inner-container"),h,p,d=f,v=c.querySelector("#butter-super-scrollbar-viewport"),m=v.querySelector("#butter-super-scrollbar-handle-left"),g=v.querySelector("#butter-super-scrollbar-handle-right"),y=c.querySelector("#butter-super-scrollbar-visuals"),b=c.querySelector("#buter-super-scrollbar-scrubber"),w=l.querySelector(".butter-super-scrollbar-zoom-slider"),E=l.querySelector(".butter-super-scrollbar-zoom-slider-container"),S=l.querySelector(".butter-super-scrollbar-zoom-handle"),x=0,T={},N=function(e,t){t!==-1&&(S.style.left=t*100+"%"),a(e,t)},C=this,k,L,A,O,M,_,D,P,H,B,j,F,I,q;k=function(){v.getBoundingClientRect().width<i?c.classList.add(s):c.classList.remove(s)},C.update=function(){h=c.getBoundingClientRect(),k()},j=function(e){e.stopPropagation(),window.removeEventListener("mouseup",j,!1),window.removeEventListener("mousemove",I,!1)},L=function(e){e.stopPropagation(),window.removeEventListener("mouseup",L,!1),window.removeEventListener("mousemove",O,!1)},M=function(e){e.stopPropagation(),o.addEventListener("scroll",q,!1),window.removeEventListener("mouseup",M,!1),window.removeEventListener("mousemove",D,!1)},P=function(e){e.stopPropagation(),o.addEventListener("scroll",q,!1),window.removeEventListener("mouseup",P,!1),window.removeEventListener("mousemove",B,!1)},F=function(e){e.stopPropagation(),f.currentTime=(e.clientX-h.left)/h.width*p,v.classList.remove("viewport-transition"),window.addEventListener("mouseup",j,!1),window.addEventListener("mousemove",I,!1)},A=function(e){e.stopPropagation(),v.classList.remove("viewport-transition"),x=e.clientX-h.left-v.offsetLeft,d.pause(),window.addEventListener("mouseup",L,!1),window.addEventListener("mousemove",O,!1)},_=function(e){e.stopPropagation(),d.pause(),v.classList.remove("viewport-transition"),o.removeEventListener("scroll",q,!1),window.addEventListener("mouseup",M,!1),window.addEventListener("mousemove",D,!1)},H=function(e){e.stopPropagation(),d.pause(),o.removeEventListener("scroll",q,!1),v.classList.remove("viewport-transition"),window.addEventListener("mouseup",P,!1),window.addEventListener("mousemove",B,!1)},I=function(e){e.preventDefault(),e.stopPropagation(),f.currentTime=(e.clientX-h.left)/h.width*p},O=function(e){e.preventDefault(),e.stopPropagation(),N(Math.max(0,e.clientX-h.left-x)/h.width,-1)},D=function(e){e.preventDefault(),e.stopPropagation();var t=e.clientX-h.left;t<0&&(t=0),t+r>v.offsetLeft+v.clientWidth&&(t=v.offsetLeft+v.clientWidth-r),v.style.left=t/h.width*100+"%",N(v.offsetLeft/h.width,v.offsetWidth/h.width)},B=function(e){e.preventDefault(),e.stopPropagation();var t=h.width-(e.clientX-h.left);t<0&&(t=0),v.style.right=t/h.width*100+"%",N(v.offsetLeft/h.width,v.offsetWidth/h.width)},q=function(){v.style.left=o.scrollLeft/u.offsetWidth*100+"%",v.style.right=(1-(o.scrollLeft+o.offsetWidth)/u.offsetWidth)*100+"%"},c.addEventListener("mousedown",F,!1),o.addEventListener("scroll",q,!1),v.addEventListener("mousedown",A,!1),m.addEventListener("mousedown",_,!1),g.addEventListener("mousedown",H,!1),E.addEventListener("mousedown",X,!1),S.addEventListener("mousedown",V,!1),d.listen("trackeventremoved",function(e){var t=T[e.data.id];t&&(delete T[e.data.id],t.parentNode.removeChild(t))}),d.listen("trackeventupdated",function(e){var t=T[e.data.id],n=e.data.view.element.style;t&&(t.style.width=n.width,t.style.left=n.left)}),d.listen("trackorderchanged",function(e){var t=e.data,r=0,i,s,o,u,a=t.length;for(;r<a;r++){u=t[r];for(i=0,s=u.trackEvents.length;i<s;i++)o=T[u.trackEvents[i].id],o&&(o.style.top=(o.offsetHeight+n)*u.order+"px")}}),d.listen("mediatimeupdate",function(e){b.style.left=e.data.currentTime/p*100+"%"}),C.initialize=function(){var e,t,n,r,i,s,o,u=d.tracks;for(e=0,n=u.length;e<n;e++){o=u[e],i=o.trackEvents,s=o.order;for(t=0,r=i.length;t<r;t++)$(i[t],s)}d.listen("trackeventadded",function(e){$(e.data,e.target.order)})},d.listen("mediaready",function(e){p=e.target.duration,q()}),C.resize=function(){C.update(),N(v.offsetLeft/h.width,v.offsetWidth/h.width)},Object.defineProperties(this,{element:{enumerable:!0,get:function(){return l}}})}}),n("text!layouts/media-instance.html",[],function(){return'<div class="media-instance">\n  <div class="track-handle-container">\n    <div class="handle-list"></div>\n    <button class="butter-btn btn-light add-track" title="Add a new Layer for your events">+\n    </button>\n  </div>\n  <div class="media-container">\n    <div class="tracks-container-wrapper">\n      <div class="tracks-container"></div>\n    </div>\n  </div>\n</div>\n'}),n("timeline/media",["core/trackevent","core/track","core/eventmanager","./track-container","util/scrollbars","./timebar","./status","./trackhandles","./super-scrollbar","util/lang","text!layouts/media-instance.html"],function(e,t,n,r,i,s,o,u,a,f,l){function h(e,t){function p(e,t){if(h[0]!==e||h[1]!==t)h=[e,t],g.setViewportBounds(e,t),D()}function N(){g.update(),S.update(),b.resize()}function C(){g.followCurrentTime(),S.update()}function k(e){function u(){window.removeEventListener("mouseup",u,!1),window.removeEventListener("mousemove",a,!1);if(!o.shiftKey){n=v.tracks;for(r=0,i=n.length;r<i;r++)n[r].deselectEvents(t)}else t.selected&&s&&(t.selected=!1)}function a(){window.removeEventListener("mousemove",a,!1),window.removeEventListener("mouseup",u,!1)}var t=e.data.trackEvent,n,r,i,s=t.selected,o=e.data.originalEvent;if(!o.shiftKey&&!t.selected){n=v.tracks;for(r=0,i=n.length;r<i;r++)n[r].deselectEvents(t)}t.selected=!0,window.addEventListener("mouseup",u,!1),window.addEventListener("mousemove",a,!1)}function L(t){e.editor.editTrackEvent(t.target)}function A(t){e.editor.closeTrackEventEditor(t.target)}function O(){D(),S.enable(),v.currentTime=0}function M(){function t(e){var t=e.data;t.view.listen("trackeventmousedown",k),t.listen("trackeventselected",L),t.listen("trackeventdeselected",A)}function n(e){var n=e.data;n.view.listen("plugindropped",_),n.view.listen("trackeventmousedown",k);var r=n.trackEvents;for(var i=0;i<r.length;++i)t({data:r[i]})}v.unlisten("mediaready",M),v.listen("mediaready",O),y.appendChild(g.element),m.appendChild(b.element),y.appendChild(w.element),y.appendChild(E.element),m.appendChild(x.element),e.ui.tray.setMediaInstance(m),v.listen("trackeventremoved",function(e){var t=e.data;t.view.unlisten("trackeventmousedown",k),t.unlisten("trackeventselected",L),t.unlisten("trackeventdeselected",A)});var r=v.tracks;for(var i=0;i<r.length;++i)n({data:r[i]});v.listen("trackadded",n),v.listen("trackeventadded",t),v.listen("trackremoved",function(e){var t=e.data;t.view.unlisten("plugindropped",_),t.view.unlisten("trackeventmousedown",k)}),b.initialize(),h=c,g.setViewportBounds(h[0],h[1]),O()}function _(t){var n=t.data.type,r=t.data.track,i=t.data.start,s=t.data.end,o,u;if(t.data.popcornOptions){o={};for(var a in t.data.popcornOptions)t.data.popcornOptions.hasOwnProperty(a)&&(o[a]=t.data.popcornOptions[a])}v.ready&&(o&&o.end&&(s=o.end+i),u=e.generateSafeTrackEvent(n,i,s,r),o&&(o.end&&(o.end=u.popcornOptions.end),u.update(o)),e.editor.editTrackEvent(u))}function D(){v.duration&&(g.update(),S.update(),w.update(),b.update(),x.update())}var h=c,d=this,v=t,m=f.domFragment(l,".media-instance"),g=new r(e,t,m),y=m.querySelector(".media-container"),b=new a(g.element,g.container,p,v),w=new i.Vertical(g.element,g.container),E=new i.Horizontal(g.element,g.container),S=new s(e,v,e.ui.tray.statusArea,g),x=new u(e,v,m,g),T;T=new o(v,e.ui.tray.statusArea),g.setScrollbars(w,E),n.extend(d),window.addEventListener("resize",function(){w.update(),S.update(),b.resize()},!1),v.listen("mediaplay",function(){g.snapTo(v.currentTime),v.listen("mediatimeupdate",C)}),v.listen("mediapause",function(){v.unlisten("mediatimeupdate",C)}),v.listen("mediaready",M),e.editor.listen("editortoggled",N),e.listen("editoropened",N),v.listen("mediacontentchanged",S.disable),this.destroy=function(){m.parentNode&&m.parentNode.removeChild(m),e.editor.unlisten("editortoggled",N),e.unlisten("editoropened",N)},this.hide=function(){m.style.display="none"},this.show=function(){m.style.display="block"},e.listen("ready",function(){D()}),this.trackContainer=g,this.element=m,this.media=v}var c=[0,.5];return h}),n("timeline/module",["core/logger","./media"],function(e,t){var n=function(e){var n={},r,i=document.createElement("div");i.id="butter-timeline",i.classList.add("fadable"),this._start=function(e){e()},this.getCurrentTrackWidth=function(){return r.trackContainer.getTrackWidth()},e.listen("mediaadded",function(s){function a(e){r!==n[e.data.id]&&(r&&r.hide(),r=n[e.data.id],r&&r.show())}function f(t){var i=t.data;n[i.id]&&n[i.id].destroy(),delete n[i.id],r&&i.id===r.media.id&&(r=undefined),e.unlisten("mediachanged",a),e.unlisten("mediaremoved",f)}var o=s.data,u=new t(e,o);n[o.id]=u,i.appendChild(u.element),e.listen("mediachanged",a),e.listen("mediaremoved",f)})};return n.__moduleName="timeline",n}),n("cornfield/module",["util/xhr"],function(e){function r(){return location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")}var t=window.jsSHA,n="data:image/(jpeg|png);base64,",i=function(i){function p(t){e.get(f+"/api/whoami",function(){if(this.readyState===4){var e;try{e=JSON.parse(this.response||this.responseText),e.status==="okay"&&(s=!0,o=e.email,a=e.username,u=e.name)}catch(n){e={error:"failed to parse data from server: \n"+this.response}}t&&t(e)}})}function d(e,t){console.warn("Warning: Popcorn Maker publish is already in progress. Ignoring request."),t({error:"Publish is already in progress. Ignoring request."})}function v(e,t){c.publish=d,h(f+"/api/publish/"+e,null,function(){if(this.readyState===4){var e;c.publish=v;try{e=JSON.parse(this.response||this.responseText),t(e)}catch(n){t({error:"an unknown error occured"})}}})}function m(e,t,n){console.warn("Warning: Popcorn Maker save is already in progress. Ignoring request."),n({error:"Save is already in progress. Ignoring request."})}function g(e,r,s){c.save=m;var o=f+"/api/project/";e&&(o+=e);var u={};i.orderedTrackEvents.forEach(function(e){var r,i;e.popcornOptions.src&&(i=e.popcornOptions.src.match(n),i&&(r=(new t(e.popcornOptions.src.substr(i[0].length),"TEXT")).getHash("SHA-1","HEX"),u[r]=e))}),h(o,r,function(){if(this.readyState===4){c.save=g;try{var e=JSON.parse(this.response||this.responseText);Array.isArray(e.imageURLs)&&e.imageURLs.forEach(function(e){var t=u[e.hash];t?t.update({src:e.url}):console.warn("Cornfield responded with invalid image hash:",e.hash)}),s(e)}catch(t){s({error:"an unknown error occured"})}}},"application/json")}var s=!1,o="",u="",a="",f=r(),l=[],c=this,h=function(){console.warn("XHR.post occurred without a CSRF token. Buffering request."),l.push(arguments)};e.setCSRFTokenAcquiredCallback(function(){var t;while(l.length)t=l.shift(),e.post.apply(this,t);e.setCSRFTokenAcquiredCallback(null),h=e.post}),this.login=function(e){navigator.id.get(function(t){t?h(f+"/persona/verify",{assertion:t},function(){if(this.readyState===4)try{var t=JSON.parse(this.response||this.responseText);if(t.status==="okay"){p(function(t){e(t)});return}e(t)}catch(n){e({error:"an unknown error occured"})}}):e(undefined)})},i.listen("ready",function y(){i.unlisten("ready",y),p(function(e){e.error||i.dispatch("autologinsucceeded",e)})}),this.email=function(){return o},this.name=function(){return u},this.username=function(){return a},this.authenticated=function(){return s},this.logout=function(e){h(f+"/persona/logout",null,function(){o="";if(this.readyState===4){var t;try{t=JSON.parse(this.response||this.responseText),s=!1,o="",a="",u=""}catch(n){t={error:"an unknown error occured"}}e&&e(t)}})},this.save=g,this.publish=v};return i.__moduleName="cornfield",i}),n("text!layouts/plugin-list-editor.html",[],function(){return'<div class="plugin-list-editor butter-editor fadable allow-scrollbar">\n  <h1>Events</h1>\n  <div class="butter-editor-body scrollbar-container">\n    <div class="plugin-container-wrapper">\n      <div class="plugin-container scrollbar-outer scrollbar-inner">\n        <a href="#" draggable="true" class="butter-plugin-tile">\n          <span class="butter-plugin-icon"></span><span class="butter-plugin-label"></span>\n        </a>\n      </div>\n    </div>\n  </div>\n</div>\n'}),n("plugin/plugin-list",["util/dragndrop","util/lang","editor/editor","text!layouts/plugin-list-editor.html"],function(e,t,n,r){return function(i){var s=t.domFragment(r,".plugin-list-editor"),o=s.querySelector(".plugin-container"),u=i.targets,a=[],f;for(var l=0,c=u.length;l<c;l++)f=document.createElement("div"),f.classList.add("butter-iframe-fix"),u[l].element.appendChild(f),a.push(f);var h=o.querySelector(".butter-plugin-tile");h.parentNode.removeChild(h),n.register("plugin-list",null,function(e,t){e=s,n.BaseEditor.extend(this,t,e,{open:function(){},close:function(){}})},!0),i.listen("pluginadded",function(t){function c(){var e;i.currentMedia.ready&&(e=i.generateSafeTrackEvent(t.data.type,i.currentTime),i.editor.editTrackEvent(e))}var n=h.cloneNode(!0),r=t.data.helper,s=n.querySelector(".butter-plugin-icon"),f=n.querySelector(".butter-plugin-label"),l=t.data.name;e.helper(n,{start:function(){for(var e=0,t=u.length;e<t;++e)u[e].view.blink(),a[e].style.display="block"},stop:function(){i.currentMedia.pause();for(var e=0,t=u.length;e<t;++e)a[e].style.display="none"}}),n.addEventListener("dblclick",c,!1),r&&(s.style.backgroundImage="url('"+r.src+"')"),f.innerHTML=l,n.setAttribute("data-popcorn-plugin-type",t.data.type),n.setAttribute("data-butter-draggable-type","plugin"),t.data.hidden&&(n.style.display="none"),o.appendChild(n)})}}),n("plugin/plugin",[],function(){return function(e){e=e||{};var t=this,n;this.type=e.type,this.name=e.displayName||e.type,this.path=e.path,this.hidden=e.hidden,this.generateHelper=function(){n=document.getElementById(t.type+"-icon")||document.getElementById("default-icon");if(!n)return;n=n.cloneNode(!1),n.id=null,n.setAttribute("data-popcorn-plugin-type",t.type),n.setAttribute("data-butter-draggable-type","plugin"),t.helper=n}}}),n("plugin/module",["core/logger","./plugin-list","./plugin"],function(e,t,n){var r=function(e,r){function u(e){return function(){return!!Popcorn.manifest[e]}}var i=this.plugins=[],s,o=this;this._start=function(n){s=new t(e),r&&r.plugins?o.add(r.plugins,n):n()},this.add=function(t,r){var s=[],o=[],a,f,l;t instanceof Array||(t=[t]);for(f=0,l=t.length;f<l;f++)a=new n(t[f]),o.push({type:"js",url:a.path,check:u(a.type)}),s.push(a),e.ui.enabled&&a.generateHelper();return e.loader.load(o,function(){for(f=0,l=s.length;f<l;f++)a=s[f],i.push(a),e.dispatch("pluginadded",a);r()},function(){console.warn("Failed to load all plugins. Please check logs and file paths.")}),s},this.remove=function(t){var n,r,s;if(typeof t=="string"){t=this.get(t);if(!t)return}n=e.getTrackEventsByType(t.type);while(n.length)r=n.pop(),r.track.removeTrackEvent(r);s=i.indexOf(t),s>-1&&i.splice(s,1),e.dispatch("pluginremoved",t)},this.clear=function(){while(i.length>0){var t=i.pop();e.dispatch("pluginremoved",t)}},this.get=function(e){for(var t=0,n=i.length;t<n;++t)if(i[t].type===e)return i[t]}};return r.__moduleName="plugin",r}),n("modules",["editor/module","timeline/module","cornfield/module","plugin/module"],function(){var e=Array.prototype.slice.apply(arguments);return function(t,n,r){var i=[],s=0,o=0;for(var u=0;u<e.length;++u){var a=e[u].__moduleName;n[a]=new e[u](n,r.value(a),t),i.push(n[a])}return{load:function(e){function t(){s++,s===i.length&&e()}for(var n=0;n<i.length;++n)i[n]._load?i[n]._load(t):s++;s===i.length&&e()},ready:function(e){function t(){o++,o===i.length&&e()}for(var n=0;n<i.length;++n)i[n]._start?i[n]._start(t):t()}}}}),n("loaders/base-loader",[],function(){function t(t,n){var r,i;while(e.test(n))r=e.exec(n),i=t[r[1]]||"",n=n.replace(r[0],i);return n=n.replace(/([^:])\/\//g,"$1/"),n}function n(e){this.configDirs=e}var e=/\{([\w\-\._]+)\}/;return n.fixUrl=function(e){return t(this.configDirs,e)},n.generateDefaultCheckFunction=function(){var e=0;return function(){return e++>0}},n.DEFAULT_ERROR_FUNCTION=function(e){e&&console.warn(e.toString())},n.DEFAULT_LOADED_FUNCTION=function(){},n}),n("loaders/js-loader",["./base-loader"],function(e){function t(t){e.call(this,t)}return t.prototype=Object.create(e),t.prototype.constructor=t,t.prototype.load=function(t,n,r,i,s){i=i||e.generateDefaultCheckFunction(),s=s||e.DEFAULT_ERROR_FUNCTION,r=r||e.DEFAULT_LOADED_FUNCTION,t=this.fixUrl(t);if(!i()){var o=document.createElement("script");o.type="text/javascript",o.onload=r,o.onerror=function(e){o.onload=null,s(e)},o.src=t,document.head.appendChild(o)}else r&&r()},t}),n("loaders/css-loader",["./base-loader"],function(e){function n(t){e.call(this,t)}var t=10;return n.prototype=Object.create(e),n.prototype.constructor=n,n.prototype.load=function(e,n,r,i,s){function l(){if(f)return;f=!0,u=setInterval(function(){i()&&(clearInterval(u),r&&r())},t)}var o,u,a,f=!1;i=i||function(){return!!o},e=this.fixUrl(e),i()?r&&r():(o=document.createElement("link"),o.type="text/css",o.rel="stylesheet",o.onerror=s,o.onload=l,o.href=e,document.head.appendChild(o),a=document.createElement("img"),a.onerror=l,a.src=e)},n}),n("loaders/load-item",[],function(){function e(e,t,n,r,i){function f(){u(s)}function l(e){o=e,a(s)}var s=this,o=null,u,a;this.load=function(e,s){u=e,a=s,t.load(n,r,f,i,l)},Object.defineProperties(this,{error:{enumerable:!0,get:function(){return o}}})}return e}),n("loaders/load-group",["./load-item"],function(e){function t(t,n,r,i){function c(){function i(e){l.push(e),t()}function u(e){f.push(e),r.call(this,e.error),t()}var e=0,t=function(){var t=o[e++];t?t.load(i,u):n(s)};t()}function h(){function t(t){l.push(t),e()}function i(t){f.push(t),r.call(this,t.error),e()}var e=function(){l.length+f.length===o.length&&n&&n(s)};o.forEach(function(e){e.load(t,i)})}var s=this,o=[],u=t,a=!1,f=[],l=[];this.addItem=function(t){if(!t.type){console.warn("Loader description requires a type.");return}if(!t.url){console.warn("Loader description requires a url.");return}if(!u[t.type]){console.warn("Invalid loader type: "+t.type+".");return}o.push(new e(t.type+"",u[t.type],t.url+"",!!t.exclude,t.check))},this.start=function(){if(a)return;a=!0,i?c():h()}}return t}),n("dependencies",["util/xhr","loaders/js-loader","loaders/css-loader","loaders/load-group"],function(e,t,n,r){return function(e){var i=e.value("dirs"),s={js:new t(i),css:new n(i)};this.load=function(e,t,n,i){var o;n=n||function(e){e&&console.warn(e.toString())},o=new r(s,t,n,i),Array.isArray(e)&&e.length>0?e.forEach(function(e){o.addItem(e)}):o.addItem(e),o.start()}}}),n("text!dialog/dialogs/error-message.html",[],function(){return'<!--  This Source Code Form is subject to the terms of the MIT license\n      If a copy of the MIT license was not distributed with this file, you can\n      obtain one at https://raw.github.com/mozilla/butter/master/LICENSE -->\n\n<div class="butter-dialog butter-form">\n  <h3><span class="message">Error</span></h3>\n  <a class="close-button"><span class="icon icon-only icon-x"></span></a>\n</div>\n'}),n("dialog/dialogs/error-message",["text!dialog/dialogs/error-message.html","dialog/dialog"],function(e,t){t.register("error-message",e,function(e,t){var n=e.rootElement.querySelector(".message");n.innerHTML=t,e.enableCloseButton(),e.assignEscapeKey("default-close"),e.assignEnterKey("default-ok")})}),n("text!dialog/dialogs/track-data.html",[],function(){return'<!--  This Source Code Form is subject to the terms of the MIT license\n      If a copy of the MIT license was not distributed with this file, you can\n      obtain one at https://raw.github.com/mozilla/butter/master/LICENSE -->\n\n<div class="butter-dialog butter-form">\n  <h3 class="butter-dialog-title">Data for <span class="track-name"></span></h3>\n  <textarea class="track-data main-textarea" readonly>Please wait...</textarea>\n  <div class="error"></div>\n  <a class="close-button"><span class="icon icon-only icon-x"></span></a>\n</div>\n'}),n("dialog/dialogs/track-data",["text!dialog/dialogs/track-data.html","dialog/dialog"],function(e,t){t.register("track-data",e,function(e,t){var n=e.rootElement,r=n.querySelector(".track-name"),i=n.querySelector(".track-data"),s=t.json;r.innerHTML=s.name,i.value=JSON.stringify(s),e.enableCloseButton(),e.assignEscapeKey("default-close")})}),n("text!dialog/dialogs/delete-track.html",[],function(){return'<!--  This Source Code Form is subject to the terms of the MIT license\n      If a copy of the MIT license was not distributed with this file, you can\n      obtain one at https://raw.github.com/mozilla/butter/master/LICENSE -->\n\n<div class="butter-dialog butter-form small">\n  <p>Are you sure you want to delete <span class="track-name"></span>?</p>\n  <div class="buttons vbox center">\n    <button class="butter-btn btn-light butter-dialog-button yes">Yes</button>\n    <button class="butter-btn btn-light butter-dialog-button no">No</button>\n  </div>\n  <a class="close-button"><span class="icon icon-only icon-x"></span></a>\n</div>\n'}),n("dialog/dialogs/delete-track",["text!dialog/dialogs/delete-track.html","dialog/dialog"],function(e,t){t.register("delete-track",e,function(e,t){e.registerActivity("ok",function(){e.send("submit",!0)}),e.rootElement.querySelector(".track-name").appendChild(document.createTextNode(t)),e.enableElements(".yes",".no"),e.enableCloseButton(),e.assignEscapeKey("default-close"),e.assignEnterKey("ok"),e.assignButton(".yes","ok"),e.assignButton(".no","default-close")})}),n("text!dialog/dialogs/delete-track-events.html",[],function(){return'<!--  This Source Code Form is subject to the terms of the MIT license\n      If a copy of the MIT license was not distributed with this file, you can\n      obtain one at https://raw.github.com/mozilla/butter/master/LICENSE -->\n\n<div class="butter-dialog butter-form small">\n  <p><strong>Deleting all track events cannot be undone. Do you wish to continue?</strong></p>\n  <div class="buttons vbox center">\n    <button class="butter-btn btn-light butter-dialog-button yes">Yes</button>\n    <button class="butter-btn btn-light butter-dialog-button no">No</button>\n  </div>\n  <a class="close-button"><span class="icon icon-only icon-x"></span></a>\n</div>\n'}),n("dialog/dialogs/delete-track-events",["text!dialog/dialogs/delete-track-events.html","dialog/dialog"],function(e,t){t.register("delete-track-events",e,function(e,t){var n=t;e.registerActivity("ok",function(){n.currentMedia.clear(),n.currentMedia.addTrack(),e.send("ok"),e.activity("default-close")}),e.enableElements(".yes",".no"),e.enableCloseButton(),e.assignEscapeKey("default-close"),e.assignEnterKey("ok"),e.assignButton(".yes","ok"),e.assignButton(".no","default-close")})}),n("text!dialog/dialogs/feedback.html",[],function(){return'<!--  This Source Code Form is subject to the terms of the MIT license\n      If a copy of the MIT license was not distributed with this file, you can\n      obtain one at https://raw.github.com/mozilla/butter/master/LICENSE -->\n\n<div class="butter-dialog butter-feedback-form">\n  <div class="butter-logo"></div>\n  <div class="butter-dialog-offset">\n    <div class="butter-dialog-title">Feedback<span class="icon icon-info-sign"></span>\n      <p class="dialog-info dialog-hidden">You can send feedback about bugs, suggestions, or ideas you have for new projects.</p>\n    </div>\n  </div>\n  <div class="butter-form">\n    <fieldset>\n      <label><span class="ticket-icon"></span>Thanks for your feedback. Let us know how we can improve, or what we\'re doing right. Along with your comments, we\'ll be collecting your browser type (<b id="browser"></b>) and the date (<b id="date"></b>).</label>\n      <textarea id="comments" class="track-data main-textarea" placeholder="I think it would be awesome if..."></textarea>\n    </fieldset>\n    <fieldset>\n      <button class="butter-btn btn-red butter-dialog-button update">Send Feedback</button>\n    </fieldset>\n  </div>\n  <a class="close-button"><span class="icon icon-only icon-x"></span></a>\n</div>\n'}),n("dialog/dialogs/feedback",["text!dialog/dialogs/feedback.html","dialog/dialog","util/xhr"],function(e,t,n){t.register("feedback",e,function(e){var t=e.rootElement,r=t.querySelector(".update"),i=t.querySelector(".icon-info-sign"),s=t.querySelector(".dialog-info"),o=t.querySelector("#browser"),u=navigator.userAgent,a=t.querySelector("#date"),f=(new Date).toDateString(),l=t.querySelector("#comments");o.innerHTML=u,a.innerHTML=f,r.addEventListener("click",function(){if(l.value){var t={date:f,browser:u,comments:l.value};n.post("/feedback",JSON.stringify(t),function(){},"text/json"),e.activity("default-close")}},!1),i.addEventListener("click",function(){s.classList.toggle("dialog-hidden")},!1),e.enableCloseButton(),e.assignEscapeKey("default-close")})}),n("text!dialog/dialogs/crash.html",[],function(){return'<!-- This Source Code Form is subject to the terms of the MIT license\nIf a copy of the MIT license was not distributed with this file, you can\nobtain one at https://raw.github.com/mozilla/butter/master/LICENSE -->\n\n<div class="butter-dialog butter-feedback-form">\n  <div class="butter-logo"></div>\n  <div class="butter-dialog-offset">\n    <div class="butter-dialog-title">Popcorn Maker encountered an error<span class="icon icon-info-sign"></span>\n      <p id="report" class="dialog-info dialog-hidden"></p>\n    </div>\n  </div>\n  <div class="butter-form">\n    <fieldset>\n      <label>Popcorn Maker needs to be reloaded. Your project was backed up and will be restored upon reloading. You can send an anonymous error report (click the \'i\' above for details) to Mozilla or skip this step and reload now. If you have any extra information you\'d like to send, enter it below. Mozilla makes crash reports available to the public.</label>\n      <textarea id="comments" class="track-data main-textarea" placeholder="I was working and all of a sudden..."></textarea>\n    </fieldset>\n    <fieldset>\n      <button id="yes" class="butter-btn btn-green butter-dialog-button update">Yes, send anonymous report</button>\n      <button id="no" class="butter-btn btn-red butter-dialog-button update">No thanks, don\'t send</button>\n    </fieldset>\n  </div>\n  <a class="close-button"><span class="icon icon-only icon-x"></span></a>\n</div>\n'}),n("dialog/dialogs/crash",["text!dialog/dialogs/crash.html","dialog/dialog","util/lang"],function(e,t,n){function r(e){return"<b>Date</b>: "+e.date+"<br>"+"<b>App URL</b>: "+e.appUrl+"<br>"+"<b>Script URL</b>: "+e.scriptUrl+":"+e.lineno+"<br>"+"<b>Media URL(s)</b>: "+e.mediaUrl+"<br>"+"<b>Error</b>: "+n.escapeHTML(e.message)+"<br>"+"<b>Butter State</b>: "+e.stateList.slice().reverse().join(", ")+"<br>"+"<b>Browser</b>: "+e.userAgent+"<br>"+"<b>Null DOM Nodes</b>: "+e.nullDomNodes+"<br>"+"<b>Versions</b>: Popcorn="+e.popcornVersion+", Butter="+e.butterVersion}t.register("crash",e,function(e,t){var n=e.rootElement,i=n.querySelector("#report"),s=n.querySelector(".dialog-info"),o=n.querySelector(".icon-info-sign"),u=n.querySelector("#comments"),a=n.querySelector("#no"),f=n.querySelector("#yes"),l=t.onSendReport,c=t.onNoReport;i.innerHTML=r(t),o.addEventListener("click",function(){s.classList.toggle("dialog-hidden")},!1),a.addEventListener("click",c,!1),f.addEventListener("click",function(){l(u.value||"")},!1),e.enableCloseButton(),e.assignEscapeKey("default-close")})}),n("text!dialog/dialogs/first-run.html",[],function(){return'<!-- This Source Code Form is subject to the terms of the MIT license\nIf a copy of the MIT license was not distributed with this file, you can\nobtain one at https://raw.github.com/mozilla/butter/master/LICENSE -->\n\n<!-- This is just a placeholder, really -->\n<div class="butter-first-run-dialog butter-feedback-form butter-dialog">\n  <div class="butter-logo"></div>\n  <div class="butter-dialog-offset">\n    <div class="butter-dialog-body">\n      <h2><strong>Welcome to Popcorn Maker!</strong> To get started, enter a media source here.</h2>\n    </div>\n  </div>\n</div>\n'}),n("dialog/dialogs/first-run",["text!dialog/dialogs/first-run.html","dialog/dialog"],function(e,t){t.register("first-run",e,function(e){e.assignEscapeKey("default-close")})}),n("text!dialog/dialogs/backup.html",[],function(){return'<!-- This Source Code Form is subject to the terms of the MIT license\nIf a copy of the MIT license was not distributed with this file, you can\nobtain one at http://www.mozillapopcorn.org/butter-license.txt -->\n\n<div class="butter-dialog">\n  <div class="butter-form">\n    <fieldset>\n      <h2>Popcorn Maker found an automatic backup for "<span class="butter-backup-project-name"></span>".</h2>\n      <p>Looks like you had <strong>unsaved changes</strong> for the project "<span class="butter-backup-project-name"></span>" from <span class="butter-backup-date"></span>. Do you want to load this project, or discard your changes?</p>\n    </fieldset>\n    <fieldset>\n      <button id="yes" class="butter-btn btn-green butter-backup-load">Yes, load this backup</button>\n      <button id="no" class="butter-btn btn-red butter-backup-discard">No, discard my changes</button>\n    </fieldset>\n  </div>\n</div>\n'}),n("dialog/dialogs/backup",["text!dialog/dialogs/backup.html","dialog/dialog","util/time"],function(e,t,n){function r(e,t){for(var n=0,r=t.length;n<r;n++)t[n].innerHTML=e}function i(e,t){return function(){e(),t.activity("default-close")}}t.register("backup",e,function(e,t){var s=e.rootElement,o=s.querySelectorAll(".butter-backup-project-name"),u=s.querySelector(".butter-backup-date"),a=s.querySelector(".butter-backup-load"),f=s.querySelector(".butter-backup-discard"),l=i(t.loadProject,e),c=i(t.discardProject,e),h=t.projectName||"Unsaved Project";a.addEventListener("click",l,!1),f.addEventListener("click",c,!1),u.innerHTML=n.toPrettyString(Date.now()-t.backupDate)+" ago",r(h,o)})}),n("dialogs",["dialog/dialogs/error-message","dialog/dialogs/track-data","dialog/dialogs/delete-track","dialog/dialogs/delete-track-events","dialog/dialogs/feedback","dialog/dialogs/crash","dialog/dialogs/first-run","dialog/dialogs/backup"],function(){}),n("text!layouts/header.html",[],function(){return'<div class="butter-header" data-butter-exclude>\n  <nav id="webmaker-nav"></nav>\n  <a href="http://www.mozilla.org/" id="tabzilla">mozilla</a>\n  <header class="butter-header-primary">\n    <div class="butter-logo"></div>\n    <ul class="butter-nav">\n      <li class="butter-breadcrumbs"></li>\n      <li class="butter-project-title" style="display: none">\n       <a class="butter-project-name">My Cool Remix</a><i class="icon icon-pencil"></i>\n      </li>\n      <li>\n        <a class="butter-btn btn-green butter-save-btn butter-disabled">Sign in to save</a>\n        <div class="butter-btn-menu-container butter-project-menu">\n          <a class="butter-btn btn-light butter-project-menu-control butter-btn-menu-control"><span class="icon icon-only icon-cog"></span></a>\n          <ul class="butter-btn-menu">\n            <li><a class="butter-btn" href="/templates/basic/" target="_blank"> New</a></li>\n            <li><a class="butter-btn" href="/dashboard" target="_blank"> Open...</a></li>\n            <li><a class="butter-btn butter-clear-events-btn" target="_blank"> Clear Events</a></li>\n            <li><a class="butter-preview-btn butter-btn btn-light butter-disabled" \n                   target="_blank"><span class="icon icon-only icon-share-alt"></span> Preview</a></li>\n            <li><a class="butter-share-btn butter-btn btn-light butter-disabled" target="_blank"><span class="icon icon-only icon-share"></span> Share</a></li>\n          </ul>\n        </div>\n      </li>\n    </ul>\n  </header>\n</div>\n'}),n("ui/user-data",["dialog/dialog"],function(e){return function(t){var n=this;this.showErrorDialog=function(t,n){var r=e.spawn("error-message",{data:t,events:{cancel:function(){r.close(),n&&typeof n=="function"&&n()}}});r.open()},this.authenticationRequired=function(e,r){if(t.cornfield.authenticated()){t.dispatch("authenticated");if(e&&typeof e=="function"){e();return}}t.cornfield.login(function(i){if(i.status==="okay"){t.dispatch("authenticated");if(e&&typeof e=="function"){e();return}}else n.showErrorDialog("There was an error logging in. Please try again."),r&&typeof r=="function"&&r()})},this.save=function(e,r){e=e||function(){},r=r||function(){},t.project.name?(t.ui.loadIndicator.start(),t.project.save(function(i){t.ui.loadIndicator.stop();if(i.error!=="okay"){n.showErrorDialog("There was a problem saving your project, so it was backed up to your browser's storage (i.e., you can close or reload this page and it will be recovered). Please try again."),r();return}e()})):r()},this.logout=function(e){t.cornfield.logout(function(){e&&typeof e=="function"&&e(),t.dispatch("logout")})}}}),n("text!ui/webmakernav/webmakernav.html",[],function(){return'<div class="webmaker-nav-container">\n  <div class="webmaker-nav-top">\n    <ul class="webmaker-nav primary">\n      <li><a class="on" data-tab="webmaker">Webmaker</a></li>\n      <li><a data-tab="projects">Projects</a></li>\n      <li><a data-tab="tools">Tools</a></li>\n      <li><a data-tab="events">Events</a></li>\n      <li><a href="#" class="webmaker-feedback-btn">Feedback</a></li>\n    </ul>\n    <ul class="webmaker-nav user-info">\n\n      <li class="login-join">\n        <span class="login">Sign Up</span>\n        <div class="join butter-tooltip">\n          <div class="h3">Log in to Popcorn to save and share your projects</div>\n          <div class="persona-img"></div><div class="info">Popcorn Maker uses <strong>Mozilla Persona</strong>, which puts you in control of your identity with a single email of your choice.</div>\n        </div>\n      </li>\n      <li class="user">\n        <div class="user-name link">\n          <span class="user-name-container"></span>\n          <span class="icon icon-white icon-downtick"></span>\n          <div class="butter-tooltip tooltip-user tooltip-no-hover">\n            <ul>\n              <li><a href="/dashboard" class="my-projects" target="_blank">My Projects</a></li>\n              <li><a class="logout-btn">Logout</a></li>\n            </ul>\n          </div>\n        </div>\n      </li>\n    </ul>\n  </div>\n\n  <div class="webmaker-tabs">\n    <div class="webmaker-nav webmaker-tab tab-webmaker">\n      <div class="tab-inner">\n        <img class="logo" src="/resources/webmaker/webmaker-main_01.png" alt="">\n        <div class="h3 webmaker-slogan">Mozilla Webmaker wants to help you make something amazing on the web.</div>\n        <div class="secondary-info">\n          <div class="info">You\'re using <strong>Popcorn Maker</strong> to remix web video, but Webmaker can also help you learn HTML and CSS, earn badges, create webpages, join meetups in your area, and <a href="http://webmaker.org" target="_blank">other cool stuff</a>.</div>\n        </div>\n      </div>\n    </div>\n    <div class="webmaker-tab tab-projects">\n      <ul class="webmaker-nav tab-inner">\n        <li><a href="https://webmaker.org/projects/" target="_blank">All</a></li>\n        <li><a href="https://webmaker.org/projects/?tool=popcorn" target="_blank">Popcorn Projects</a></li>\n        <li><a href="https://webmaker.org/projects/?tool=thimble" target="_blank">Thimble Projects</a></li>\n      </ul>\n    </div>\n    <div class="webmaker-tab tab-tools">\n      <ul class="webmaker-nav tab-inner">\n        <li><a class="on">Popcorn</a></li>\n        <li><a href="https://thimble.webmaker.org/editor" target="_blank">Thimble</a></li>\n        <li><a href="https://webmaker.org/tools/x-ray-goggles/" target="_blank">X-ray Goggles</a></li>\n      </ul>\n    </div>\n    <div class="webmaker-tab tab-events">\n      <ul class="webmaker-nav tab-inner">\n        <li><a href="https://webmaker.org/events" target="_blank">All Events</a></li>\n        <li><a href="https://webmaker.org/events/search" target="_blank">Search</a></li>\n        <li><a href="https://donate.mozilla.org/page/event/create" target="_blank">Create</a></li>\n      </ul>\n    </div>\n  </div>\n</div>\n'}),n("text!ui/webmakernav/webmakernav.css",[],function(){return'/* THIS FILE WAS GENERATED BY A TOOL, DO NOT EDIT. SEE .less FILE IN css/ */\n\n.butter-editor-header{position:absolute;top:0;right:0;left:-1px;border-bottom:5px solid #3fb58e;height:45px;background:#052938}.butter-editor-header>ul{margin:0;padding:0;width:100%;list-style:none}.butter-editor-header>ul>.butter-editor-header-li{float:left;position:relative;top:0}.butter-editor-header .butter-btn{background:0;border:0;color:#FFF;font-size:14px;padding:0 10px;border-radius:0;height:45px;line-height:45px}.butter-editor-header .butter-btn>.icon{margin-top:1px;margin-left:0;margin-right:2px}.butter-editor-header .butter-btn.butter-active{background:#3fb58e}.butter-editor-header .butter-btn.butter-editor-btn-disabled{color:rgba(255,255,255,0.3)}.butter-editor-header .butter-btn.butter-editor-btn-disabled>.icon{opacity:.3}.butter-editor-close-btn{position:fixed;top:0;right:0;z-index:100000011}.butter-editor-close-btn.toggled .icon{background-image:url("../resources/icons/glyphiconshalflings-alt.png");background-position:-432px -72px}.butter-editor-area{position:fixed;z-index:100000001;top:0;bottom:0;right:0;width:350px;background:#f4f5f5;-webkit-transition:right .35s;-moz-transition:right .35s;-o-transition:right .35s;-ms-transition:right .35s;transition:right .35s;border-left:1px solid #ccc}.butter-editor-area.minimized{right:-352px}.butter-editor-area .butter-editor{color:#555;font-size:13px;position:absolute;top:0;left:0;right:0;bottom:0}.butter-editor-area .butter-editor .butter-editor-tabs{padding:0 20px;margin:0;list-style:none;height:30px}.butter-editor-area .butter-editor .butter-editor-tabs>li{float:left;margin-right:3px;margin-top:-1px}.butter-editor-area .butter-editor .butter-editor-tabs>li a:hover{color:#555}.butter-editor-area .butter-editor .butter-editor-tabs .butter-btn{background:#e6e6e6;border-radius:0;border:1px solid #ccc}.butter-editor-area .butter-editor .butter-editor-tabs .butter-btn.butter-active{background:#FFF;border-top-color:#FFF}.butter-editor-area .butter-editor h1,.butter-editor-area .butter-editor .butter-breadcrumbs{color:#3fb58e;font-weight:700;font-size:16px;text-transform:capitalize;height:50px;line-height:50px;margin:0;padding:0 20px;background:#FFF;border-bottom:1px solid #ccc;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;box-sizing:border-box}.butter-editor-area .butter-editor h1 .butter-breadcrumbs-back,.butter-editor-area .butter-editor .butter-breadcrumbs .butter-breadcrumbs-back{opacity:.6;position:relative;padding-right:15px;margin-right:15px;display:inline-block;cursor:pointer;border-right:1px solid #ccc}.butter-editor-area .butter-editor h1 .butter-breadcrumbs-back:after,.butter-editor-area .butter-editor .butter-breadcrumbs .butter-breadcrumbs-back:after,.butter-editor-area .butter-editor h1 .butter-breadcrumbs-back:before,.butter-editor-area .butter-editor .butter-breadcrumbs .butter-breadcrumbs-back:before{left:100%;border:solid transparent;content:" ";height:0;width:0;position:absolute;pointer-events:none}.butter-editor-area .butter-editor h1 .butter-breadcrumbs-back:after,.butter-editor-area .butter-editor .butter-breadcrumbs .butter-breadcrumbs-back:after{border-left-color:#fff;border-width:5px;top:50%;margin-top:-5px}.butter-editor-area .butter-editor h1 .butter-breadcrumbs-back:before,.butter-editor-area .butter-editor .butter-breadcrumbs .butter-breadcrumbs-back:before{border-left-color:#ccc;border-width:7px;top:50%;margin-top:-7px}.butter-editor-area .butter-editor h1 .butter-breadcrumbs-back:hover,.butter-editor-area .butter-editor .butter-breadcrumbs .butter-breadcrumbs-back:hover{opacity:1}.butter-editor-area .butter-editor h1 .close-btn,.butter-editor-area .butter-editor .butter-breadcrumbs .close-btn{position:relative;float:right;top:10px;left:10px;line-height:14px;cursor:pointer}.butter-editor-area .butter-editor .editor-tabs{position:absolute;top:60px;left:5px;bottom:5px;right:5px;border-radius:5px}.butter-editor-area .butter-editor .editor-tabs>button{margin:10px}.butter-editor-area .display-off{display:none}.butter-editor-area .error-message-container{-webkit-transition:height .35s,margin .35s,padding .35s;-moz-transition:height .35s,margin .35s,padding .35s;-o-transition:height .35s,margin .35s,padding .35s;-ms-transition:height .35s,margin .35s,padding .35s;transition:height .35s,margin .35s,padding .35s;overflow:hidden;height:0;color:#d93b21;visibility:hidden;width:300px}.butter-editor-area .error-message-container.open{padding:10px 20px;padding-right:15px;background:#f0dddd}.butter-editor-area .butter-editor-spacing{padding-right:0}.butter-editor-area .butter-editor-spacing.editor-open{padding-right:350px}.butter-editor-area .butter-editor-content{position:absolute;top:50px;bottom:0;width:100%}.butter-editor-area .butter-editor-body{position:absolute;top:50px;bottom:0;width:100%}.butter-editor-area .butter-editor-body.butter-tabs-spacing{top:80px}.butter-editor-area .scrollbar-outer{position:absolute;top:0;right:15px;left:0;bottom:0;overflow:hidden}.butter-editor-area .allow-scrollbar .butter-scroll-bar.butter-scroll-bar-v{top:5px;right:5px;width:10px;bottom:5px}.butter-form .trackevent-property,.butter-form .trackevent-warning,.butter-form fieldset{border:0;margin:10px 20px;padding:0;*zoom:1}.butter-form .trackevent-property:before,.butter-form .trackevent-warning:before,.butter-form fieldset:before,.butter-form .trackevent-property:after,.butter-form .trackevent-warning:after,.butter-form fieldset:after{content:"";display:table}.butter-form .trackevent-property:after,.butter-form .trackevent-warning:after,.butter-form fieldset:after{clear:both}.butter-form .trackevent-warning{background:#d9dddd;padding:10px;border-radius:5px}.butter-form label.property-name,.butter-form label{display:block;font-size:13px;padding:5px 0}.butter-form .editor-section-header{font-weight:700;font-size:16px;margin-bottom:5px}.butter-form select,.butter-form input,.butter-form textarea{height:32px;width:100%;padding:6px;margin-bottom:5px;border:1px solid #ccc;border-top-color:#b3b3b3;border-radius:2px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;box-sizing:border-box}.butter-form select:-moz-placeholder,.butter-form input:-moz-placeholder,.butter-form textarea:-moz-placeholder{color:#AAA}.butter-form select:focus,.butter-form input:focus,.butter-form textarea:focus{outline:0;border:1px solid #3fb58e;-webkit-transition:border .25s ease;-moz-transition:border .25s ease;-o-transition:border .25s ease;-ms-transition:border .25s ease;transition:border .25s ease}.butter-form textarea{height:100px;line-height:1.3;resize:none}.butter-form .butter-form-radio,.butter-form .butter-form-checkbox{line-height:1.3em;padding-left:40px;padding-top:0;border:0}.butter-form input[type="radio"],.butter-form input[type="checkbox"]{float:left;vertical-align:text-top;width:12px;height:13px;margin-left:-38px;margin-top:2px}.butter-form .checkbox-group{float:left;margin-right:10px}.butter-form .checkbox-group input[type="checkbox"]{float:right}.butter-form input:invalid,.butter-form textarea:invalid,.butter-form input:invalid+.butter-unit{border-color:#dd3534}.butter-form .butter-form-append{position:relative;display:inline-block;*zoom:1}.butter-form .butter-form-append:before,.butter-form .butter-form-append:after{content:"";display:table}.butter-form .butter-form-append:after{clear:both}.butter-form .butter-form-append>input{height:32px;float:left;border-radius:2px 0 0 2px;width:200px}.butter-form .butter-unit{height:30px;position:absolute;right:-2px;bottom:5px;font-family:Menlo,Monaco,Consolas,"Courier New",monospace;font-size:10px;line-height:32px;padding:0 5px;min-width:16px;font-weight:normal;text-align:center;background-color:#f4f5f5;color:#777;border:1px solid #ccc;border-radius:0 3px 3px 0}.butter-form .butter-form-inline.form-single{*zoom:1}.butter-form .butter-form-inline.form-single:before,.butter-form .butter-form-inline.form-single:after{content:"";display:table}.butter-form .butter-form-inline.form-single:after{clear:both}.butter-form .butter-form-inline.form-single label{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;box-sizing:border-box;width:80px;float:left;padding:0;margin-top:5px}.butter-form .butter-form-inline.form-single>input,.butter-form .butter-form-inline.form-single textarea,.butter-form .butter-form-inline.form-single select{float:left;margin-left:5px;width:201px}.butter-form .butter-form-inline.form-half .butter-form-radio,.butter-form .butter-form-inline.form-half .butter-form-checkbox{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;box-sizing:border-box;width:143px;float:left}.butter-form .butter-form-inline.form-half>input,.butter-form .butter-form-inline.form-half>select,.butter-form .butter-form-inline.form-half .butter-form-append{position:relative;width:133px;float:left}.butter-form .butter-form-inline.form-half>input:last-child,.butter-form .butter-form-inline.form-half>select:last-child,.butter-form .butter-form-inline.form-half .butter-form-append:last-child{margin-left:10px}.butter-form .butter-form-inline.form-half>input>input,.butter-form .butter-form-inline.form-half>select>input,.butter-form .butter-form-inline.form-half .butter-form-append>input{width:100%}.butter-form code,.butter-form pre{font-size:10px}.butter-scroll-bar{position:absolute;background:#a4acac;box-shadow:0 0 1px rgba(0,0,0,0.3);border-radius:15px;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden}.butter-scroll-handle{height:8px;top:1px;position:absolute;background:#d9dddd;border-radius:15px}.butter-scroll-handle:hover,.butter-scroll-handle.butter-scollbar-active{background:#6f7b7b;cursor:pointer}.butter-scroll-bar-v .butter-scroll-handle{width:8px;left:1px}*:hover>.butter-tooltip:not(.tooltip-no-hover){opacity:1;visibility:visible;-webkit-transition:opacity .3s ease .5s;-moz-transition:opacity .3s ease .5s;-o-transition:opacity .3s ease .5s;-ms-transition:opacity .3s ease .5s;transition:opacity .3s ease .5s}.butter-tooltip{visibility:hidden;opacity:0;position:absolute;top:100%;left:50%;margin-top:-7px;margin-left:-55px;z-index:100000100;width:110px;padding:10px;background:#FFF;text-shadow:none;color:#555;line-height:15px;font-size:11px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;box-sizing:border-box;border-radius:2px;text-align:center;border:1px solid #CCC;box-shadow:0 5px 6px -5px rgba(0,0,0,0.3);pointer-events:none;-webkit-transition:opacity .3s ease 0;-moz-transition:opacity .3s ease 0;-o-transition:opacity .3s ease 0;-ms-transition:opacity .3s ease 0;transition:opacity .3s ease 0}.butter-tooltip.tooltip-on{opacity:1;visibility:visible;-webkit-transition:opacity .3s ease .5s;-moz-transition:opacity .3s ease .5s;-o-transition:opacity .3s ease .5s;-ms-transition:opacity .3s ease .5s;transition:opacity .3s ease .5s}.butter-tooltip.tooltip-off{display:none}.butter-tooltip.tooltip-no-transition-on{opacity:1;visibility:visible}.butter-tooltip.tooltip-error{color:red}.butter-tooltip:after,.butter-tooltip:before{content:"";position:absolute;top:-5px;left:50%;margin-left:-5px;width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-bottom:5px solid #FFF}.butter-tooltip:after{z-index:100000101}.butter-tooltip:before{top:-6px;border-bottom:5px solid #CCC}.butter-no-top-margin{margin-top:0}.editor-disable-pointer-events{pointer-events:none}.editor-drag-handle{-webkit-transition:opacity .3s ease;-moz-transition:opacity .3s ease;-ms-transition:opacity .3s ease;-o-transition:opacity .3s ease;transition:opacity .3s ease;opacity:.4;z-index:5000;height:32px;width:32px;position:absolute;top:15px;left:15px}.editor-drag-handle:hover{opacity:1}.webmaker-nav-container{display:none;font-family:"Open Sans",sans-serif;color:#FFF;font-size:12px;border-bottom:1px solid #2d2f2f}.webmaker-nav-container a{color:#FFF}.webmaker-nav-container a:hover{color:#3fb58e}.webmaker-nav-container .h3{color:#FFF;margin:0;font-weight:700;font-size:19px}.webmaker-nav-top{background:#3a3c3c;height:29px}.webmaker-nav{padding:0;margin:0;list-style:none;line-height:29px;font-size:1em;color:#FFF}.webmaker-nav>li{padding:0;margin:0;float:left;height:100%}.webmaker-nav>li>a,.webmaker-nav>li>.link{position:relative;display:block;height:100%;background:#3a3c3c;padding:0 15px;font-weight:600;text-decoration:none;cursor:pointer;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-transition:top .1s ease;-moz-transition:top .1s ease;-o-transition:top .1s ease;-ms-transition:top .1s ease;transition:top .1s ease;color:rgba(255,255,255,0.5)}.webmaker-nav>li>a:hover,.webmaker-nav>li>.link:hover,.webmaker-nav>li>a.on,.webmaker-nav>li>.link.on{color:#FFF}.webmaker-nav>li>a.webmaker-btn-active,.webmaker-nav>li>.link.webmaker-btn-active{color:#FFF;border-bottom-width:1px;border-top:1px solid #494c4c;background:#3a3c3c;top:4px;box-shadow:0 -6px 0 1px #2d2f2f,1px -8px 10px -2px #212222;z-index:10000}.primary{float:left;height:29px}.primary>li{border-right:1px solid #474949;border-left:1px solid #2d2f2f;margin-left:0}.webmaker-expanded .primary>li{border-color:transparent}.primary>li:last-child{border-right-color:transparent}.primary>li a:hover{background:#3f4141}.feedback-icon{margin-top:6px;float:left;background:url("/resources/feedback-icon.png") no-repeat;height:18px;width:20px}.feedback-icon:hover{background-position:-19px 0}.webmaker-feedback-btn .feedback-label{display:none;padding-left:5px}.webmaker-feedback-btn:hover .feedback-label{display:inline}.user-info{float:right;margin-right:150px}.user-info li{border-right:0}.login-join{cursor:pointer;position:relative}.login-join .join{pointer-events:auto;top:100%;margin-top:15px;width:200px;margin-left:-100px;z-index:100}.login-join .join .h3{color:#555;font-size:1em;margin:5px 0}.login-join .join .login{display:inline-block}.login-join .join .persona-img{width:40px;height:40px;position:absolute;top:43px;left:4px;background:url("/resources/icons/persona-logo.png") no-repeat;background-size:contain}.login-join .join .info{text-align:left;margin-left:40px}.login-join .login{color:#FFF;line-height:22px;top:3px;display:block;position:relative;background:#535656;border:1px solid #333;box-shadow:inset 0 1px 0 0 #797d7d;padding:0 12px 0 37px;border-radius:3px;margin-right:5px;overflow:hidden}.login-join .login:after{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAAPCAYAAAA/I0V3AAAA4klEQVR42o2RWaqEMBRE3YaCiDjPwQGcd9CrysLv4wTyoLFD90dxqbp1EgdPRB7Kskznea6Zn/aPoKoqUUrJOI5m4l2QBfSyLHKep1zXZSae3An1fS/7vst931bGkzuhaZrsLVbGkzuheZ7lOI6HyJ2QUkqv6yrbtv0LT+6E7G0UrfBfP3lZlpoXH4ZBmHgn5Pv+KwxDfqp0XQdgJp6c/RsUBIGOokiSJDE/s21bACbe5Ozp0TdAHMdSFIXUdS1N01C2wpObPT36HifwCJzI0iX29Oh7XP0E3CB9L01TzM+i/wePv4ZE5RtAngAAAABJRU5ErkJggg==") 10px center no-repeat;content:"";display:block;width:31px;position:absolute;bottom:0;left:-5px;top:0;z-index:10}.login-join .login:before{content:"";display:block;width:30px;height:30px;position:absolute;left:-5px;top:-4px;z-index:10;background:rgba(255,255,255,0.4);-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-o-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);box-shadow:1px 0 0 2px rgba(0,0,0,0.05)}.login-join .login:hover{background:#606363}.user-info>.notification-badge>a{display:none;height:15px;width:15px;padding:0;border-radius:5px;margin-top:8px;border:5px solid #606363;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;box-sizing:border-box;opacity:.7}.user-info>.notification-badge>a:hover{opacity:1}.webmaker-nav>.user{position:relative}.webmaker-nav>.user>a{padding-left:8px}.tooltip.tooltip-user{background:#3a3c3c;border:0;color:#FFF;margin-top:0;left:0;right:0;width:auto;margin-left:0;padding:0;text-align:left;border-radius:0 0 2px 2px}.tooltip.tooltip-user:after,.tooltip.tooltip-user:before{display:none}.tooltip.tooltip-user ul{padding:0;margin:0;list-style:none}.tooltip.tooltip-user ul>li{padding:5px;padding-left:10px;border-bottom:1px solid #535656}.tooltip.tooltip-user ul>li:last-child{border-bottom:0}.tooltip.tooltip-user ul>li a{cursor:pointer}.webmaker-tabs{height:0}.webmaker-expanded .webmaker-tabs{height:auto}.webmaker-tabs,.webmaker-tab{background:#3a3c3c}.webmaker-tab li>a{background:0}.webmaker-tab{box-shadow:inset 0 1px 0 0 #535656,0 -1px 0 0 #2d2f2f}.webmaker-tab{position:relative;width:100%;color:#FFF;overflow:hidden;height:0;-webkit-transition:height .1s ease;-moz-transition:height .1s ease;-o-transition:height .1s ease;-ms-transition:height .1s ease;transition:height .1s ease}.webmaker-tab li{border-right:0;line-height:50px}.webmaker-tab li>a{font-size:1.25em}.webmaker-tab.webmaker-tab-active{height:50px}.webmaker-section-icon{float:left;height:100%;padding-left:10px}.tab-webmaker.webmaker-tab-active{height:100px}.tab-webmaker .tab-inner{height:100%}.tab-webmaker .secondary-info{float:left;width:450px;padding:20px;border-left:1px solid #535656;height:100%;font-size:15px;line-height:1.3}.tab-webmaker .secondary-info .info{margin:0;font-weight:400}.tab-webmaker .webmaker-button{float:left;padding-top:20px}.tab-webmaker .webmaker-button a:hover{color:#FFF}.tab-webmaker .block{float:left;display:block;color:#EEE;text-decoration:none;width:250px;padding-right:20px;border-left:1px solid #535656;height:100%}.tab-webmaker .block:hover{color:#FFF}.tab-webmaker .block h4{font-size:16px;line-height:1;margin:24px 0 6px 0}.tab-webmaker .block .info{margin:0;line-height:1.4}.tab-webmaker img{float:left;margin:12px 5px;opacity:.8}.tab-webmaker img.logo{margin:11px 0 0 15px}.tab-webmaker .block:hover img,.tab-webmaker .logo{opacity:1;margin-top:11px}.tab-webmaker .webmaker-slogan{width:420px;padding:20px;margin:0;font-size:1.6em;line-height:1.4;float:left;padding-right:30px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;box-sizing:border-box}.btn{display:inline-block;background:#EEE;padding:4px 8px;border-radius:2px}.btn:hover{color:#FFF;background:#3fb58e}.butter-tooltip.tooltip-user{background:#3a3c3c;border:0;color:#FFF;margin-top:0;left:0;right:0;width:auto;margin-left:0;padding:0;text-align:left;border-radius:0 0 2px 2px;pointer-events:auto;box-shadow:0 3px 5px rgba(0,0,0,0.4)}.butter-tooltip.tooltip-user:after,.butter-tooltip.tooltip-user:before{display:none}.butter-tooltip.tooltip-user ul{padding:0;margin:0;list-style:none}.butter-tooltip.tooltip-user ul>li{padding:10px;padding-left:10px;border-bottom:1px solid #535656;box-shadow:inset 0 -1px 0 0 rgba(0,0,0,0.2)}.butter-tooltip.tooltip-user ul>li:last-child{border-bottom:0}.butter-tooltip.tooltip-user ul>li a{cursor:pointer;text-decoration:none}'}),n("ui/webmakernav/webmakernav",["util/lang","text!./webmakernav.html","text!./webmakernav.css"],function(e,t,n){var r=function(){},i="webmaker-tab-active",s="webmaker-btn-active",o="webmaker-expanded",u="tab-",a="tooltip-no-transition-on";return function(f){f=f||{};var l=f.container,c=e.domFragment(t),h=c.querySelector(".webmaker-feedback-btn"),p=c.querySelector(".login-join"),d=c.querySelector(".login"),v=c.querySelector(".logout-btn"),m=c.querySelector(".tooltip-user"),g=c.querySelector(".user-name"),y=c.querySelector(".user-name-container"),b=c.querySelector(".user"),w=c.querySelector(".primary"),E=c.querySelector(".webmaker-tabs"),S,x,T,N,C,k;this.views={login:function(e){p.style.display="none",b.style.display="",y.innerHTML=e},logout:function(){p.style.display="",b.style.display="none"}},S=f.feedbackCallback,x=f.onLogin||r,T=f.onLogout||r,N=function(){var e=document.createElement("style"),t=document.createTextNode(n);e.appendChild(t),document.head.appendChild(e)},C=function(e){var t=w.querySelector("."+s),n=E.querySelector("."+i),r=e.target,a,f;a=r.getAttribute("data-tab"),f=E.querySelector("."+u+a);if(!f)return;t&&t.classList.remove(s);if(n===f){n.classList.remove(i),document.body.classList.remove(o);return}n&&n.classList.remove(i),document.body.classList.add(o),f.classList.add(i),r.classList.add(s)},k=function(){m.addEventListener("click",function(e){e.stopPropagation()},!1),g.addEventListener("mouseout",function(){m.classList.remove(a),g.classList.remove(s)},!1),g.addEventListener("mouseover",function(){m.classList.add(a),g.classList.add(s)},!1)},N(),l.appendChild(c),k(),h.addEventListener("click",S,!1),d.addEventListener("click",x,!1),v.addEventListener("click",T,!1),w.addEventListener("click",C,!1),this.views.logout(),f.hideLogin&&p.parentNode.removeChild(p),f.hideFeedback&&h.parentNode.removeChild(h)}}),n("ui/header",["dialog/dialog","util/lang","text!layouts/header.html","ui/user-data","ui/webmakernav/webmakernav","ui/widget/tooltip"],function(e,t,n,r,i,s){return function(o,u){function k(){if(!o.cornfield.authenticated())l.authenticationRequired();else{if(o.project.isSaved)return;if(q(o.project.name)){l.authenticationRequired(F,R);return}R()}}function L(){o.editor.openEditor("share-properties")}function A(e){e?(p.classList.remove("butter-disabled"),p.addEventListener("click",k,!1)):(p.classList.add("butter-disabled"),p.removeEventListener("click",k,!1))}function O(e){e?(g.classList.remove("butter-disabled"),g.href=o.project.previewUrl,g.onclick=function(){return!0}):(g.classList.add("butter-disabled"),g.href="",g.onclick=function(){return!1})}function M(e){e?(m.classList.remove("butter-disabled"),m.addEventListener("click",P,!1)):(m.classList.add("butter-disabled"),m.removeEventListener("click",P,!1))}function _(e){e?(y.classList.remove("butter-disabled"),y.addEventListener("click",L,!1)):(y.classList.add("butter-disabled"),y.removeEventListener("click",L,!1))}function D(){var e=document.createElement("input");e.type="text",e.placeholder=T,e.classList.add("butter-project-name"),e.value=v.textContent!==T?v.textContent:"",d.replaceChild(e,v),d.removeEventListener("click",D,!1),e.focus(),e.addEventListener("blur",U,!1),e.addEventListener("keypress",I,!1)}function P(){var t;o.currentMedia&&o.currentMedia.hasTrackEvents()&&(t=e.spawn("delete-track-events",{data:o}),t.open())}function H(){var t=e.spawn("feedback");t.open()}function B(){N.views.login(o.cornfield.username())}function j(){x&&!x.destroyed&&(d.removeEventListener("mouseover",j,!1),x.destroy())}function F(){function e(){o.editor.openEditor("share-properties"),O(!0)}o.project.isSaved?e():(A(!1),l.save(function(){e()},function(){A(!0),O(!1)}))}function I(e){var t=d.querySelector(".butter-project-name");if(e.keyCode!==13)return;t.blur(),t.removeEventListener("keypress",I,!1)}function q(e){return!!e&&e!==T}function R(){j(),d.addEventListener("mouseover",j,!1),s.create({name:a,message:"Please give your project a name before saving",hidden:!1,element:d,top:"50px",error:!0}),x=s.get(a)}function U(){var e=d.querySelector(".butter-project-name");e.removeEventListener("blur",U,!1),v.textContent=e.value||T,q(v.textContent)?(o.project.name=v.textContent,l.authenticationRequired(F)):R(),d.replaceChild(v,e)}u=u||{};var a="name-error-header-tooltip",f=this,l=new r(o,u),c=t.domFragment(n,".butter-header"),h=c.querySelector("#webmaker-nav"),p=c.querySelector(".butter-save-btn"),d=c.querySelector(".butter-project-title"),v=d.querySelector(".butter-project-name"),m=c.querySelector(".butter-clear-events-btn"),g=c.querySelector(".butter-preview-btn"),y=c.querySelector(".butter-share-btn"),b=c.querySelector(".butter-project-menu"),w=c.querySelector(".butter-project-menu-control"),E=b.querySelector(".butter-btn-menu"),S=c.querySelector("#tabzilla"),x,T=v.innerHTML,N,C;C=s.create({title:"header-title-tooltip",message:"Change the name of your project",element:d,top:"60px"}),f.element=c,s.apply(d),S.addEventListener("click",function(){document.body.classList.toggle("tabzilla-open")},!1),this.views={dirty:function(){O(!1),A(!0),_(!1)},clean:function(){O(!0),A(!1),_(!0)},login:function(){var e=o.project.isSaved;d.style.display="",p.innerHTML="Save",O(e),A(!e),_(e)},logout:function(){O(!1),A(!0),_(!1),d.style.display="none",p.innerHTML="Sign in to save"},mediaReady:function(){A(!o.project.isSaved),C.hidden=!1,d.classList.remove("butter-disabled"),d.addEventListener("click",D,!1),v.addEventListener("click",D,!1)},mediaChanging:function(){A(!1),C.hidden=!0,d.classList.add("butter-disabled"),d.removeEventListener("click",D,!1),v.removeEventListener("click",D,!1)}},w.addEventListener("click",function(){o.currentMedia.hasTrackEvents()?M(!0):M(!1),b.classList.toggle("butter-btn-menu-expanded")},!1),E.addEventListener("click",function(e){if(e.target.classList.contains("butter-disabled"))return;b.classList.remove("butter-btn-menu-expanded")},!0),N=new i({container:h,onLogin:l.authenticationRequired,onLogout:l.logout,feedbackCallback:H}),o.listen("autologinsucceeded",B,!1),o.listen("authenticated",B,!1),o.listen("logout",N.views.logout,!1),this.attachToDOM=function(){document.body.insertBefore(c,document.body.firstChild)},o.listen("autologinsucceeded",f.views.login,!1),o.listen("authenticated",f.views.login,!1),o.listen("logout",f.views.logout,!1),o.listen("mediaready",f.views.mediaReady),o.listen("mediacontentchanged",f.views.mediaChanging),o.listen("projectsaved",function(){f.views.clean(),v.textContent=o.project.name,d.addEventListener("click",D,!1)}),o.listen("projectchanged",function(){f.views.dirty()}),o.listen("ready",function(){o.project.name&&(v.textContent=o.project.name)})}}),n("ui/unload-dialog",[],function(){return function(e){function n(){return"You have unsaved project data."}var t=!1;e.listen("projectchanged",function(){t||(window.onbeforeunload=n)}),e.listen("projectsaved",function(){t=!0,window.onbeforeunload=null})}}),n("crashreporter",["dialog/dialog","util/xhr","util/uri"],function(e,t,n){function o(e){var t=n.parse(e);return t.host===window.location.hostname}function u(e,t,n){function r(e,t,r){var i=t.call(r,e);return!i&&n[n.length-1]!==e&&n.push(e),i}function i(e,t,r){var i=t.call(r,e);return!i.length&&n[n.length-1]!==e&&n.push(e),i}var s=e.getElementById;e.getElementById=function(t){return r(t,s,e)};var o=e.querySelector;e.querySelector=function(t){return r(t,o,e)};var u=e.querySelectorAll;e.querySelectorAll=function(t){return i(t,u,e)},t.forEach(function(e){var t=e.querySelector;e.querySelector=function(e){return r(e,t,this)};var n=e.querySelectorAll;e.querySelectorAll=function(e){return i(e,n,this)}})}function a(e){s.push(e.type),s.length>r&&s.shift()}var r=10,i=["ready","mediacontentchanged","mediaready","trackeventadded","trackeventremoved","trackadded","trackremoved"],s=[];return{init:function(r,f){i.forEach(function(e){r.listen(e,a)});if(!f.value("crashReporter")||n.parse(window.location.href).queryKey.crashReporter==="0")return;var l=window.onerror?window.onerror:function(){return!0},c,h=[];u(window.document,[window.HTMLElement.prototype,window.HTMLDivElement.prototype,window.DocumentFragment.prototype],h),window.onerror=function(n,i,u){function a(){window.onbeforeunload=null,window.location.reload(!0)}function f(e){delete m.onSendReport,delete m.onNoReport,m.commentsxs=e,t.post("/crash",JSON.stringify(m),a,"text/json")}if(!window.XMLHttpRequest)return l();if(!o(i))return l();if(c)return l();var p=window.Popcorn?window.Popcorn.version:"unknown",d=window.Butter?window.Butter.version:"unknown",v=r.currentMedia||{url:"unknown"},m={date:(new Date).toDateString(),message:n,appUrl:window.location.href,scriptUrl:i,lineno:u,mediaUrl:v.url,stateList:s,userAgent:navigator.userAgent,popcornVersion:p,butterVersion:d,nullDomNodes:h.slice(-5).join(", ")||"N/A",onSendReport:f,onNoReport:a};try{c=e.spawn("crash",{data:m}),c.listen("close",function(){c=null}),c.open()}catch(g){a()}return l()}},simulateError:function(){if(!window.onerror)return;window.onerror("Simulated error via crashReporter.simulateError()",window.location.href,0)}}}),n("first-run",["dialog/dialog","ui/widget/tooltip"],function(e,t){var n=window.localStorage;return{init:function(){function f(){t.create({name:"tooltip-media",element:u,top:"60px",message:"<h3>Events Editor</h3>Augment your media with track events here!",hidden:!1}),i=t.get("tooltip-media"),document.body.addEventListener("mousedown",function e(){i.hidden=!0,document.body.removeEventListener("mousedown",e,!0)},!0)}function l(){r.unlisten("close",l),window.removeEventListener("click",c,!1),u.classList.remove("overlay-highlight"),a.classList.remove("overlay-highlight"),document.body.classList.remove("first-run"),o.removeChild(s),f()}function c(){r.close()}function h(){s=document.createElement("div"),s.classList.add("butter-modal-overlay"),s.classList.add("butter-modal-overlay-dark-bg"),s.classList.add("fade-in"),o.appendChild(s),window.addEventListener("click",c,!1),a.classList.add("overlay-highlight"),document.body.classList.add("first-run")}var r,i,s,o=document.querySelector(".butter-editor-area"),u=document.querySelector(".butter-editor-header-popcorn"),a=document.querySelector(".add-media-input");try{var p=n.getItem("butter-first-run");if(!p||window.location.search.match("forceFirstRun"))n.setItem("butter-first-run",!0),h(),r=e.spawn("first-run"),r.open(!1),r.listen("close",l)}catch(d){}}}}),n("text!layouts/logo-spinner.html",[],function(){return'<div class="butter-logo-spin-outer">\n  <div class="butter-spinner"></div>\n</div>\n'}),n("ui/logo-spinner",["util/lang","text!layouts/logo-spinner.html"],function(e,t){return function(n){var r=e.domFragment(t,".butter-logo-spin-outer"),i=r.querySelector(".butter-spinner");return n&&n.appendChild(r),{element:r,start:function(){r.classList.remove("fade-out"),i.classList.add("active")},stop:function(e){r.classList.add("fade-out"),setTimeout(function(){i.classList.remove("active"),e&&e()},500)}}}}),n("text!layouts/tray.html",[],function(){return'<div class="butter-tray butter-tray-minimized" data-butter-exclude="true" data-butter-content-state="timeline">\n  <div class="butter-loading-container"></div>\n  <div class="butter-status-area"></div>\n  <div class="butter-timeline-area"></div>\n  <div class="butter-toggle-button">\n    <div class="image-container"></div>\n  </div>\n</div>'}),n("text!layouts/status-area.html",[],function(){return'<div class="media-status-container">\n  <div class="time-bar">\n    <div class="time-bar-canvas-container">\n      <canvas></canvas>\n    </div>\n    <div class="time-bar-scrubber-container">\n      <div class="fill-bar"></div>\n      <div class="butter-tooltip butter-time-tooltip">00:00:00</div>\n      <div class="time-bar-scrubber-node" data-tooltip>\n        <div class="time-bar-scrubber-line" title="Displays the media\'s current time. Drag to seek through the media."></div>\n      </div>\n    </div>\n  </div>\n  <div class="status-container">\n    <div class="play-button-container">\n      <div class="butter-btn btn-green status-button" title="Play/Pause media">\n        <span class="icon icon-white icon-only icon-play"></span>\n      </div>\n    </div>\n    <div class="time-container">\n      <input type="text">\n    </div>\n  </div>\n  <div class="mute-button-container">\n    <div class="status-button" title="Toggle volume on/off">\n      <span class="icon icon-white icon-only icon-volume-down"></span>\n    </div>\n  </div>\n</div>\n'}),n("text!layouts/timeline-area.html",[],function(){return'<div class="butter-timeline fadable">\n</div>\n'}),n("ui/tray",["util/lang","./logo-spinner","text!layouts/tray.html","text!layouts/status-area.html","text!layouts/timeline-area.html"],function(e,t,n,r,i){return function(){var s=e.domFragment(r,".media-status-container"),o=e.domFragment(i,".butter-timeline"),u=e.domFragment(n,".butter-tray"),a=u.querySelector(".butter-loading-container"),f=new t(a);this.statusArea=u.querySelector(".butter-status-area"),this.timelineArea=u.querySelector(".butter-timeline-area"),this.rootElement=u,this.statusArea.appendChild(s),this.timelineArea.appendChild(o),this.attachToDOM=function(){document.body.appendChild(u)},this.show=function(){u.classList.add("butter-tray-transitions")},this.setMediaInstance=function(e){var t=this.timelineArea.querySelector(".butter-timeline");t.innerHTML="",t.appendChild(e)},this.toggleLoadingSpinner=function(e){e?(f.start(),a.style.display="block"):f.stop(function(){a.style.display="none"})},Object.defineProperties(this,{minimized:{enumerable:!0,set:function(e){e?(document.body.classList.add("tray-minimized"),u.classList.add("butter-tray-minimized")):(document.body.classList.remove("tray-minimized"),u.classList.remove("butter-tray-minimized"))},get:function(){return u.classList.contains("butter-tray-minimized")}}})}}),n("text!layouts/ui-kit.html",[],function(){return'<div class="butter-editor ui-kit allow-scrollbar">\n  <h1>Sample Editor</h1>\n  <div class="error-message-container">\n    <div class="error-message"></div>\n  </div>\n  <div class="butter-editor-body scrollbar-container">\n    <div class="editor-options-wrapper scrollbar-outer">\n      <div class="editor-options scrollbar-inner">\n        <fieldset>\n          <label>Buttons</label>\n          <a class="butter-btn btn-light">Button</a>\n          <a class="butter-btn btn-green" >Button</a>\n          <a class="butter-btn btn-light"><span class="icon icon-cog"></span>Button + Icon</a>\n          <p>\n            <span class="btn-group butter-btn-radio">\n              <a class="butter-btn btn-light"><span class="icon icon-only icon-align-left"></span></a>\n              <a class="butter-btn btn-light"><span class="icon icon-only icon-align-center"></span></a>\n              <a class="butter-btn btn-light"><span class="icon icon-only icon-align-right"></span></a>\n            </span>\n\n            <span class="btn-group">\n              <a class="butter-btn btn-light">Button</a>\n              <a class="butter-btn btn-light"><span class="icon icon-only icon-cog"></span></a>\n            </span>\n          </p>\n          <a class="butter-btn btn-light butter-btn-checkbox">Checkbox</a>\n          <a class="butter-btn btn-green butter-btn-checkbox" >Checkbox</a>\n        </fieldset>\n\n        <fieldset>\n          <label>Text boxes</label>\n          <input type="text" placeholder="default input">\n          <div class="butter-form-append" data-tooltip="This is an example of a tooltip">\n            <input type="text" placeholder="butter-form-append">\n            <span class="butter-unit">unit</span>\n          </div>\n          <textarea></textarea>\n\n        </fieldset>\n\n        <fieldset>\n          <label>Tooltips</label>\n          <code>ui/widgets/tooltip.js</code>\n          <p><a class="butter-btn btn-light" data-tooltip="hello world">Button\n          </a></p>\n          <pre>\n// Manual usage\nvar tooltip1 = Tooltip.create({ \n  message: "hello world" \n});\nmyButton.appendChild( tooltip1 );\n\n// Apply to all elements inside a rootElement  \n&lt;a id="test2" class="butter-btn btn-light" \n  data-tooltip="coolio"&gt;Button&lt;/a&gt;\n  \nTooltip.apply( rootElement );\n          </pre>\n        </fieldset>\n\n        <fieldset>\n          <label>This is an option set</label>\n          <label class="butter-form-radio">\n            <input type="radio" name="test" value="test">Loremt nulla pariaturanim id est laborum.\n          </label>\n          <label class="butter-form-radio">\n            <input type="radio" name="test" value="test">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmodlit anim id est laborum.\n          </label>\n          <label class="butter-form-radio">\n            <input type="radio" name="test" value="test">Loremt nulla pariaturanim id est laborum.\n          </label>\n          <label class="butter-form-checkbox">\n            <input type="checkbox" name="test2" value="test">Loremt nulla pariaturanim id est laborum.\n          </label>\n        </fieldset>\n        <fieldset class="butter-form-inline form-half">\n          <label class="butter-form-radio">\n            <input type="radio" name="test" value="test">Das asds\n          </label>\n          <label class="butter-form-radio">\n            <input type="radio" name="test" value="test">Loremt nulla \n          </label>\n        </fieldset>\n        <fieldset class="butter-form-inline form-single">\n          <label>Dulla</label>\n          <input type="text" name="test" value="test">\n        </fieldset>\n        <fieldset class="butter-form-inline form-single">\n          <label>Dulla asdas </label>\n          <select>\n            <option>Blah</option>\n          </select>\n        </fieldset>\n        <fieldset class="butter-form-inline form-half">\n          <div class="butter-form-append">\n            <label>Start</label>\n            <input type="text" placeholder="2">\n            <span class="butter-unit">seconds</span>\n          </div>\n          <div class="butter-form-append">\n            <label>End</label>\n            <input type="text" placeholder="10">\n            <span class="butter-unit">s</span>\n          </div>\n        </fieldset>\n        <fieldset class="butter-form-inline form-half">\n          <label>Text boxes</label>\n          <input type="text" placeholder="default input">\n          <input type="text" placeholder="default input">\n        </fieldset>\n\n      </div>\n    </div>\n  </div>\n</div>\n'}),n("editor/ui-kit",["editor/editor","editor/base-editor","text!layouts/ui-kit.html"],function(e,t,n){function i(e){var t=e.target.tagName==="A"?e.target:e.target.parentNode,n=this.querySelector("."+r);n&&n.classList.remove(r),t.classList.toggle(r)}function s(){this.classList.toggle(r)}function o(e,t){for(var n=0,r=e.length;n<r;n++)e[n].addEventListener("click",t,!1)}var r="butter-btn-active";e.register("ui-kit",n,function(t,n){e.BaseEditor.extend(this,n,t,{open:function(){var e=t.querySelectorAll(".butter-btn-radio"),n=t.querySelectorAll(".butter-btn-checkbox");o(e,i),o(n,s)},close:function(){}})})}),n("ui/ui",["core/eventmanager","./toggler","./header","./unload-dialog","crashreporter","first-run","./tray","editor/ui-kit","core/trackevent","dialog/dialog","util/dragndrop"],function(e,t,n,r,i,s,o,u,a,f,l){function g(s){function S(e,t){var n=e.popcornOptions,r=n.end-n.start,i,s;n.start>t?s={start:n.start-t,end:n.end-t}:s={start:0,end:r},i=e.track.findOverlappingTrackEvent(s.start,s.end,e),i&&(s.start=i.popcornOptions.end,s.end=s.start+r),e.update(s)}function x(e,t){var n=e.popcornOptions,r;n.end-n.start-t>=a.MINIMUM_TRACKEVENT_SIZE?r={end:n.end-t}:r={end:n.start+a.MINIMUM_TRACKEVENT_SIZE},e.update(r)}function T(e,t){var n=e.popcornOptions,r=s.currentMedia.duration,i=n.end-n.start,o,u;n.end<=r-t?u={start:n.start+t,end:n.end+t}:u={start:r-(n.end-n.start),end:r},o=e.track.findOverlappingTrackEvent(u.start,u.end,e),o&&(u.end=o.popcornOptions.start,u.start=u.end-i),e.update(u)}function N(e,t){var n=e.popcornOptions,r,i;n.end<=s.currentMedia.duration-t?i={end:n.end+t}:i={end:s.currentMedia.duration},r=e.track.findOverlappingTrackEvent(n.start,i.end,e),r&&(i.end=r.popcornOptions.end),e.update(i)}function A(e){var t=e.which||e.keyCode,n=e.target;t=t===46?8:t,L[t]&&!n.isContentEditable&&p.indexOf(n.nodeName)===-1&&(d.indexOf(t)>-1&&(window.removeEventListener("keydown",A,!1),window.addEventListener("keyup",O,!1)),L[t](e))}function O(){window.removeEventListener("keyup",O,!1),window.addEventListener("keydown",A,!1)}function M(){window.removeEventListener("keydown",A,!1)}function _(){window.addEventListener("keydown",A,!1)}var u=!0,g=s.config,y=g.value("ui"),b,w=this;s.simulateError=i.simulateError,e.extend(w),this.contentStateLocked=!1,this.tray=new o,this.header=new n(s,g),this.editor=null;var E=new t(this.tray.rootElement.querySelector(".butter-toggle-button"),function(){s.ui.visible=!s.ui.visible,E.state=!E.state},"Show/Hide Timeline");y.enabled&&y.onLeaveDialog&&(b=new r(s)),this.loadIcons=function(e){var t,n,r;e.forEach(function(e){t=e.icon;if(!t)return;n=new Image,n.id=e.type+"-icon",n.src=t,r=document.createElement("div"),r.setAttribute("data-butter-exclude","true"),r.className="butter-image-preload",r.appendChild(n),document.body.appendChild(r)})},this.setEditor=function(e){w.editor=e,document.body.appendChild(e)},this.load=function(e){function n(){s.loader.load([t],function(){function t(){s.unlisten("mediaready",t)}w.loadIcons(g.value("plugin").plugins),i.init(s,g),s.listen("mediaready",t),e()})}var t={type:"css",url:h};y.enabled?(n(),w.tray.attachToDOM(),w.header.attachToDOM()):e()},Object.defineProperties(this,{enabled:{get:function(){return y.enabled}},visible:{enumerable:!0,get:function(){return u},set:function(e){u!==e&&(u=e,u?this.tray.minimized=!1:this.tray.minimized=!0)}}});var C=s.orderedTrackEvents=[],k=function(e,t){return e.popcornOptions.start>t.popcornOptions.start};s.listen("trackeventadded",function(e){var t=e.data;C.push(t),C.sort(k)}),s.listen("trackeventremoved",function(e){var t=e.data,n=C.indexOf(t);n>-1&&C.splice(n,1)}),s.listen("trackeventupdated",function(){C.sort(k)});var L={32:function(e){e.preventDefault(),s.currentMedia.ended?s.currentMedia.paused=!1:s.currentMedia.paused=!s.currentMedia.paused},37:function(e){var t=e.shiftKey?m:v,n=s.sortedSelectedEvents,r,i;if(n.length){e.preventDefault();if(e.ctrlKey||e.metaKey)for(r=0,i=n.length;r<i;++r)x(n[r],t);else for(r=n.length-1;r>=0;--r)S(n[r],t)}else s.currentTime-=t},38:function(e){var t,n,r,i=s.selectedEvents.slice();i.length&&e.preventDefault();for(var o=0,u=i.length;o<u;o++)n=i[o],t=n.track,r=s.currentMedia.getLastTrack(t),r&&!r.findOverlappingTrackEvent(n)&&(t.removeTrackEvent(n),r.addTrackEvent(n))},39:function(e){var t=e.shiftKey?m:v,n=s.sortedSelectedEvents,r,i;if(n.length){e.preventDefault();if(e.ctrlKey||e.metaKey)for(r=0,i=n.length;r<i;++r)N(n[r],t);else for(r=0,i=n.length;r<i;++r)T(n[r],t)}else s.currentTime+=t},40:function(e){var t,n,r,i=s.selectedEvents.slice();i.length&&e.preventDefault();for(var o=0,u=i.length;o<u;o++)n=i[o],t=n.track,r=s.currentMedia.getNextTrack(t),r&&!r.findOverlappingTrackEvent(n)&&(t.removeTrackEvent(n),r.addTrackEvent(n))},27:function(){l.isDragging||s.deselectAllTrackEvents()},8:function(e){var t=s.selectedEvents.slice(),n,r,i,o=t.length;e.preventDefault();if(t.length){for(i=0;i<o;i++)if(t[i].uiInUse)return;if(t.length===1){n=t[0],s.editor.closeTrackEventEditor(n),n.track.removeTrackEvent(n);return}r=f.spawn("delete-track",{data:t.length+" track events",events:{submit:function(){for(i=0;i<o;i++)n=t[i],s.editor.closeTrackEventEditor(n),n.track.removeTrackEvent(n);r.close()},cancel:function(){r.close()}}}),r.open()}},9:function(e){if(C.length&&s.selectedEvents.length<=1){e.preventDefault();var t=0,n=e.shiftKey?-1:1;C.indexOf(s.selectedEvents[0])>-1&&(t=C.indexOf(s.selectedEvents[0]),C[t+n]?t+=n:e.shiftKey?t=C.length-1:t=0),s.deselectAllTrackEvents(),C[t].selected=!0}},67:function(e){(e.ctrlKey||e.metaKey)&&s.copyTrackEvents()},86:function(e){(e.ctrlKey||e.metaKey)&&s.pasteTrackEvents()}};l.listen("dragstarted",M),l.listen("dragstopped",_),l.listen("resizestarted",M),l.listen("resizestopped",_),l.listen("sortstarted",M),l.listen("sortstopped",_),this.TRANSITION_DURATION=c,E.visible=!1,w.visible=!1,this.loadIndicator={start:function(){w.tray.toggleLoadingSpinner(!0)},stop:function(){w.tray.toggleLoadingSpinner(!1)}},w.loadIndicator.start(),s.listen("ready",function(){w.loadIndicator.stop(),w.tray.show()}),s.listen("mediacontentchanged",function(){M(),w.loadIndicator.start(),E.visible=!1,s.ui.visible=!1}),s.listen("mediaready",function(){w.loadIndicator.stop(),E.visible=!0,E.state=!0,_()}),w.dialogDir=s.config.value("dirs").dialogs||"",w.showUIKit=function(){s.editor.openEditor("ui-kit")}}var c=500,h="{css}/butter.ui.css",p=["TEXTAREA","INPUT","VIDEO","AUDIO"],d=[32,27,8],v=.25,m=1;return g.__moduleName="ui",g}),n("util/tutorial",["ui/widget/tooltip"],function(e){function t(){function t(e){return typeof e=="number"||typeof e=="string"&&!/(px|%)$/.test(e)?e+"%":e}return{_setup:function(n){n.name=n.name||Popcorn.guid("tooltip-"),n._parent=Popcorn.dom.find(n.element),n.hover=!!n.hover,n.hidden=!!n.hidden,n.message=n.message||"",e.create({name:n.name,element:n._parent,message:n.message,top:t(n.top),left:t(n.left),hidden:n.hidden,hover:n.hover}),n._toolTipReference=e.get(n.name)},start:function(e,t){var n=t._toolTipReference;n&&(n.hidden=!1)},end:function(e,t){var n=t._toolTipReference;n&&(n.hidden=!0)},_teardown:function(e){var t=e._toolTipReference;t&&t.destroy()}}}function n(e){return function(){function n(n){t.indexOf(n)!==-1&&e.editor.openEditor(n)}var t=["media-editor","plugin-list","share-properties"];return{start:function(e,t){n(t.type)},end:Popcorn.nop}}}function r(e,t){for(var n=t.length-1;n>=0;n--)e.tooltip(t[n])}function i(e,t){var n;for(var r=t.length-1;r>=0;r--)n=t[r],e.editorController(n)}return{build:function(e,s){var o;Popcorn.plugin("tooltip",t),Popcorn.plugin("editorController",n(e)),o=new Popcorn(e.currentMedia.target),e.listen("ready",function(){r(o,s.general),s.editorOpenEvents&&i(o,s.editorOpenEvents)}),e.listen("editoropened",function(e){var t=e.data;s[t]&&(r(o,s[t]),s[t]=null)})}}}),n("text!default-config.json",[],function(){return'{\n  "name": "default-config",\n  "baseDir": "../",\n  "crashReporter": true,\n  "cssRenderClientSide": false,\n  "snapshotHTMLOnReady": false,\n  "scrapePage": true,\n  "backupInterval": 0,\n  "title": "Popcorn Maker",\n  "ui": {\n    "enabled": true,\n    "onLeaveDialog": true,\n    "trackEventHighlight": "click"\n  },\n  "makeVideoURLsUnique": true,\n  "mediaDefaults": {\n    "frameAnimation": true\n  },\n  "trackEvent": {\n    "defaultDuration": 5\n  },\n  "plugin": {\n    "plugins": [\n      {\n        "type": "text",\n        "path": "{{baseDir}}templates/assets/plugins/text/popcorn.text.js",\n        "icon": "{{baseDir}}templates/assets/plugins/text/text-icon.png"\n      },\n      {\n        "type": "popup",\n        "path": "{{baseDir}}templates/assets/plugins/popup/popcorn.popup.js",\n        "icon": "{{baseDir}}templates/assets/plugins/popup/popup-icon.png"\n      },\n      {\n        "type": "googlemap",\n        "path": "{{baseDir}}templates/assets/plugins/googlemap/popcorn.googlemap.js",\n        "icon": "{{baseDir}}resources/icons/map.png"\n      },\n      {\n        "type": "twitter",\n        "path": "{{baseDir}}templates/assets/plugins/twitter/popcorn.twitter.js",\n        "icon": "{{baseDir}}templates/assets/plugins/twitter/twitter-icon.png"\n      },\n      {\n        "type": "image",\n        "path": "{{baseDir}}templates/assets/plugins/image/popcorn.image.js",\n        "icon": "{{baseDir}}templates/assets/plugins/image/image-icon.png"\n      },\n      {\n        "type": "loopPlugin",\n        "displayName": "loop",\n        "path": "{{baseDir}}templates/assets/plugins/loopPlugin/popcorn.loopPlugin.js",\n        "icon": "{{baseDir}}templates/assets/plugins/loopPlugin/loop-icon.png"\n      },\n      {\n        "type": "skip",\n        "path": "{{baseDir}}templates/assets/plugins/skip/popcorn.skip.js",\n        "icon": "{{baseDir}}templates/assets/plugins/skip/skip-icon.png"\n      },\n      {\n        "type": "pausePlugin",\n        "displayName": "Pause",\n        "path": "{{baseDir}}templates/assets/plugins/pausePlugin/popcorn.pausePlugin.js",\n        "icon": "{{baseDir}}templates/assets/plugins/pausePlugin/pause-icon.png"\n      },\n      {\n        "type": "wikipedia",\n        "path": "{{baseDir}}templates/assets/plugins/wikipedia/popcorn.wikipedia.js",\n        "icon": "{{baseDir}}templates/assets/plugins/wikipedia/wikipedia-icon.png"\n      },\n      {\n        "type": "sequencer",\n        "hidden": true,\n        "path": "{{baseDir}}templates/assets/plugins/sequencer/popcorn.sequencer.js",\n        "icon": "{{baseDir}}resources/icons/media.png"\n      }\n    ],\n    "defaults": [\n      "text",\n      "popup",\n      "googlemap",\n      "twitter",\n      "image",\n      "wikipedia",\n      "loopPlugin",\n      "pausePlugin",\n      "skip",\n      "sequencer"\n    ]\n  },\n  "player": {\n    "players": [\n      {\n        "type": "youtube",\n        "path": "{{baseDir}}external/popcorn-js/players/youtube/popcorn.youtube.js"\n      },\n      {\n        "type": "soundcloud",\n        "path": "{{baseDir}}external/popcorn-js/players/soundcloud/popcorn.soundcloud.js"\n      },\n      {\n        "type": "vimeo",\n        "path": "{{baseDir}}external/popcorn-js/players/vimeo/popcorn.vimeo.js"\n      }\n    ],\n    "defaults": [\n      "youtube",\n      "soundcloud",\n      "vimeo"\n    ]\n  },\n  "wrapper": {\n    "wrappers": [\n      {\n        "type": "html5",\n        "path": "{{baseDir}}external/popcorn-js/wrappers/html5/popcorn.HTMLMediaElement.js"\n      },\n      {\n        "type": "soundcloud",\n        "path": "{{baseDir}}external/popcorn-js/wrappers/soundcloud/popcorn.HTMLSoundCloudAudioElement.js"\n      },\n      {\n        "type": "youtube",\n        "path": "{{baseDir}}external/popcorn-js/wrappers/youtube/popcorn.HTMLYouTubeVideoElement.js"\n      },\n      {\n        "type": "vimeo",\n        "path": "{{baseDir}}external/popcorn-js/wrappers/vimeo/popcorn.HTMLVimeoVideoElement.js"\n      },\n      {\n        "type": "null",\n        "path": "{{baseDir}}external/popcorn-js/wrappers/null/popcorn.HTMLNullVideoElement.js"\n      }\n    ],\n    "defaults": [\n      "html5",\n      "soundcloud",\n      "vimeo",\n      "null"\n    ]\n  },\n  "dirs": {\n    "popcorn-js": "{{baseDir}}external/popcorn-js/",\n    "css": "{{baseDir}}css/",\n    "resources": "{{baseDir}}resources/",\n    "tools": "{{baseDir}}tools/"\n  },\n  "icons": {\n    "default": "popcorn-icon.png",\n    "image": "image-icon.png"\n  }\n}\n'}),n("text!layouts/ua-warning.html",[],function(){return'<div class="butter-ua-warning" data-butter-exclude>\n  <span>\n    Your web browser may lack some functionality expected by Popcorn Maker to function properly. Please upgrade your browser or <a href="https://webmademovies.lighthouseapp.com/projects/65733-popcorn-maker">file a bug</a> to find out why your browser isn\'t fully supported. Click <a href="#" class="close-button">here</a> to remove this warning.</span>\n</div>\n'}),n("core/project",["core/eventmanager","core/media"],function(e,t){function r(r){function y(){p=!0,d=!0,s&&b(),i.dispatch("projectchanged")}function b(){g===-1&&m>0&&(d=!0,g=setInterval(w,m),w())}var i=this,s,o,u,a,f,l,c,h,p=!1,d=!1,v=!1,m=r.config.value("backupInterval")|0,g=-1;Object.defineProperties(i,{id:{get:function(){return s},enumerable:!0},name:{get:function(){return o},set:function(e){e!==o&&(o=e,y())},enumerable:!0},template:{get:function(){return u},set:function(e){e!==u&&(u=e,y())},enumerable:!0},author:{get:function(){return a},set:function(e){e!==a&&(a=e,y())},enumerable:!0},data:{get:function(){if(!f||p){var e=[];for(var t=0;t<r.media.length;++t)e.push(r.media[t].json);f={targets:r.serializeTargets(),media:e}}return f},enumerable:!0},publishUrl:{get:function(){return l},enumerable:!0},previewUrl:{get:function(){return l+"?preview=true"},enumerable:!0},iframeUrl:{get:function(){return c},enumerable:!0},isSaved:{get:function(){return v&&!p},enumerable:!0}}),e.extend(i),r.listen("mediaready",function E(){r.unlisten("mediaready",E),["mediacontentchanged","mediatargetchanged","trackadded","trackremoved","tracktargetchanged","trackeventadded","trackeventremoved","trackeventupdated"].forEach(function(e){r.listen(e,y)})}),i.import=function(e){var n,i,f,p,d,m,g,y;if(typeof e=="string")try{e=JSON.parse(e)}catch(w){return}e.projectID&&(s=e.projectID,v=!0),e.name&&(o=e.name),e.template&&(u=e.template),e.author&&(a=e.author),e.publishUrl&&(l=e.publishUrl),e.iframeUrl&&(c=e.iframeUrl),e.remixedFrom&&(h=e.remixedFrom),i=e.targets;if(i&&Array.isArray(i))for(g=0,y=i.length;g<y;++g)f=i[g],n=r.getTargetByType("elementID",f.element),n?n.json=f:r.addTarget(f);else console&&console.warn("Ignored imported target data. Must be in an Array.");d=e.media;if(d&&Array.isArray(d))for(g=0,y=d.length;g<y;++g)p=d[g],m=r.getMediaByType("target",p.target),m?m.json=p:(m=new t,m.json=p,r.addMedia(m));else console&&console.warn("Ignored imported media data. Must be in an Array.");e.backupDate&&b()},i.export=function(){return JSON.stringify(i.data)};var w=i.backupData=function(){if(!d)return;var e=i.data;e.name=o,e.template=u,e.author=a,e.backupDate=Date.now();try{n.setItem("butter-backup-project",JSON.stringify(e)),d=!1}catch(t){clearInterval(g),g=-1,n.removeItem("butter-backup-project"),console.warn("Warning: Popcorn Maker LocalStorage quota exceeded. Stopping automatic backup. Will be restarted when project changes again.")}};i.save=function(e){e||(e=function(){});if(i.isSaved){e({error:"okay"});return}var t=JSON.stringify({id:s,name:o,template:u,author:a,data:i.data,remixedFrom:h});w(),r.cornfield.save(s,t,function(t){t.error==="okay"?(p=!1,n.removeItem("butter-backup-project"),b(),s||(s=t.projectId),r.cornfield.publish(s,function(t){t.error==="okay"&&(v=!0,l=t.publishUrl,c=t.iframeUrl),i.dispatch("projectsaved"),e(t)})):e(t)})}}var n=window.localStorage;return r.checkForBackup=function(e,t){var r,i;if(e.config.value("recover")==="purge"){t(null,null);return}try{r=n.getItem("butter-backup-project"),r=JSON.parse(r),n.removeItem("butter-backup-project"),r&&(i=r.backupDate)}catch(s){}t(r,i)},r}),function(){var e=500,t={Chrome:17,Firefox:10,IE:9,Safari:6,Opera:12},r=["Android","iOS","BlackBerry","MeeGo","Windows Phone OS","Firefox OS","RIM Tablet OS"];n("main",["core/eventmanager","core/logger","core/config","core/track","core/target","core/media","core/page","./modules","./dependencies","./dialogs","dialog/dialog","editor/editor","ui/ui","util/xhr","util/lang","util/tutorial","text!default-config.json","text!layouts/ua-warning.html","ui/widget/tooltip","crashreporter","core/project"],function(n,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){var T=window.UAParser,N=0,C={};C.ToolTip=E,C.showUAWarning=function(){var t=g.domFragment(w,".butter-ua-warning");document.body.appendChild(t),setTimeout(function(){t.classList.add("slide-out")},e),t.getElementsByClassName("close-button")[0].onclick=function(){document.body.removeChild(t)}},C.init=function(e){function W(){if(!L)throw new Error("No media object is selected")}function X(e,t){var n=L.popcorn.popcorn.position(),r=Popcorn.manifest[t].options,i=r.width?r.width.default:0,s=r.height?r.height.default:0,o=(e[0]-n.left)/n.width*100,u=(e[1]-n.top)/n.height*100;return o+i>100&&(o=100-i),u+s>100&&(u=100-s),[o,u]}function V(e){var t,n,r=L.currentTime,i;if(e.data.popcornOptions){n={};for(var s in e.data.popcornOptions)e.data.popcornOptions.hasOwnProperty(s)&&(n[s]=e.data.popcornOptions[s])}L&&L.ready?(n&&n.end&&(i=n.end+r),t=B.generateSafeTrackEvent(e.data.element.getAttribute("data-popcorn-plugin-type"),r,i,e.data.position),n&&(n.end&&(n.end=t.popcornOptions.end),t.update(n)),B.editor.editTrackEvent(t)):M.log("Warning: No media to add dropped trackevent.")}function $(e){var t;L.ready&&(t=B.generateSafeTrackEvent(e.data.getAttribute("data-popcorn-plugin-type"),L.currentTime),B.editor.editTrackEvent(t))}function J(e){_.addPlayerType(e.data)}function K(e,t){return e.popcornOptions.start<t.popcornOptions.start?1:-1}function Q(){I=j.slice().sort(K)}function G(e){var t=e.origin;for(var n=j.length-1;n>=0;n--)if(j[n]===t)return;j.push(t),Q()}function Y(e){var t=e.origin,n=j.indexOf(t);n>-1&&(j.splice(n,1),Q())}function Z(e){var t=e.data;t.subscribe("selected",G),t.subscribe("deselected",Y),t.selected&&j.indexOf(t)===-1&&(j.push(t),Q())}function et(e){var t=e.data,n=j.indexOf(t);t.unsubscribe("selected",G),t.unsubscribe("deselected",Y),n>-1&&(j.splice(n,1),Q())}function rt(e,t){if(!e){t();return}e+="?noCache="+Date.now(),m.getUntilComplete(e,function(){var e;try{e=JSON.parse(this.responseText)}catch(n){B.dispatch("loaddataerror","Saved data not formatted properly.")}t(e)},"application/json",{"If-Modified-Since":"Fri, 01 Jan 1960 00:00:00 GMT"},!0)}function it(e){function r(e){n.import(e),e.tutorial&&y.build(B,e.tutorial)}var t,n=new x(B);window.location.search.substring(1).split("&").forEach(function(e){e=e.split("="),e&&e[0]==="savedDataUrl"&&(t=e[1])}),rt(t,function(t){!t||t.error||!t.media?rt(D.value("savedDataUrl"),function(t){t&&r(t),e(n)}):(r(t),e(n))})}function st(e){e&&P.override(e),D=P,U=D.value("trackEvent").defaultDuration;var t=new l(C,B,D),n=new c(D);B.loader=n,_=new f(n),B.ui=new v(B),B.ui.load(function(){nt(function(){tt(function(){t.ready(function(){x.checkForBackup(B,function(e,t){function n(e){e.template=e.template||D.value("name"),B.project=e,B.chain(e,["projectchanged","projectsaved"]),B.dispatch("ready",B)}if(e){var r=p.spawn("backup",{data:{backupDate:t,projectName:e.name,loadProject:function(){var t=new x(B);t.import(e),n(t)},discardProject:function(){e=null,it(n)}}});r.open()}else it(n)})})})})})}var h=(new T).getResult(),d=h.browser.name,g=h.browser.major,w=h.os.name,E=!1;for(var S in t)t.hasOwnProperty(S)&&r.indexOf(w)===-1&&d===S&&+g>=t[S]&&(E=!0);E||C.showUAWarning(),e=e||{};var k=[],L,A=[],O="Butter"+N++,M=new i(O),_,D,P,H,B=Object.create(C),j=[],F=[],I=[],q={},R={},U;try{P=s.parse(b)}catch(z){throw"Butter Error: unable to find or parse default-config.json"}e.debug!==undefined&&i.enabled(e.debug),n.extend(B),B.dialog=p,B.getManifest=function(e){return W(),L.getManifest(e)},B.generateSafeTrackEvent=function(e,t,n,r,i){var s,u,a={};t+U>L.duration&&(t=L.duration-U),t<0&&(t=0),!n&&n!==0&&(n=t+U),n>L.duration&&(n=L.duration);if(!H){console.warn("No targets to drop events!");return}return r instanceof o||(r&&r.constructor===Array&&(i=r),r=L.orderedTracks[0]),r=r||L.addTrack(),r.findOverlappingTrackEvent(t,n)&&(r=L.insertTrackBefore(r)),a.start=t,a.end=n,a.target=H.elementID,i&&(u=X(i,e),a.left=u[0],a.top=u[1]),s=r.addTrackEvent({popcornOptions:a,type:e}),H.view.blink(),s},B.deselectAllTrackEvents=function(){while(j.length)j[0].selected=!1;I=[]},B.copyTrackEvents=function(){if(I.length){F=[];for(var e=0;e<I.length;e++)F.unshift(I[e].copy())}},B.pasteTrackEvents=function(){var e,t=0,n;if(F[0]){B.deselectAllTrackEvents(),t=L.currentTime-F[0].popcornOptions.start;for(var r=0;r<F.length;r++){e={};for(var i in F[r].popcornOptions)F[r].popcornOptions.hasOwnProperty(i)&&(e[i]=F[r].popcornOptions[i]);e.start=e.start+t,e.end=e.end+t;if(e.start>L.duration)break;e.end>L.duration&&(e.end=L.duration),n=B.generateSafeTrackEvent(F[r].type,e.start,e.end),n.update(e),n.selected=!0}}},B.addTarget=function(e){e instanceof u||(e=new u(e)),A.push(e),e.listen("trackeventrequested",V),M.log("Target added: "+e.name),B.dispatch("targetadded",e);if(e.isDefault||!H)H=e;return e},B.removeTarget=function(e){typeof e=="string"&&(e=B.getTargetByType("id",e));var t=A.indexOf(e);return t>-1?(e.unlisten("trackeventrequested",V),A.splice(t,1),B.dispatch("targetremoved",e),H===e&&(H=A.length>0?A[0]:null),e):null},B.serializeTargets=function(){var e=[];for(var t=0,n=A.length;t<n;++t)e.push(A[t].json);return e},B.getTargetByType=function(e,t){for(var n=0,r=A.length;n<r;n++)if(A[n][e]===t)return A[n];return undefined},B.getMediaByType=function(e,t){for(var n=0,r=k.length;n<r;n++)if(k[n][e]===t)return k[n];return undefined},B.addMedia=function(e){e instanceof a||(e&&(e.makeVideoURLsUnique=D.value("makeVideoURLsUnique")),e=new a(e)),e.maxPluginZIndex=D.value("maxPluginZIndex"),e.popcornCallbacks=R,e.popcornScripts=q,k.push(e),B.chain(e,["mediacontentchanged","mediadurationchanged","mediatargetchanged","mediatimeupdate","mediaready","trackadded","trackremoved","tracktargetchanged","trackeventadded","trackeventremoved","trackeventupdated","trackorderchanged"]);var t;if(e.tracks.length>0)for(var n=0,r=e.tracks.length;n<r;++n){var i=e.tracks[n];t=i.trackEvents,e.dispatch("trackadded",i);if(t.length>0)for(var s=0,o=t.length;s<o;++s)i.dispatch("trackeventadded",t[s])}return e.listen("trackeventadded",Z),e.listen("trackeventremoved",et),e.listen("trackeventrequested",$),e.listen("mediaplayertyperequired",J),B.dispatch("mediaadded",e),L||(B.currentMedia=e),e.setupContent(),e},B.removeMedia=function(e){var t=k.indexOf(e);if(t>-1){k.splice(t,1),B.unchain(e,["mediacontentchanged","mediadurationchanged","mediatargetchanged","mediatimeupdate","mediaready","trackadded","trackremoved","tracktargetchanged","trackeventadded","trackeventremoved","trackeventupdated","trackorderchanged"]);var n=e.tracks;for(var r=0,i=n.length;r<i;++r)B.dispatch("trackremoved",n[r]);return e===L&&(L=undefined),e.unlisten("trackeventadded",Z),e.unlisten("trackeventremoved",et),e.unlisten("trackeventrequested",$),e.unlisten("mediaplayertyperequired",J),B.dispatch("mediaremoved",e),e}return undefined},B.getTrackEvents=function(e,t,n){var r=B.orderedTrackEvents,i;return e?(n?i=function(n){return n.popcornOptions[e]===t}:i=function(n){return n[e]===t},r.filter(i)):r},B.getTrackEventsByType=function(e){return B.getTrackEvents("type",e)},Object.defineProperties(B,{defaultTarget:{enumerable:!0,get:function(){return H}},config:{enumerable:!0,get:function(){return D}},id:{get:function(){return O},enumerable:!0},tracks:{get:function(){return L.tracks},enumerable:!0},targets:{get:function(){return A},enumerable:!0},currentTime:{get:function(){return W(),L.currentTime},set:function(e){W(),L.currentTime=e},enumerable:!0},duration:{get:function(){return W(),L.duration},set:function(e){W(),L.duration=e},enumerable:!0},media:{get:function(){return k},enumerable:!0},currentMedia:{get:function(){return L},set:function(e){typeof e=="string"&&(e=B.getMediaByType("id",e.id));if(e&&k.indexOf(e)>-1)return L=e,M.log("Media Changed: "+e.name),B.dispatch("mediachanged",e),L},enumerable:!0},selectedEvents:{get:function(){return j},enumerable:!0},copiedEvents:{get:function(){return F},enumerable:!0},sortedSelectedEvents:{get:function(){return I},enumerable:!0},debug:{get:function(){return i.enabled()},set:function(e){i.enabled(e)},enumerable:!0},defaultTrackeventDuration:{enumerable:!0,get:function(){return U}}});var tt=B.preparePage=function(e){var t=_.scrape(),n=t.target,r=t.media;_.prepare(function(){if(!!D.value("scrapePage")){var t,i,s,o,u,a,f,l,c;for(t=0,s=n.length;t<s;++t)a=B.getTargetByType("elementID",n[t].element),a||B.addTarget({element:n[t].id});for(t=0,s=r.length;t<s;t++){f=null,l=null,u="",c=r[t],c.getAttribute("data-butter-source")&&(u=c.getAttribute("data-butter-source"));if(k.length>0){for(i=0,o=k.length;i<o;++i)if(k[i].id!==r[t].id&&k[i].url!==u){f=k[i];break}}else D.value("mediaDefaults")&&(l=D.value("mediaDefaults"));f||B.addMedia({target:r[t].id,url:u,popcornOptions:l})}}e&&e(),B.dispatch("pageready")})};e.ready&&B.listen("ready",function(t){e.ready(t.data)});var nt=B.preparePopcornScriptsAndCallbacks=function(e){function o(t){return function(){this.readyState===4&&(this.status!==200?(q[t]="",M.log("WARNING: Trouble loading Popcorn script: "+this.response)):q[t]=this.response,++s,s===i.length&&e&&e())}}var t=D.value("popcorn")||{},n=t.callbacks,r=t.scripts,i=[],s=0;R=n;for(var u in r)if(r.hasOwnProperty(u)){var a=r[u],f=document.getElementById(a.substring(1));a.indexOf("#")===0?f&&(q[u]=f.innerHTML):i.push({url:a,onLoad:o(u)})}if(i.length>0)for(var l=0;l<i.length;++l)m.get(i[l].url,i[l].onLoad);else e()};if(e.config&&typeof e.config=="string"){var ot=new XMLHttpRequest,ut,at=e.config+"?noCache="+Date.now();ot.open("GET",at,!1),ot.overrideMimeType&&ot.overrideMimeType("application/json"),ot.setRequestHeader("If-Modified-Since","Fri, 01 Jan 1960 00:00:00 GMT"),ot.send(null);if(ot.status===200||ot.status===0){try{ut=s.parse(ot.responseText)}catch(z){throw new Error("Butter config file not formatted properly.")}st(ut)}else B.dispatch("configerror",B)}else st(s.reincarnate(e.config));return B.page=_,C.app=B,B},C.Editor=d,C.version="v1.0.10-93-g07fefc1";if(window.Butter){var k=window.Butter.__waiting;delete window.Butter,k&&C.init.apply(this,k)}return window.Butter=C,C})}()})()